<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <!-- For Mobile Devices -->
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
        <meta name="generator" content="Doxygen 1.8.10"/>
        <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
        <title>ORIGEN API: Manager/emit/origen_beta.f90 Source File</title>
        <!--<link href="../../tabs.css" rel="stylesheet" type="text/css"/>-->
        <script type="text/javascript" src="../../dynsections.js"></script>
        <link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
        <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
        <link href="../../doxygen.css" rel="stylesheet" type="text/css" />
        <link href="../../customdoxygen.css" rel="stylesheet" type="text/css"/>
        <link href='https://fonts.googleapis.com/css?family=Roboto+Slab' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="../../doxy-boot.js"></script>
    </head>
    <body>
        <nav class="navbar navbar-default" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand">ORIGEN API v0.5.2</a>
                </div>
            </div>
        </nav>
        <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
            <div class="content" id="content">
                <div class="container">
                    <div class="row">
                        <div class="col-sm-12 panel " style="padding-bottom: 15px;">
                            <div style="margin-bottom: 15px;">
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Overview</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../modules.html"><span>Components</span></a></li>
      <li><a href="../../examples.html"><span>Examples</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../d1/d5b/md__c_h_a_n_g_e_l_o_g.html"><span>Changelog</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_0d0ed8c9b19e6818cf5af4bd559a697b.html">Manager</a></li><li class="navelem"><a class="el" href="../../dir_dfc2306eaed69ffecc6529fcc01312db.html">emit</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">origen_beta.f90</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../da/d3b/origen__beta_8f90.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &quot;Standard/Interface/ReporterFortran.h&quot;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#include &quot;Standard/Interface/logger.f90&quot;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor"></span><span class="comment"></span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">!&gt; beta emission calculations</span></div>
<div class="line"><a name="l00005"></a><span class="lineno"><a class="line" href="../../d8/dff/namespaceorigen__beta.html">    5</a></span>&#160;<span class="keyword">module</span> <a class="code" href="../../d8/dff/namespaceorigen__beta.html">origen_beta</a></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;  <span class="keywordtype">use </span>iso_c_binding<span class="keywordtype">, only</span>: c_double</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;  <span class="keywordtype">use </span><a class="code" href="../../d0/db4/namespaceconst.html">const</a></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;  <span class="keywordtype">use </span><a class="code" href="../../da/da9/namespaceauxiliary.html">auxiliary</a></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;  <span class="keywordtype">use </span><a class="code" href="../../d1/d2a/namespaceorigen__definitions__m.html">origen_definitions_m</a></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;  <span class="keywordtype">use </span><a class="code" href="../../d6/de2/namespaceorigen__librarywrapper__m.html">origen_librarywrapper_m</a></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;  <span class="keywordtype">use </span><a class="code" href="../../d9/d6b/namespacebeta__library.html">beta_library</a></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;  <span class="keywordtype">use </span>standardreporter_i</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;ScaleDBCF/DBCF.h&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor"></span>  <span class="keywordtype">use </span>dbcf_m</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  <span class="comment">! some coefficients</span></div>
<div class="line"><a name="l00020"></a><span class="lineno"><a class="line" href="../../d8/dff/namespaceorigen__beta.html#a3bcefa1475ae97eaed731cfa2d04f26b">   20</a></span>&#160;  <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">dimension(100,3)</span> :: <a class="code" href="../../d8/dff/namespaceorigen__beta.html#a3bcefa1475ae97eaed731cfa2d04f26b">aaa</a></div>
<div class="line"><a name="l00021"></a><span class="lineno"><a class="line" href="../../d8/dff/namespaceorigen__beta.html#a625618d5496b6f7d89b6d9eb3b7d3716">   21</a></span>&#160;  <span class="keywordtype">integer</span> :: <a class="code" href="../../d8/dff/namespaceorigen__beta.html#a87261de321db0d27bd655f64bf49b611">iii</a>, <a class="code" href="../../d8/dff/namespaceorigen__beta.html#a625618d5496b6f7d89b6d9eb3b7d3716">jjj</a></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  <span class="keyword">data</span> ((<a class="code" href="../../d8/dff/namespaceorigen__beta.html#a3bcefa1475ae97eaed731cfa2d04f26b">aaa</a>(<a class="code" href="../../d8/dff/namespaceorigen__beta.html#a87261de321db0d27bd655f64bf49b611">iii</a>,<a class="code" href="../../d8/dff/namespaceorigen__beta.html#a625618d5496b6f7d89b6d9eb3b7d3716">jjj</a>),<a class="code" href="../../d8/dff/namespaceorigen__beta.html#a87261de321db0d27bd655f64bf49b611">iii</a>=1,100),<a class="code" href="../../d8/dff/namespaceorigen__beta.html#a625618d5496b6f7d89b6d9eb3b7d3716">jjj</a>=1,3)/ .2935, .3213, .3475, .3759, .4031, .4155, &amp;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;     .4655, .494, .5315, .5663, .6022, .6423, .6753, .7137, .753, .7876, &amp;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;     .8318, .8953, .9172, .9599, 1.0039, 1.0492, 1.1030, 1.1413, 1.1852, &amp;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;     1.2349, 1.2879, 1.3315, 1.3811, 1.4344, 1.4825, 1.5226, 1.5795, 1.6356&amp;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;     , 1.6879, 1.7395, 1.7964, 1.8481, 1.9106, 1.9553, 2.0113, 2.0622, &amp;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;     2.1256, 2.1776, 2.2361, 2.3164, 2.3524, 2.4087, 2.4653, 2.4664, 2.5843&amp;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;     , 2.6388, 2.7017, 2.763, 2.8217, 2.8819, 2.9421, 3.0043, 3.0605, &amp;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;     3.1308, 3.1832, 3.2434, 3.3059, 3.3667, 3.4283, 3.4507, 3.5498, 3.6098&amp;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;     , 3.6808, 3.7346, 3.754, 3.8425, 3.9025, 3.9798, 4.0404, 4.1014, &amp;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;     4.1617, 4.2221, 4.2693, 4.3521, 4.4033, 4.4637, 4.5238, 4.5836, 4.6426&amp;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;     , 4.7024, 4.7566, 4.8226, 4.8774, 4.9353, 5.0866, 5.0352, 5.1072, &amp;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;     5.1744, 5.198, 5.2731, 5.3282, 5.3821, 5.433, 5.4872, 4.367, 4.4657, &amp;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;     4.5608, 4.644, 4.7373, 4.851, 4.9278, 5.0273, 5.1174, 5.214, 5.3075, &amp;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;     5.3937, 5.5138, 5.6138, 5.7174, 5.8354, 5.943, 6.0041, 6.1532, 6.2789&amp;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;     , 6.3804, 6.493, 6.611, 6.7313, 6.8603, 6.9798, 7.0406, 7.2337, 7.3612&amp;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;     , 7.4773, 7.6217, 7.8255, 7.849, 8.0376, 8.1786, 8.3198, 8.4692, 8.612&amp;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;     , 8.7995, 8.9164, 9.067, 9.2474, 9.4272, 9.4621, 9.6866, 9.7478, &amp;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;     9.9977, 10.1649, 10.34, 10.591, 10.651, 10.8587, 10.8193, 11.1369, &amp;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;     11.3064, 11.4774, 11.6376, 11.7981, 11.9685, 12.0196, 12.2997, 12.4609&amp;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;     , 12.6167, 12.7711, 12.9352, 13.1441, 13.2428, 13.396, 13.5403, &amp;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;     13.6871, 13.914, 14.0859, 14.2148, 14.2447, 14.3775, 14.5048, 14.6268&amp;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;     , 14.7483, 15.1172, 14.8904, 15.0649, 15.1694, 15.2592, 15.344, 15.421&amp;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;     , 15.4907, 15.6227, 15.6128, 15.6674, 15.7063, 15.1911, 15.7949, &amp;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;     15.7814, 15.715, 15.7928, 15.781, 15.7549, 15.7235, 15.693, 15.6256, &amp;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;     3.7882, 3.871, 3.9594, 4.055, 4.1467, 4.2338, 4.329, 4.4211, 4.5172, &amp;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;     4.6106, 4.7066, 4.7917, 4.8924, 4.9872, 5.0804, 5.1694, 5.26, 5.3709, &amp;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;     5.4476, 5.5185, 5.6266, 5.7164, 5.8006, 5.8878, 5.9703, 6.054, 6.1702&amp;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;     , 6.2147, 6.2936, 6.3732, 6.4442, 6.4705, 6.6129, 6.6506, 6.714, &amp;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;     6.7781, 6.8327, 6.8918, 6.9198, 6.9925, 7.0389, 7.0718, 7.0922, 7.1986&amp;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;     , 7.1942, 7.2673, 7.2522, 7.2725, 7.284, 7.2665, 7.3157, 7.299, 7.4151&amp;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;     , 7.3249, 7.3171, 7.3029, 7.29, 7.2726, 7.2461, 7.2771, 7.1823, 7.1445&amp;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;     , 7.105, 7.0614, 7.006, 6.9336, 6.8921, 6.8265, 6.7571, 6.6854, 6.574&amp;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;     , 6.4752, 6.3666, 6.3444, 6.2473, 6.1473, 6.0433, 5.9319, 5.6527, &amp;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;     5.7422, 5.5858, 5.4583, 5.3304, 5.1996, 5.0659, 4.9295, 4.7522, 4.644&amp;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;     , 4.4957, 4.3477, 4.4181, 4.0315, 3.8891, 3.764, 3.5762, 3.4092, &amp;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;     3.2503, 3.0875, 2.9184, 2.762/</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">  !&gt; buffer for Reporter</span></div>
<div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="../../d8/dff/namespaceorigen__beta.html#ad9715cc7cd30b520e8542a0d1638e4e5">   60</a></span>&#160;  <span class="keywordtype">character(1024)</span>, <span class="keywordtype">private</span> :: <a class="code" href="../../d9/d6b/namespacebeta__library.html#ae55e31be08a5bd71c063eda2df066e22">rbuffer</a>(256)</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">  !&gt; options for beta printout</span></div>
<div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="../../d4/d7f/structorigen__beta_1_1origen__beta__options.html">   63</a></span>&#160;  <span class="keyword">type</span> <a class="code" href="../../d4/d7f/structorigen__beta_1_1origen__beta__options.html">origen_beta_options</a></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">    !&gt; number of beta groups</span></div>
<div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="../../d4/d7f/structorigen__beta_1_1origen__beta__options.html#ae5ae70a6b1e7bc44b2420bbca4b572b4">   66</a></span>&#160;    <span class="keywordtype">integer</span> :: ngroups</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">    !&gt; Energy group boundaries (descending MeV)</span></div>
<div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="../../d4/d7f/structorigen__beta_1_1origen__beta__options.html#a1553f3342caa2f5452687c2799e43211">   69</a></span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">allocatable</span> :: bounds(:)</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">    !&gt; for which step emitters should be printed?</span></div>
<div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="../../d4/d7f/structorigen__beta_1_1origen__beta__options.html#a40d260c7ce7cfec9b1594e7d5677e25c">   72</a></span>&#160;    <span class="keywordtype">integer</span> :: print_emitters</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">    !&gt; print gross beta activity</span></div>
<div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="../../d4/d7f/structorigen__beta_1_1origen__beta__options.html#a18d61af1bbd811df2899ae893d289d2e">   75</a></span>&#160;    <span class="keywordtype">logical</span> :: print_summary</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">    !&gt; print multigroup spectra</span></div>
<div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="../../d4/d7f/structorigen__beta_1_1origen__beta__options.html#a163aa01a2bb05fae0c25d4ec1c14efda">   78</a></span>&#160;    <span class="keywordtype">logical</span> :: print_spectra</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">    !&gt; Enabled</span></div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="../../d4/d7f/structorigen__beta_1_1origen__beta__options.html#a4483247b22dd0ed76de4fa323c15898b">   81</a></span>&#160;    <span class="keywordtype">logical</span> :: enabled</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">    !&gt; emitters_cutoff for the emitters</span></div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="../../d4/d7f/structorigen__beta_1_1origen__beta__options.html#a8f5e3acd7a822efe732249eb23a7a3cf">   84</a></span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span> :: emitters_cutoff</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">    !&gt; sources nuclide type (0/1/2/3/4 === none/lite/act/fp/all)</span></div>
<div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="../../d4/d7f/structorigen__beta_1_1origen__beta__options.html#a5604ad2e7b6b5263576e9c1b8b378da9">   87</a></span>&#160;    <span class="keywordtype">integer</span> :: source_nuclide_type</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="keyword">  end type </span><a class="code" href="../../d4/d7f/structorigen__beta_1_1origen__beta__options.html">origen_beta_options</a></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">  !&gt; Beta source calculation and printout class. Use this class to evaluate beta source and beta</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">  !! spectra based on the nuclide concentrations.</span></div>
<div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="../../db/dc5/structorigen__beta_1_1origen__beta__class.html">   93</a></span>&#160;  <span class="keyword">type</span> <a class="code" href="../../db/dc5/structorigen__beta_1_1origen__beta__class.html">origen_beta_class</a></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">    !&gt; associated origen library</span></div>
<div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="../../db/dc5/structorigen__beta_1_1origen__beta__class.html#aca217f2b2b238f4a56fb199d8d20edb6">   96</a></span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="../../dc/d7b/structorigen__librarywrapper__m_1_1origen__librarywrapper.html">origen_librarywrapper</a>),<span class="keywordtype">pointer</span> :: lib=&gt;null()</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">    !&gt; associated beta library</span></div>
<div class="line"><a name="l00099"></a><span class="lineno"><a class="line" href="../../db/dc5/structorigen__beta_1_1origen__beta__class.html#ae022bd09e966f2d877ff3a3f58461ce6">   99</a></span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="../../de/d08/structbeta__library_1_1beta__library__class.html">beta_library_class</a>),<span class="keywordtype">pointer</span> :: blib=&gt;null()</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">    !&gt; number of steps</span></div>
<div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="../../db/dc5/structorigen__beta_1_1origen__beta__class.html#ad466b58f392ba2ccd511b90c418a851e">  102</a></span>&#160;    <span class="keywordtype">integer</span> :: nsteps</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">    !&gt; set of options</span></div>
<div class="line"><a name="l00105"></a><span class="lineno"><a class="line" href="../../db/dc5/structorigen__beta_1_1origen__beta__class.html#a270a9801d3a14063af9197f3a7a9fdbf">  105</a></span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="../../d4/d7f/structorigen__beta_1_1origen__beta__options.html">origen_beta_options</a>) :: opts</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">    !&gt; per-nuclide beta sources [nstep, itot]</span></div>
<div class="line"><a name="l00108"></a><span class="lineno"><a class="line" href="../../db/dc5/structorigen__beta_1_1origen__beta__class.html#a7ebbeea0478d4e4d005329639acb63ee">  108</a></span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">allocatable</span> :: source(:,:)</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">    !&gt; beta yields [itot, ngroups]</span></div>
<div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="../../db/dc5/structorigen__beta_1_1origen__beta__class.html#a5fff4a7e771cd7b23b855d3ff27fb624">  111</a></span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">allocatable</span> :: yield(:,:)</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">    !&gt; beta spectra [nstep, ngroups]</span></div>
<div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="../../db/dc5/structorigen__beta_1_1origen__beta__class.html#ab9dcfe34b8309f1065ca50da33843d1b">  114</a></span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">allocatable</span> :: spectrum(:,:)</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">    !&gt; beta emitters at the print_emitters step [itot, ngroups]</span></div>
<div class="line"><a name="l00117"></a><span class="lineno"><a class="line" href="../../db/dc5/structorigen__beta_1_1origen__beta__class.html#a0ff8d456a9cc5e99892e6247cb34f746">  117</a></span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">allocatable</span> :: emitters(:,:)</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">    !&gt; total beta source [nstep]</span></div>
<div class="line"><a name="l00120"></a><span class="lineno"><a class="line" href="../../db/dc5/structorigen__beta_1_1origen__beta__class.html#a7ac088e7d04c25efe1f84a42f175c9ee">  120</a></span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">allocatable</span> :: ebeta(:)</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">    !&gt; extra beta source [nstep]</span></div>
<div class="line"><a name="l00123"></a><span class="lineno"><a class="line" href="../../db/dc5/structorigen__beta_1_1origen__beta__class.html#ad7bc46e26115b66a019be0cd34f1edee">  123</a></span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">allocatable</span> :: extra(:)</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="keyword">contains</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">    !&gt; Constructor (load and calculate)</span></div>
<div class="line"><a name="l00128"></a><span class="lineno"><a class="line" href="../../db/dc5/structorigen__beta_1_1origen__beta__class.html#a6e8cefe65c44dc35efb781d3434ee125">  128</a></span>&#160;    <span class="keywordtype">procedure</span> :: init =&gt; origen_beta__init<span class="comment"></span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">    !&gt; Destructor</span></div>
<div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="../../db/dc5/structorigen__beta_1_1origen__beta__class.html#a6ce8a767339df6f10c4466c03b430020">  130</a></span>&#160;    <span class="keywordtype">procedure</span> :: destroy =&gt; origen_beta__destroy<span class="comment"></span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">    !&gt; Print the output</span></div>
<div class="line"><a name="l00132"></a><span class="lineno"><a class="line" href="../../db/dc5/structorigen__beta_1_1origen__beta__class.html#ac5ce2261910072a9bc572b19d90e88ca">  132</a></span>&#160;    <span class="keywordtype">procedure</span> :: output =&gt; origen_beta__output<span class="comment"></span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">    !&gt; Evaluate spectrum for one beta line</span></div>
<div class="line"><a name="l00134"></a><span class="lineno"><a class="line" href="../../db/dc5/structorigen__beta_1_1origen__beta__class.html#a0aac837665b747d5e7fe6cd895fa9103">  134</a></span>&#160;    <span class="keywordtype">procedure</span> :: spectra =&gt; origen_beta__spectra</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="keyword">  end type </span><a class="code" href="../../db/dc5/structorigen__beta_1_1origen__beta__class.html">origen_beta_class</a></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="keyword">contains</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="keyword">  subroutine </span>origen_beta__destroy(this)</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="comment">!   D u m m y   A r g u m e n t s</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="comment">!-----------------------------------------------</span><span class="comment"></span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">    !&gt; the receiver</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordtype">class</span>(<a class="code" href="../../db/dc5/structorigen__beta_1_1origen__beta__class.html">origen_beta_class</a>), <span class="keywordtype">intent(inout)</span> :: this</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    report_debug(<span class="stringliteral">&quot;Deallocating a origen_beta_class object&quot;</span>)</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(this%source)) <span class="keyword">deallocate</span>(this%source)</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(this%yield)) <span class="keyword">deallocate</span>(this%yield)</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(this%spectrum)) <span class="keyword">deallocate</span>(this%spectrum)</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(this%ebeta)) <span class="keyword">deallocate</span>(this%ebeta)</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(this%extra)) <span class="keyword">deallocate</span>(this%extra)</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(this%emitters)) <span class="keyword">deallocate</span>(this%emitters)</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="keyword">NULLIFY</span>(this%lib)</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keyword">NULLIFY</span>(this%blib)</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="keyword">  end subroutine </span>origen_beta__destroy</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">  !&gt; cosimp is a routine for evaluating definite integrals using an adaptive</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">  !! simpsons algorithm.  integral estimated over interval (a,b) of function</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">  !! aux, where eps is the error tolerance and isub is the number of</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">  !! subdivisions within (a,b) used in evaluation.  cosimp makes two</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">  !! evaluations using isub and isub+1 and and compares values for agreement</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">  !! within eps.  estimates made using est1 = f(a)+4*f(a+b/2)+f(b) and</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">  !! est2 = f(a)+4*f(3a+b/4)+ 2*f(a+b/2)+4*f(a+3b/4)+f(b)</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="keyword">  real(C_DOUBLE) </span><span class="keyword">function </span><a class="code" href="../../d8/dff/namespaceorigen__beta.html#a93822825195e3a763bea095e1e22c249">cosimp</a> (a, b, aux, eps, isub, emax, z)</div>
<div class="line"><a name="l00167"></a><span class="lineno"><a class="line" href="../../d8/dff/namespaceorigen__beta.html#a93822825195e3a763bea095e1e22c249">  167</a></span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="comment">!   D u m m y   A r g u m e n t s</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="comment">!-----------------------------------------------</span><span class="comment"></span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">    !&gt;</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(inout)</span> :: isub<span class="comment"></span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">    !&gt; lower integration limit</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span>  :: a<span class="comment"></span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">    !&gt; upper integration limit</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span>  :: b<span class="comment"></span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">    !&gt; the integrand f(x, emax, z)</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">external</span> :: aux<span class="comment"></span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">    !&gt; required relative error tolerance</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span> :: eps<span class="comment"></span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">    !&gt; integrand parameter</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span> :: emax<span class="comment"></span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">    !&gt; integrand parameter</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: z</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="comment">!   L o c a l   V a r i a b l e s</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordtype">integer</span> , <span class="keywordtype">dimension(20)</span> :: nr</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordtype">integer</span> :: iflag, iflog, iprint, nsub, ll, nd, n, l, m, ne</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span> , <span class="keywordtype">dimension(20)</span> :: p</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span> , <span class="keywordtype">dimension(41)</span> :: y</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span> :: c, x, summ, ak, aj, ajj, s, ss, er, pb, pa1, pb1, subsum, suber</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordtype">integer</span> :: kount, ints</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span> :: err</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="comment">!   isub - specification of the minimum number of divisions</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="comment">!   required returns the number of divisions used ( negative if</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="comment">!   not converged) in each case the number of divisions is 2**isub.</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="comment">!   isub may be entered negative to activate error messages</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="comment">!   err - estimate of the maximum error in the integral</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="comment">!   kount - number of function evaluations</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="comment">!   ints - number of intervals used</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="comment">!   y - real(C_DOUBLE) array stores values of f(x) to avoid recalculation</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="comment">!   s, ss - two estimates for a given subinterval</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="comment">!   summ - cumulative estimate of the integral over the accepted</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="comment">!   subintervals (unscaled)</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="comment">!   pa1, pb1 - limits of interval not satisfying error requirement</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="comment">!   subsum - estimate of integral over the above interval</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="comment">!   if isub is outside the acceptable range, this message is printed</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="comment">!   error in isub, 0 &lt; isub &lt; 18. isub set to 0</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="comment">!   cosimp is evaluated with isub = 0.</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="comment">!   the function cosimp returns the best estimate of the integral.</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="comment">!   the finest subdivision allowed is (b-a)/2**20.  if the error</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="comment">!   requirement is still not satisfied, an error message is printed</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="comment">!   giving the bounds of the unacceptable region, the estimated</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="comment">!   integral over this interval, and an estimate of the error there.</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="comment">!   the value of cosimp returned is still the best estimate over the</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="comment">!   entire range.</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="comment">!   isub is returned negative when convergence is not complete.</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="comment">!   from atomic energy of canada mathematics and computation fortran</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="comment">!   library</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="comment">!      programmed by    d howden  in apex language        jul 1965</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="comment">!      translated by    c j johnson                       nov 1969</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="comment">!      revised    by    valerie jones                     aug 1976</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      <a class="code" href="../../d8/dff/namespaceorigen__beta.html#a93822825195e3a763bea095e1e22c249">cosimp</a> = 0.0</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      err    = 0.0</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      kount  = 0</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      ints   = 0</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      iflag  = 0</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      iflog  = 0</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      <span class="keywordflow">if</span> (a == b) <span class="keywordflow">return</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      <span class="keywordflow">if</span> (isub &lt; 0) iprint = 1</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      isub = min0(18,max0(0,isub))</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      nsub = isub</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      ll   = isub + 2</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      ints = 0</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      err  = 0.</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      nd   = 20</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      p(1) = 1.</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      <span class="keywordflow">do</span> n = 2, nd</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;         p(n) = p(n-1)*2.0</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      c     = b - a</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      x     = .5</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      l     = 1</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      n     = 2</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      y(1)  = aux(a, emax, z)</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      y(2)  = aux(b, emax, z)</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      y(3)  = aux(c*x + a, emax, z)</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      kount = 3</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      summ  = 0</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      m     = 3</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      nr(n) = 2</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      ak    = .5</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">!  ***next subdivision</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;   50 <span class="keywordflow">continue</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      aj       = c*ak/2.</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      nsub     = max0(nsub,n)</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      ajj      = c*x + a</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      y(n+n)   = aux(ajj - aj, emax, z)</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      y(n+n+1) = aux(ajj + aj, emax, z)</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      kount    = kount + 2</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">!  *** if minimum number of subdivisions (isub) has not been met,</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">!      the interval is divided in half</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      <span class="keywordflow">if</span> (n &lt; ll) <span class="keywordflow">go to</span> 125</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">!  *** two estimates of the interval are made and the error estimate is</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">!      compared to the required error tolerance</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      s  = y(l) + 4.0*y(m) + y(nr(n))</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      ss = s + 2.*(2.*(y(n+n)+y(n+n+1))-y(m))</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      er = (aj*(ss - 2.*s))/45.</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      <span class="keywordflow">if</span> (abs(er) &gt; aj*eps*(abs(ss) + abs(s))/4.5) <span class="keywordflow">go to</span> 100</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      <span class="keywordflow">if</span> (iflag == 1) <span class="keywordflow">go to</span> 200</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">!      if the error requirement is met the interval is accepted.  the</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">!      estimates are added on to their respective sums, the count of</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">!      the number of intervals used (ints) is increased by one, and</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">!      the next interval on the right is considered</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;   75 <span class="keywordflow">continue</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      summ = summ + ss*ak</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      err  = err + er</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      ints = ints + 1</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      <span class="keywordflow">if</span> (nr(n) &lt;= 2) <span class="keywordflow">go to</span> 225</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      l     = nr(n)</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      ne    = l/2</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      ak    = 1./p(ne+2)</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      x     = x + ak + 1./p(n)</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      n     = ne + 2</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      nr(n) = nr(n-1)</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      m     = 2*ne + 3</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      <span class="keywordflow">go to</span> 50</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">!  ***error recognition criterion</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  100 <span class="keywordflow">continue</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      <span class="keywordflow">if</span> (n &gt;= nd) <span class="keywordflow">go to</span> 150</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">!      if the error requirement is not satisfied and the maximum</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">!      number of subdivisions has not been reached, the interval is</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">!      divided in half.</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  125 <span class="keywordflow">continue</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      nr(n+1) = m</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      m       = 2*n</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      ak      = 1./p(n+1)</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      x       = x - ak</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      n       = n + 1</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      <span class="keywordflow">go to</span> 50</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">!      if the maximum number of subdivisions has been reached without</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">!      the error requirement being met, the bounds of the offending</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">!      interval are stored with the estimate of the integral and the</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">!      error flag is set.</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  150 <span class="keywordflow">continue</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      pb = ajj + 2.*aj</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      <span class="keywordflow">if</span> (iflag == 1) <span class="keywordflow">go to</span> 175</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      pa1    = ajj - 2.0*aj</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      pb1    = pb</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      subsum = ss*ak</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      suber  = er</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      iflag  = 1</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      iflog  = 1</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      <span class="keywordflow">go to</span> 75</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">!      consecutive intervals where the error requirement is not met are</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">!      combined for readability.</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  175 <span class="keywordflow">continue</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      pb1    = pb</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      subsum = subsum + ss*ak</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      suber  = suber + er</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      <span class="keywordflow">go to</span> 75</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">!      when the non-convergent interval has been completely determined</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">!      a message is printed giving the bounds, integral, and error.</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  200 <span class="keywordflow">continue</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      iflog = 1</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      iflag = 0</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      <span class="keywordflow">if</span> (iprint == 0) <span class="keywordflow">go to</span> 75</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      soutline(1,fmt=2000) pa1, pb1, subsum*(c/6.0), abs(suber)</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      <span class="keywordflow">go to</span> 75</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">!      when the entire interval has been considered the answer is</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">!      returned along with an estimate of the error.</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  225 <span class="keywordflow">continue</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      <a class="code" href="../../d8/dff/namespaceorigen__beta.html#a93822825195e3a763bea095e1e22c249">cosimp</a> = summ*(c/6.)</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      err    = abs(err)</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      isub   = nsub</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      <span class="keywordflow">if</span> (iflog == 1) isub = -nsub</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      <span class="keywordflow">return</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      2000 <span class="keyword">format</span>(/<span class="stringliteral">&#39; *** cosimp - trouble integrating over (&#39;</span>,e13.5,<span class="stringliteral">&#39;,&#39;</span>,e13.5,<span class="stringliteral">&#39;)&#39;</span>,/,&amp;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;         <span class="stringliteral">&#39; estimated integral and error are &#39;</span>,e23.14,<span class="stringliteral">&#39; and &#39;</span>,e13.5,<span class="stringliteral">&#39; ***&#39;</span>/)</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="keyword">  end function </span><a class="code" href="../../d8/dff/namespaceorigen__beta.html#a93822825195e3a763bea095e1e22c249">cosimp</a></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">  !&gt; return normalizing factors v1 and v2</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="keyword">  subroutine </span><a class="code" href="../../d8/dff/namespaceorigen__beta.html#af3257f602b31173c3e989351557fd836">normalize</a>(v1, v2, a, b, dist2, dist1, eps, isub, emax, z)</div>
<div class="line"><a name="l00376"></a><span class="lineno"><a class="line" href="../../d8/dff/namespaceorigen__beta.html#af3257f602b31173c3e989351557fd836">  376</a></span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="comment">!   D u m m y   A r g u m e n t s</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(inout)</span>  :: isub</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(out)</span> :: v1</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(out)</span> :: v2</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span>  :: a</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span>  :: b</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span>  :: eps</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span> :: emax</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: z</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="comment">!   E x t e r n a l   F u n c t i o n s</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">external</span> :: dist2</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">external</span> :: dist1</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    v1 = <a class="code" href="../../d8/dff/namespaceorigen__beta.html#a93822825195e3a763bea095e1e22c249">cosimp</a>(a,b,dist1,eps,isub,emax,z)</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    v2 = <a class="code" href="../../d8/dff/namespaceorigen__beta.html#a93822825195e3a763bea095e1e22c249">cosimp</a>(a,b,dist2,eps,isub,emax,z)</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="keyword">  end subroutine </span><a class="code" href="../../d8/dff/namespaceorigen__beta.html#af3257f602b31173c3e989351557fd836">normalize</a></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">  !&gt; beta energy distribution for first forbidden transitions</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="keyword">  real(C_DOUBLE) </span><span class="keyword">function </span><a class="code" href="../../d8/dff/namespaceorigen__beta.html#ae44b0ef4c7a5c781d807b4631fc9fcee">dist1f</a> (e, emax, z)</div>
<div class="line"><a name="l00400"></a><span class="lineno"><a class="line" href="../../d8/dff/namespaceorigen__beta.html#ae44b0ef4c7a5c781d807b4631fc9fcee">  400</a></span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="comment">!   D u m m y   A r g u m e n t s</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span> :: e</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span> :: emax</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: z</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="comment">!   L o c a l   V a r i a b l e s</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span> :: emc, a0, a1, a2, w, wmax</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    emc = 0.511</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    a0  = <a class="code" href="../../d8/dff/namespaceorigen__beta.html#a3bcefa1475ae97eaed731cfa2d04f26b">aaa</a>(z+1,1)</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    a1  = <a class="code" href="../../d8/dff/namespaceorigen__beta.html#a3bcefa1475ae97eaed731cfa2d04f26b">aaa</a>(z+1,2)</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    a2  = <a class="code" href="../../d8/dff/namespaceorigen__beta.html#a3bcefa1475ae97eaed731cfa2d04f26b">aaa</a>(z+1,3)</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="keywordflow">if</span> (e &lt;= emax) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;       w      = e/emc + 1.0</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;       wmax   = emax/emc + 1.0</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;       <a class="code" href="../../d8/dff/namespaceorigen__beta.html#ae44b0ef4c7a5c781d807b4631fc9fcee">dist1f</a> = ((w*w - 1) + (wmax - w)**2) * (a0 + a1*e + a2*e*e) * (emax - e)**2</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;       <a class="code" href="../../d8/dff/namespaceorigen__beta.html#ae44b0ef4c7a5c781d807b4631fc9fcee">dist1f</a> = 0.0</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="keyword">  end function </span><a class="code" href="../../d8/dff/namespaceorigen__beta.html#ae44b0ef4c7a5c781d807b4631fc9fcee">dist1f</a></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">  !&gt; beta energy distribution of second forbidden transitions</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="keyword">  real(C_DOUBLE) </span><span class="keyword">function </span><a class="code" href="../../d8/dff/namespaceorigen__beta.html#a4b07ca97ecc86f1adca36a9d34e0e6e2">dist2f</a> (e, emax, z)</div>
<div class="line"><a name="l00427"></a><span class="lineno"><a class="line" href="../../d8/dff/namespaceorigen__beta.html#a4b07ca97ecc86f1adca36a9d34e0e6e2">  427</a></span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="comment">!   D u m m y   A r g u m e n t s</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span> :: e</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span> :: emax</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: z</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="comment">!   L o c a l   V a r i a b l e s</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span> :: emc, a0, a1, a2, w, wmax</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    emc = 0.511</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    a0  = <a class="code" href="../../d8/dff/namespaceorigen__beta.html#a3bcefa1475ae97eaed731cfa2d04f26b">aaa</a>(z+1,1)</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    a1  = <a class="code" href="../../d8/dff/namespaceorigen__beta.html#a3bcefa1475ae97eaed731cfa2d04f26b">aaa</a>(z+1,2)</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    a2  = <a class="code" href="../../d8/dff/namespaceorigen__beta.html#a3bcefa1475ae97eaed731cfa2d04f26b">aaa</a>(z+1,3)</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keywordflow">if</span> (e &lt;= emax) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;       w      = e/emc + 1.0</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;       wmax   = emax/emc + 1.0</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;       <a class="code" href="../../d8/dff/namespaceorigen__beta.html#a4b07ca97ecc86f1adca36a9d34e0e6e2">dist2f</a> = ((w*w - 1)**2 + (wmax - w)**4 + 10./3.*(w*w - 1)*(wmax - w)**&amp;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;          2)*(a0 + a1*e + a2*e*e)*(emax - e)**2</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;       <a class="code" href="../../d8/dff/namespaceorigen__beta.html#a4b07ca97ecc86f1adca36a9d34e0e6e2">dist2f</a> = 0.0</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="keyword">  end function </span><a class="code" href="../../d8/dff/namespaceorigen__beta.html#a4b07ca97ecc86f1adca36a9d34e0e6e2">dist2f</a></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">  !&gt; beta energy distribution of third forbidden transitions</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="keyword">  real(C_DOUBLE) </span><span class="keyword">function </span><a class="code" href="../../d8/dff/namespaceorigen__beta.html#a181dab62c2c97a1d7b3436780b1c4203">dist3f</a> (e, emax, z)</div>
<div class="line"><a name="l00455"></a><span class="lineno"><a class="line" href="../../d8/dff/namespaceorigen__beta.html#a181dab62c2c97a1d7b3436780b1c4203">  455</a></span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="comment">!   D u m m y   A r g u m e n t s</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span> :: e</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span> :: emax</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: z</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="comment">!   L o c a l   V a r i a b l e s</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span> :: emc, a0, a1, a2, w, wmax</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    emc = 0.511</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    a0  = <a class="code" href="../../d8/dff/namespaceorigen__beta.html#a3bcefa1475ae97eaed731cfa2d04f26b">aaa</a>(z+1,1)</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    a1  = <a class="code" href="../../d8/dff/namespaceorigen__beta.html#a3bcefa1475ae97eaed731cfa2d04f26b">aaa</a>(z+1,2)</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    a2  = <a class="code" href="../../d8/dff/namespaceorigen__beta.html#a3bcefa1475ae97eaed731cfa2d04f26b">aaa</a>(z+1,3)</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="keywordflow">if</span> (e &lt;= emax) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;       w      = e/emc + 1.0</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;       wmax   = emax/emc + 1.0</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;       <a class="code" href="../../d8/dff/namespaceorigen__beta.html#a181dab62c2c97a1d7b3436780b1c4203">dist3f</a> = ((w*w - 1)**3 + (wmax - w)**6 + 7.0*(w*w - 1)*(wmax - w)**2*(&amp;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;          (w*w - 1) + (wmax - w)**2))*(a0 + a1*e + a2*e*e)*(emax - e)**2</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;       <a class="code" href="../../d8/dff/namespaceorigen__beta.html#a181dab62c2c97a1d7b3436780b1c4203">dist3f</a> = 0.0</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="keyword">  end function </span><a class="code" href="../../d8/dff/namespaceorigen__beta.html#a181dab62c2c97a1d7b3436780b1c4203">dist3f</a></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment">  !&gt; beta energy distribution for allowed transitions</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="keyword">  real(C_DOUBLE) </span><span class="keyword">function </span><a class="code" href="../../d8/dff/namespaceorigen__beta.html#a92d3ac2965d4d50395a72e2006e3059f">dista</a> (e, emax, z)</div>
<div class="line"><a name="l00483"></a><span class="lineno"><a class="line" href="../../d8/dff/namespaceorigen__beta.html#a92d3ac2965d4d50395a72e2006e3059f">  483</a></span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="comment">!   D u m m y   A r g u m e n t s</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span> :: e</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span> :: emax</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: z</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="comment">!   L o c a l   V a r i a b l e s</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span> :: a0, a1, a2</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    a0 = <a class="code" href="../../d8/dff/namespaceorigen__beta.html#a3bcefa1475ae97eaed731cfa2d04f26b">aaa</a>(z+1,1)</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    a1 = <a class="code" href="../../d8/dff/namespaceorigen__beta.html#a3bcefa1475ae97eaed731cfa2d04f26b">aaa</a>(z+1,2)</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    a2 = <a class="code" href="../../d8/dff/namespaceorigen__beta.html#a3bcefa1475ae97eaed731cfa2d04f26b">aaa</a>(z+1,3)</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="keywordflow">if</span> (e &lt;= emax) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;       <a class="code" href="../../d8/dff/namespaceorigen__beta.html#a92d3ac2965d4d50395a72e2006e3059f">dista</a> = (a0 + a1*e + a2*e*e)*(emax - e)**2</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;       <a class="code" href="../../d8/dff/namespaceorigen__beta.html#a92d3ac2965d4d50395a72e2006e3059f">dista</a> = 0.0</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="keywordflow">    endif</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="keyword">  end function </span><a class="code" href="../../d8/dff/namespaceorigen__beta.html#a92d3ac2965d4d50395a72e2006e3059f">dista</a></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">  !&gt; energy-weighted distribution first forbidden unique transition</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="keyword">  real(C_DOUBLE) </span><span class="keyword">function </span><a class="code" href="../../d8/dff/namespaceorigen__beta.html#a334c44acb77421ca86742062c4111d03">diste1f</a> (e, emax,z)</div>
<div class="line"><a name="l00507"></a><span class="lineno"><a class="line" href="../../d8/dff/namespaceorigen__beta.html#a334c44acb77421ca86742062c4111d03">  507</a></span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="comment">!   D u m m y   A r g u m e n t s</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span>  :: e</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span> :: emax</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: z</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <a class="code" href="../../d8/dff/namespaceorigen__beta.html#a334c44acb77421ca86742062c4111d03">diste1f</a> = e * <a class="code" href="../../d8/dff/namespaceorigen__beta.html#ae44b0ef4c7a5c781d807b4631fc9fcee">dist1f</a>(e, emax, z)</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="keyword">  end function </span><a class="code" href="../../d8/dff/namespaceorigen__beta.html#a334c44acb77421ca86742062c4111d03">diste1f</a></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">  !&gt; energy-weighted distribution second forbidden unique transition</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="keyword">  real(C_DOUBLE) </span><span class="keyword">function </span><a class="code" href="../../d8/dff/namespaceorigen__beta.html#a55d06f3b2a62943425ecbf5f2a900cf6">diste2f</a> (e, emax, z)</div>
<div class="line"><a name="l00519"></a><span class="lineno"><a class="line" href="../../d8/dff/namespaceorigen__beta.html#a55d06f3b2a62943425ecbf5f2a900cf6">  519</a></span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="comment">!   D u m m y   A r g u m e n t s</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span>  :: e</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span> :: emax</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: z</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <a class="code" href="../../d8/dff/namespaceorigen__beta.html#a55d06f3b2a62943425ecbf5f2a900cf6">diste2f</a> = e * <a class="code" href="../../d8/dff/namespaceorigen__beta.html#a4b07ca97ecc86f1adca36a9d34e0e6e2">dist2f</a>(e, emax, z)</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="keyword">  end function </span><a class="code" href="../../d8/dff/namespaceorigen__beta.html#a55d06f3b2a62943425ecbf5f2a900cf6">diste2f</a></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment">  !&gt; energy-weighted dist for third forbidden unique transitions</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="keyword">  real(C_DOUBLE) </span><span class="keyword">function </span><a class="code" href="../../d8/dff/namespaceorigen__beta.html#ac63ea5ddc4a22f03f89f7b4887833d96">diste3f</a> (e, emax, z)</div>
<div class="line"><a name="l00531"></a><span class="lineno"><a class="line" href="../../d8/dff/namespaceorigen__beta.html#ac63ea5ddc4a22f03f89f7b4887833d96">  531</a></span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="comment">!   D u m m y   A r g u m e n t s</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span>  :: e</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span> :: emax</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: z</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <a class="code" href="../../d8/dff/namespaceorigen__beta.html#ac63ea5ddc4a22f03f89f7b4887833d96">diste3f</a> = e * <a class="code" href="../../d8/dff/namespaceorigen__beta.html#a181dab62c2c97a1d7b3436780b1c4203">dist3f</a>(e, emax, z)</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="keyword">  end function </span><a class="code" href="../../d8/dff/namespaceorigen__beta.html#ac63ea5ddc4a22f03f89f7b4887833d96">diste3f</a></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment">  !&gt; energy-weighted distribution for allowed transitions</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="keyword">  real(C_DOUBLE) </span><span class="keyword">function </span><a class="code" href="../../d8/dff/namespaceorigen__beta.html#aff540a8d5e4e7cc2ca5e8acdcdae4cf1">distea</a> (e, emax, z)</div>
<div class="line"><a name="l00543"></a><span class="lineno"><a class="line" href="../../d8/dff/namespaceorigen__beta.html#aff540a8d5e4e7cc2ca5e8acdcdae4cf1">  543</a></span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="comment">!   D u m m y   A r g u m e n t s</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span>  :: e</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span> :: emax</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: z</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <a class="code" href="../../d8/dff/namespaceorigen__beta.html#aff540a8d5e4e7cc2ca5e8acdcdae4cf1">distea</a> = e * <a class="code" href="../../d8/dff/namespaceorigen__beta.html#a92d3ac2965d4d50395a72e2006e3059f">dista</a>(e, emax, z)</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="keyword">  end function </span><a class="code" href="../../d8/dff/namespaceorigen__beta.html#aff540a8d5e4e7cc2ca5e8acdcdae4cf1">distea</a></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="keyword">  subroutine </span>origen_beta__spectra(this, ityp, emax, z, prob, yield, eavg)</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="comment">!   D u m m y   A r g u m e n t s</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <span class="comment">!-----------------------------------------------</span><span class="comment"></span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment">    !&gt; the receiver</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="keywordtype">class</span>(<a class="code" href="../../db/dc5/structorigen__beta_1_1origen__beta__class.html">origen_beta_class</a>), <span class="keywordtype">intent(inout)</span> :: this<span class="comment"></span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment">    !&gt;</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: ityp<span class="comment"></span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">    !&gt;</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: z<span class="comment"></span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment">    !&gt;</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span>    :: emax<span class="comment"></span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment">    !&gt;</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span>    :: prob<span class="comment"></span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment">    !&gt;</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(out)</span>   :: eavg<span class="comment"></span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">    !&gt;</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(out)</span>   :: yield(this%opts%ngroups)</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <span class="comment">!   L o c a l   V a r i a b l e s</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <span class="keywordtype">integer</span> :: isub, i</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span> :: eps, x1, x2, e1, e2, b</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="comment">! *** normalztion and beta energy release variables</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    yield = 0.0</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    eps  = 0.001</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    isub = 4</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="keywordflow">select case</span> (ityp)</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="keywordflow">case</span> (0)</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;       <span class="keyword">call </span><a class="code" href="../../d8/dff/namespaceorigen__beta.html#af3257f602b31173c3e989351557fd836">normalize</a> (x1, x2, 0.0d0, emax, <a class="code" href="../../d8/dff/namespaceorigen__beta.html#aff540a8d5e4e7cc2ca5e8acdcdae4cf1">distea</a>,  <a class="code" href="../../d8/dff/namespaceorigen__beta.html#a92d3ac2965d4d50395a72e2006e3059f">dista</a>,  eps, isub, emax, z)</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <span class="keywordflow">case</span> (1)</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;       <span class="keyword">call </span><a class="code" href="../../d8/dff/namespaceorigen__beta.html#af3257f602b31173c3e989351557fd836">normalize</a> (x1, x2, 0.0d0, emax, <a class="code" href="../../d8/dff/namespaceorigen__beta.html#a334c44acb77421ca86742062c4111d03">diste1f</a>, <a class="code" href="../../d8/dff/namespaceorigen__beta.html#ae44b0ef4c7a5c781d807b4631fc9fcee">dist1f</a>, eps, isub, emax, z)</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <span class="keywordflow">case</span> (2)</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;       <span class="keyword">call </span><a class="code" href="../../d8/dff/namespaceorigen__beta.html#af3257f602b31173c3e989351557fd836">normalize</a> (x1, x2, 0.0d0, emax, <a class="code" href="../../d8/dff/namespaceorigen__beta.html#a55d06f3b2a62943425ecbf5f2a900cf6">diste2f</a>, <a class="code" href="../../d8/dff/namespaceorigen__beta.html#a4b07ca97ecc86f1adca36a9d34e0e6e2">dist2f</a>, eps, isub, emax, z)</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="keywordflow">case</span> (3)</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;       <span class="keyword">call </span><a class="code" href="../../d8/dff/namespaceorigen__beta.html#af3257f602b31173c3e989351557fd836">normalize</a> (x1, x2, 0.0d0, emax, <a class="code" href="../../d8/dff/namespaceorigen__beta.html#ac63ea5ddc4a22f03f89f7b4887833d96">diste3f</a>, <a class="code" href="../../d8/dff/namespaceorigen__beta.html#a181dab62c2c97a1d7b3436780b1c4203">dist3f</a>, eps, isub, emax, z)</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="keywordflow">    case default</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;       <span class="keyword">call </span>rstop(<span class="stringliteral">&quot;Invalid beta transition type&quot;</span>, 507)</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="keywordflow">    end select</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <span class="comment">! *** calculate spectrum in this%opts%ngroups energy groups</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="keywordflow">do</span> i = 1, this%opts%ngroups</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;      e1 = this%opts%bounds(i)</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;      e2 = this%opts%bounds(i+1)</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;      <span class="keywordflow">if</span> (e1 &lt; e2) <span class="keyword">call </span>rstop(<span class="stringliteral">&quot;Invalid beta group structure ordering.&quot;</span>, 771)</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;      <span class="keywordflow">if</span> (abs(emax - e2) &lt; 1.0e-4) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        yield(i) = 0.</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        cycle</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="keywordflow">      endif</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;      e1   = min(emax,e1)</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;      <span class="comment">! set maximum error eps on integration routine</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;      eps  = 0.001</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;      isub = 2</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;      <span class="keywordflow">select case</span> (ityp)</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;      <span class="keywordflow">case</span> (0)</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;          b = <a class="code" href="../../d8/dff/namespaceorigen__beta.html#a93822825195e3a763bea095e1e22c249">cosimp</a>(e2,e1,<a class="code" href="../../d8/dff/namespaceorigen__beta.html#a92d3ac2965d4d50395a72e2006e3059f">dista</a>,eps,isub,emax,z)</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;      <span class="keywordflow">case</span> (1)</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;          b = <a class="code" href="../../d8/dff/namespaceorigen__beta.html#a93822825195e3a763bea095e1e22c249">cosimp</a>(e2,e1,<a class="code" href="../../d8/dff/namespaceorigen__beta.html#ae44b0ef4c7a5c781d807b4631fc9fcee">dist1f</a>,eps,isub,emax,z)</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;      <span class="keywordflow">case</span> (2)</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;          b = <a class="code" href="../../d8/dff/namespaceorigen__beta.html#a93822825195e3a763bea095e1e22c249">cosimp</a>(e2,e1,<a class="code" href="../../d8/dff/namespaceorigen__beta.html#a4b07ca97ecc86f1adca36a9d34e0e6e2">dist2f</a>,eps,isub,emax,z)</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;      <span class="keywordflow">case</span> (3)</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;          b = <a class="code" href="../../d8/dff/namespaceorigen__beta.html#a93822825195e3a763bea095e1e22c249">cosimp</a>(e2,e1,<a class="code" href="../../d8/dff/namespaceorigen__beta.html#a181dab62c2c97a1d7b3436780b1c4203">dist3f</a>,eps,isub,emax,z)</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="keywordflow">      case default</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        <span class="keyword">call </span>rstop(<span class="stringliteral">&quot;Invalid beta transition type&quot;</span>, 506)</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="keywordflow">      end select</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;      <span class="comment">! check for integration problems</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;      <span class="keywordflow">if</span> (isub &lt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        scalereportwarning(1, fmt=100) i, e1, e2, isub, emax ; scalefinalizewarning()</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;      <span class="comment">! *** yield is normalized beta distribution for transition</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;      yield(i) = prob * b / x1</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="comment">! *** eavg is average beta energy release in transition</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    eavg = prob*(x2/x1)</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    100 <span class="keyword">format</span> (<span class="stringliteral">&#39;integration errors   grp=&#39;</span>, i4, <span class="stringliteral">&#39; elo=&#39;</span>, f7.3, &amp;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;          <span class="stringliteral">&#39;  ehi=&#39;</span>, f7.3, <span class="stringliteral">&#39; isub=&#39;</span>, i4, <span class="stringliteral">&#39; emax=&#39;</span>, f7.3 )</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="keyword">  end subroutine </span>origen_beta__spectra</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="comment">  !&gt; Prints the beta tables.</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="keyword">  subroutine </span>origen_beta__output(this, time, xunit, case_tag, case_title, case_number, max_case)</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <span class="comment">!   D u m m y   A r g u m e n t s</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <span class="comment">!-----------------------------------------------</span><span class="comment"></span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="comment">    !&gt; the receiver</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <span class="keywordtype">class</span>(<a class="code" href="../../db/dc5/structorigen__beta_1_1origen__beta__class.html">origen_beta_class</a>), <span class="keywordtype">intent(inout)</span> :: this<span class="comment"></span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="comment">    !&gt; end-of-step time</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span> :: time(0:this%nsteps)</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <span class="comment">!real(C_DOUBLE), intent(in) :: time(0:) ! Assumed size to avoid temp. array creation</span><span class="comment"></span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="comment">    !&gt; Name of the time unit</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <span class="keywordtype">character(4)</span>, <span class="keywordtype">intent(in)</span> :: xunit<span class="comment"></span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="comment">    !&gt; Titles</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <span class="keywordtype">character(*)</span>, <span class="keywordtype">intent(in)</span> :: case_tag,case_title<span class="comment"></span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="comment">    !&gt; Numbers</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: case_number,max_case</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="comment">!   L o c a l   V a r i a b l e s</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <span class="comment">!-----------------------------------------------</span><span class="comment"></span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="comment">    !&gt; cycle variables</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <span class="keywordtype">integer</span> :: n, k, j, i, l<span class="comment"></span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="comment">    !&gt; title buffer for table print</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    <span class="keywordtype">character(20)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:)</span> :: varlist<span class="comment"></span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="comment">    !&gt; data buffer for table print</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:,:)</span> :: xdata<span class="comment"></span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="comment">    !&gt; buffer for nuclide</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <span class="keywordtype">character(7)</span> :: name<span class="comment"></span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="comment">    !&gt; Library bounds</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <span class="keywordtype">integer</span> :: bounds(0:4,2)</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span> :: emean, gfrac</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <span class="keyword">allocate</span>(varlist(this%lib%get_itot()))</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <span class="keyword">allocate</span>(xdata(0:this%nsteps, this%lib%get_itot()))</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <span class="keyword">call </span>this%lib%get_bounds(bounds)</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <span class="comment">!--- initial banner printout</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <span class="keyword">call </span><a class="code" href="../../da/da9/namespaceauxiliary.html#a43f424d74b994ecfdd9e76484b86b005">table_banner</a>( <span class="stringliteral">&#39;Beta emission overview&#39;</span>, case_tag, case_title, case_number, max_case)</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <span class="keyword">call </span><a class="code" href="../../da/da9/namespaceauxiliary.html#af858d73b4c61da5add697f41cebfa845">output</a>( <span class="stringliteral">&#39;The sources include photons for the following nuclide groups :&#39;</span>)</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="keywordflow">if</span> (this%opts%source_nuclide_type == 4 .or. this%opts%source_nuclide_type == 1) <span class="keyword">call </span><a class="code" href="../../da/da9/namespaceauxiliary.html#af858d73b4c61da5add697f41cebfa845">output</a>( <span class="stringliteral">&#39;light elements&#39;</span>)</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <span class="keywordflow">if</span> (this%opts%source_nuclide_type == 4 .or. this%opts%source_nuclide_type == 2) <span class="keyword">call </span><a class="code" href="../../da/da9/namespaceauxiliary.html#af858d73b4c61da5add697f41cebfa845">output</a>( <span class="stringliteral">&#39;actinides&#39;</span>)</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    <span class="keywordflow">if</span> (this%opts%source_nuclide_type == 4 .or. this%opts%source_nuclide_type == 3) <span class="keyword">call </span><a class="code" href="../../da/da9/namespaceauxiliary.html#af858d73b4c61da5add697f41cebfa845">output</a>( <span class="stringliteral">&#39;fission products &#39;</span>)</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="keyword">call </span><a class="code" href="../../da/da9/namespaceauxiliary.html#a0b8c2210d041dace1661f87ae2b80695">table_tail</a>()</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <span class="comment">!--- output the beta source</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    <span class="keywordflow">if</span> (this%opts%print_summary) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;      report_debug(<span class="stringliteral">&quot;Printing activity&quot;</span>)</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;      k = 0</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;      <span class="keywordflow">do</span> n = 1, this%lib%get_itot()</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;        <span class="comment">! rip out zero lines</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;        <span class="keywordflow">if</span> (sum(this%source(0:this%nsteps,n)) &gt; <a class="code" href="../../dc/d32/group___fortran_constants.html#ga595a7a58c908ec8f7c6778d9d5b532aa">err</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;          k = k + 1</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;          <span class="keyword">call </span><a class="code" href="../../da/da9/namespaceauxiliary.html#a8402482545d523f5b69b63e63c068644">nuclide_compact</a>(this%lib%nucl(n), name)</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;          varlist(k) = name</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;          xdata(:,k) = this%source(:,n)</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;      <span class="keywordflow">if</span> (k &gt; 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        <span class="keyword">call </span><a class="code" href="../../da/da9/namespaceauxiliary.html#a43f424d74b994ecfdd9e76484b86b005">table_banner</a>( <span class="stringliteral">&quot;Beta source (1/s)&quot;</span>, case_tag, case_title, case_number, max_case)</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        <span class="keyword">call </span><a class="code" href="../../da/da9/namespaceauxiliary.html#a05e00315b65986b3a1952870088359f8">print_time_table</a>( this%nsteps, k, time, xunit, .false., .true., varlist(:k), xdata(:,:k))</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        <span class="keyword">call </span><a class="code" href="../../da/da9/namespaceauxiliary.html#a0b8c2210d041dace1661f87ae2b80695">table_tail</a>()</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <span class="comment">!--- print the beta emitters</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <span class="keywordflow">if</span> (this%opts%print_emitters &gt;= 0 .and. this%opts%print_emitters &lt;= this%nsteps) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;      report_debug(<span class="stringliteral">&quot;Printing emitters&quot;</span>)</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;      <span class="keyword">call </span><a class="code" href="../../da/da9/namespaceauxiliary.html#a43f424d74b994ecfdd9e76484b86b005">table_banner</a>( <span class="stringliteral">&quot;Principal beta emitters&quot;</span>, case_tag, case_title, case_number, max_case)</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;      k = 0</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;      <span class="keywordflow">do</span> j = 1, this%opts%ngroups</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        <span class="keywordflow">if</span> (this%spectrum(j, this%opts%print_emitters) &lt; <a class="code" href="../../dc/d32/group___fortran_constants.html#ga595a7a58c908ec8f7c6778d9d5b532aa">err</a>) cycle</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        emean = (this%opts%bounds(j) + this%opts%bounds(j+1)) / 2</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;        <span class="keywordflow">if</span> (j /= 1) <span class="keyword">call </span><a class="code" href="../../da/da9/namespaceauxiliary.html#a87f00206fa389873214d5885a0eface7">print_hrule</a>()</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        <span class="keywordflow">if</span> (emean &gt; 0.01) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;          soutline(1, fmt=10500) j, emean, this%opts%emitters_cutoff, this%spectrum(j, this%opts%print_emitters), time(this%opts%print_emitters), xunit</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;          soutline(1, fmt=10501) j, emean, this%opts%emitters_cutoff, this%spectrum(j, this%opts%print_emitters), time(this%opts%print_emitters), xunit</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        gfrac = this%spectrum(j, this%opts%print_emitters) * this%opts%emitters_cutoff * 1.0d-2</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        <span class="keywordflow">do</span> l = <a class="code" href="../../db/d88/group___fortran_identifiers.html#ga4ef7659bef2334fb48756e1fda635855">origen_sublib_1lt</a>, <a class="code" href="../../db/d88/group___fortran_identifiers.html#ga879cc97cd4248115b716774c58598031">origen_sublib_3fp</a></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;          <span class="keywordflow">do</span> i = bounds(l,1), bounds(l,2)</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;            <span class="keywordflow">if</span> (this%emitters(i,j) &lt; gfrac) cycle</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;            <span class="keyword">call </span><a class="code" href="../../da/da9/namespaceauxiliary.html#a8402482545d523f5b69b63e63c068644">nuclide_compact</a>( this%lib%nucl(i), name )</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;            soutline(1, fmt=<span class="stringliteral">&quot;(3x,a8,4x,1pe11.3)&quot;</span>) name, this%emitters(i,j)</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;      <span class="keyword">call </span><a class="code" href="../../da/da9/namespaceauxiliary.html#a0b8c2210d041dace1661f87ae2b80695">table_tail</a>()</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;      10500 <span class="keyword">format</span>(2x, <span class="stringliteral">&#39;Principal beta sources (betas/sec) in group&#39;</span>,i6,<span class="stringliteral">&#39; mean energy &#39;</span>,f7.4,<span class="stringliteral">&#39; MeV;&#39;</span>,/&amp;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;               <span class="stringliteral">&#39;nuclides exceeding &#39;</span>,f8.1,<span class="stringliteral">&#39; % of total group release rate &#39;</span>,es10.2,<span class="stringliteral">&#39; at &#39;</span>,f7.1,a3)</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;      10501 <span class="keyword">format</span>(2x, <span class="stringliteral">&#39;Principal beta sources (betas/sec) in group&#39;</span>,i6,<span class="stringliteral">&#39; mean energy &#39;</span>,e11.4,<span class="stringliteral">&#39; MeV;&#39;</span>,/&amp;</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;               <span class="stringliteral">&#39;nuclides exceeding &#39;</span>,f8.1,<span class="stringliteral">&#39; % of total group release rate &#39;</span>,es10.2,<span class="stringliteral">&#39; at &#39;</span>,f7.1,a3)</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <span class="comment">!--- print the beta spectra</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <span class="keywordflow">if</span> (this%opts%print_spectra) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;      report_debug(<span class="stringliteral">&quot;Printing beta spectra&quot;</span>)</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;      <span class="keyword">call </span><a class="code" href="../../da/da9/namespaceauxiliary.html#a43f424d74b994ecfdd9e76484b86b005">table_banner</a>( <span class="stringliteral">&quot;Beta spectrum (1/s)&quot;</span>, case_tag, case_title, case_number, max_case)</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;      <span class="keyword">call </span><a class="code" href="../../da/da9/namespaceauxiliary.html#a1ee8479ace5bcf8b1b2efa8ce35cc7f1">print_multigroup_time_table</a>( this%opts%ngroups, this%nsteps, this%opts%bounds, time, xunit, .false., .true., this%spectrum)</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;      <span class="keyword">call </span><a class="code" href="../../da/da9/namespaceauxiliary.html#a0b8c2210d041dace1661f87ae2b80695">table_tail</a>()</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;      <span class="keyword">call </span><a class="code" href="../../da/da9/namespaceauxiliary.html#a43f424d74b994ecfdd9e76484b86b005">table_banner</a>( <span class="stringliteral">&quot;Beta energy release rate (MeV/s)&quot;</span>, case_tag, case_title, case_number, max_case)</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;      varlist(1) = <span class="stringliteral">&#39;total&#39;</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;      xdata(:,1) = this%ebeta(:)</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;      varlist(2) = <span class="stringliteral">&#39;residual*&#39;</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;      xdata(:,2) = this%extra(:)</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;      <span class="keyword">call </span><a class="code" href="../../da/da9/namespaceauxiliary.html#a05e00315b65986b3a1952870088359f8">print_time_table</a>( this%nsteps, 2, time, xunit, .false., .false., varlist(:2), xdata(:,:2))</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;      <span class="keyword">call </span><a class="code" href="../../da/da9/namespaceauxiliary.html#a6d420a0eea6f06adff6b45a8076da66b">print_break</a>()</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;      <span class="keyword">call </span><a class="code" href="../../da/da9/namespaceauxiliary.html#af858d73b4c61da5add697f41cebfa845">output</a>( <span class="stringliteral">&quot;   * approximate energy of transitions without evaluated spectral data (energy included in totals)&quot;</span>)</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;      <span class="keyword">call </span><a class="code" href="../../da/da9/namespaceauxiliary.html#a0b8c2210d041dace1661f87ae2b80695">table_tail</a>()</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    <span class="keyword">deallocate</span>(varlist,xdata)</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    report_debug(<span class="stringliteral">&quot;Beta output finished&quot;</span>)</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="keyword">  end subroutine </span>origen_beta__output</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="keyword">  subroutine </span>origen_beta__init(this, lib, itot, blib, opts, nsteps, concentrations)</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    <span class="comment">!   D u m m y   A r g u m e n t s</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="comment">!-----------------------------------------------</span><span class="comment"></span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="comment">    !&gt; the receiver</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    <span class="keywordtype">class</span>(<a class="code" href="../../db/dc5/structorigen__beta_1_1origen__beta__class.html">origen_beta_class</a>), <span class="keywordtype">intent(inout)</span> :: this<span class="comment"></span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="comment">    !&gt; associated origen library</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="../../dc/d7b/structorigen__librarywrapper__m_1_1origen__librarywrapper.html">origen_librarywrapper</a>), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">target</span> :: lib<span class="comment"></span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="comment">    !&gt; Total number of nuclides</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: itot<span class="comment"></span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="comment">    !&gt; associated beta library</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="../../de/d08/structbeta__library_1_1beta__library__class.html">beta_library_class</a>), <span class="keywordtype">intent(in)</span>, <span class="keywordtype">target</span> :: blib<span class="comment"></span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;<span class="comment">    !&gt; Neutron calculation options</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    <span class="keywordtype">type</span>(<a class="code" href="../../d4/d7f/structorigen__beta_1_1origen__beta__options.html">origen_beta_options</a>), <span class="keywordtype">intent(in)</span> :: opts<span class="comment"></span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;<span class="comment">    !&gt; Number of steps</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: nsteps<span class="comment"></span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="comment">    !&gt; Nuclide concentration matrix</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span> :: concentrations(0:nsteps, itot)</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <span class="comment">!   L o c a l   V a r i a b l e s</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <span class="comment">!-----------------------------------------------</span><span class="comment"></span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="comment">    !&gt; cycle variables</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    <span class="keywordtype">integer</span> :: i, n, m, l</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    <span class="comment">! spectrum parameters</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span> :: ebar, emax, eavg, prob, esum</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <span class="comment">! type of beta transition</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    <span class="keywordtype">integer</span> :: ityp</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <span class="comment">! Z of the current nuclide</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <span class="keywordtype">integer</span> :: z</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    <span class="comment">! any beta lines for the current nuclide?</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    <span class="keywordtype">logical</span> :: has_data</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    <span class="comment">! spectrum for the current line</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">allocatable</span> :: sdata(:)</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <span class="comment">! name of the current nuclide</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    <span class="keywordtype">character(7)</span> :: name<span class="comment"></span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="comment">    !&gt; Library bounds</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <span class="keywordtype">integer</span> :: libBounds(0:4,2)</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    this%lib =&gt; lib</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    this%blib =&gt; blib</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    this%opts = opts</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    this%nsteps = nsteps</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <span class="comment">! Autodetect direction of energy group boundaries</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <span class="keywordflow">if</span> (this%opts%bounds(1) &lt; this%opts%bounds(this%opts%ngroups+1)) <span class="keyword">call </span><a class="code" href="../../da/da9/namespaceauxiliary.html#acdb484b80699451123dd41004ee7c38a">flip</a>(this%opts%ngroups+1, this%opts%bounds)</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    <span class="comment">! get memory</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    <span class="keyword">allocate</span>(this%source(0:nsteps,lib%get_itot()))</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    <span class="keyword">allocate</span>(this%yield(lib%get_itot(),this%opts%ngroups))</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    <span class="comment">!allocate(this%spectrum(0:nsteps,this%opts%ngroups))</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    <span class="keyword">allocate</span>(this%spectrum(this%opts%ngroups,0:nsteps))</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    <span class="keyword">allocate</span>(this%ebeta(0:nsteps))</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    <span class="keyword">allocate</span>(this%extra(0:nsteps))</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    <span class="keyword">allocate</span>(sdata(this%opts%ngroups))</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    this%source(:,:) = 0.0d0</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    <span class="comment">! calculate the beta source</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    <span class="keywordflow">do</span> i = 1, lib%get_itot()</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;      this%source(:,i) = blib%fb(i) * concentrations(:,i) * blib%bdis(i) * <a class="code" href="../../dc/d32/group___fortran_constants.html#ga6783933ba842c8f5a92a23b0306028ad">avogadro</a></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    this%spectrum = 0.0</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    this%ebeta(:) = 0.0</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    this%extra(:) = 0.0</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    <span class="comment">! get nuclide bounds, i.e. number in each sublibrary</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    <span class="keyword">call </span>this%lib%get_bounds(libbounds)</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    <span class="comment">! calculate the spectra</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    <span class="keywordflow">do</span> l = <a class="code" href="../../db/d88/group___fortran_identifiers.html#ga4ef7659bef2334fb48756e1fda635855">origen_sublib_1lt</a>, <a class="code" href="../../db/d88/group___fortran_identifiers.html#ga879cc97cd4248115b716774c58598031">origen_sublib_3fp</a></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;      <span class="comment">! skip unwanted library</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;      <span class="keywordflow">if</span> ((this%opts%source_nuclide_type /= 4) .and. (this%opts%source_nuclide_type /= l)) cycle</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;      <span class="keywordflow">do</span> n = libbounds(l,1), libbounds(l,2)</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;        <span class="comment">! SES: Check if beta branch exists; if not, skip nuclide</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;        <span class="keywordflow">if</span> (blib%fb(n) &lt; <a class="code" href="../../dc/d32/group___fortran_constants.html#ga595a7a58c908ec8f7c6778d9d5b532aa">err</a>) cycle</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        <span class="keywordflow">if</span> (sum(concentrations(:,n)) &lt; <a class="code" href="../../dc/d32/group___fortran_constants.html#ga595a7a58c908ec8f7c6778d9d5b532aa">err</a>) cycle</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        esum = 0</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;        ebar = 0</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;        z = this%lib%nucl(n) / 10000</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;        <span class="keyword">call </span><a class="code" href="../../da/da9/namespaceauxiliary.html#a8402482545d523f5b69b63e63c068644">nuclide_compact</a>(this%lib%nucl(n), name)</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;        <span class="keywordflow">if</span> (blib%n_lines(n) == 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;          <span class="comment">! no data</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;          has_data = .false.</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;          <span class="keywordflow">if</span> (l == <a class="code" href="../../db/d88/group___fortran_identifiers.html#gaa0f8add03ff5e139c04ae8394bf69574">origen_sublib_2ac</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;            soutline(1, fmt=<span class="stringliteral">&quot;(a6,&#39; spectral data missing: skip nuclide; fb=&#39;,es9.2)&quot;</span>) name, blib%fb(n)</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;            prob = blib%fb(n)</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;            <span class="keywordflow">if</span> (this%lib%q(n) &gt;= 1.0e-03) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;              ityp = 0</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;              ebar = this%lib%q(n) * (1.0 - this%lib%fg(n))</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;              emax = 3.0 * ebar</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;              <span class="keywordflow">if</span> ( emax &lt; 1.0e-05 ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;                soutline(1, fmt=<span class="stringliteral">&quot;(a6,&#39; spectral data missing: beta energy is zero; fb=&#39;,es9.2,&#39; emax=&#39;,f6.3)&quot;</span>) name, prob, emax</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;              <span class="keywordflow">else</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                soutline(1, fmt=<span class="stringliteral">&quot;(a6,&#39; spectral data missing: assuming allowed type; fb=&#39;,es9.2,&#39; emax=&#39;,f6.3)&quot;</span>) name, prob, emax</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                report_debug(<span class="stringliteral">&quot;No data - allowed type assumed&quot;</span>)</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                <span class="keyword">call </span>this%spectra(ityp, emax, z, prob, sdata, eavg)</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                this%yield(n,:) = this%yield(n,:) + sdata(:)</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                esum = esum + eavg</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;<span class="keywordflow">              end if</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;<span class="keywordflow">            end if</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;<span class="keywordflow">          end if</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;          has_data = .true.</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;          <span class="comment">! loop over lines</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;          <span class="keywordflow">do</span> i = blib%first_line(n), blib%first_line(n) + blib%n_lines(n) - 1</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;            prob = blib%bdata(1,i)</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;            emax = blib%bdata(2,i)</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;            ebar = blib%bdata(3,i)</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;            ityp = blib%btype(i)</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;            <span class="keyword">call </span>this%spectra (ityp, emax, z, prob, sdata, eavg)</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;            this%yield(n,:) = this%yield(n,:) + sdata(:)</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;            esum = esum + eavg</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        <span class="keywordflow">if</span> (ebar &gt; <a class="code" href="../../dc/d32/group___fortran_constants.html#ga595a7a58c908ec8f7c6778d9d5b532aa">err</a>) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;          this%yield(n,:) = this%yield(n,:) * ebar / esum</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;          <span class="keywordflow">do</span> m = 0, nsteps</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;            this%ebeta(m) = this%ebeta(m) + concentrations(m,n) * blib%bdis(n) * <a class="code" href="../../dc/d32/group___fortran_constants.html#ga6783933ba842c8f5a92a23b0306028ad">avogadro</a> * ebar</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;            <span class="keywordflow">if</span> (.not. has_data) this%extra(m) = this%extra(m) + concentrations(m,n) * blib%bdis(n) * <a class="code" href="../../dc/d32/group___fortran_constants.html#ga6783933ba842c8f5a92a23b0306028ad">avogadro</a> * ebar</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;            this%spectrum(:,m) = this%spectrum(:,m) + concentrations(m,n) * <a class="code" href="../../dc/d32/group___fortran_constants.html#ga6783933ba842c8f5a92a23b0306028ad">avogadro</a> * blib%bdis(n) * this%yield(n,:)</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="keywordflow">          end do</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="keywordflow">        end if</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    <span class="keywordflow">if</span> (this%opts%print_emitters &gt;= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;      <span class="keyword">allocate</span>(this%emitters(this%lib%get_itot(),this%opts%ngroups))</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;      <span class="keywordflow">do</span> i = 1, this%lib%get_itot()</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;        this%emitters(i,:) = concentrations(this%opts%print_emitters,i) * <a class="code" href="../../dc/d32/group___fortran_constants.html#ga6783933ba842c8f5a92a23b0306028ad">avogadro</a> * this%blib%bdis(i) * this%yield(i,:)</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<span class="keyword">  end subroutine </span>origen_beta__init</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;<span class="keyword">end module </span><a class="code" href="../../d8/dff/namespaceorigen__beta.html">origen_beta</a></div>
<div class="ttc" id="group___fortran_constants_html_ga595a7a58c908ec8f7c6778d9d5b532aa"><div class="ttname"><a href="../../dc/d32/group___fortran_constants.html#ga595a7a58c908ec8f7c6778d9d5b532aa">origen_definitions_m::err</a></div><div class="ttdeci">real(c_double) err</div><div class="ttdoc">Small value threshold below this value, isotopics should be set to zero formerly block 4...</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/de3/_definitions___m_8f90_source.html#l00026">Definitions_M.f90:26</a></div></div>
<div class="ttc" id="namespaceauxiliary_html_a8402482545d523f5b69b63e63c068644"><div class="ttname"><a href="../../da/da9/namespaceauxiliary.html#a8402482545d523f5b69b63e63c068644">auxiliary::nuclide_compact</a></div><div class="ttdeci">subroutine nuclide_compact(nuclide_id, name)</div><div class="ttdoc">Convert six-digit nuclide identifier to alphanumeric symbol. No spaces will be in the resulting strin...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/ddd/auxiliary_8f90_source.html#l00264">auxiliary.f90:264</a></div></div>
<div class="ttc" id="namespaceorigen__beta_html_a625618d5496b6f7d89b6d9eb3b7d3716"><div class="ttname"><a href="../../d8/dff/namespaceorigen__beta.html#a625618d5496b6f7d89b6d9eb3b7d3716">origen_beta::jjj</a></div><div class="ttdeci">integer jjj</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d3b/origen__beta_8f90_source.html#l00021">origen_beta.f90:21</a></div></div>
<div class="ttc" id="namespacebeta__library_html_ae55e31be08a5bd71c063eda2df066e22"><div class="ttname"><a href="../../d9/d6b/namespacebeta__library.html#ae55e31be08a5bd71c063eda2df066e22">beta_library::rbuffer</a></div><div class="ttdeci">character(2048), dimension(2048), private rbuffer</div><div class="ttdoc">character buffer </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d57/beta__library_8f90_source.html#l00019">beta_library.f90:19</a></div></div>
<div class="ttc" id="namespaceauxiliary_html_a0b8c2210d041dace1661f87ae2b80695"><div class="ttname"><a href="../../da/da9/namespaceauxiliary.html#a0b8c2210d041dace1661f87ae2b80695">auxiliary::table_tail</a></div><div class="ttdeci">subroutine table_tail()</div><div class="ttdoc">Print a nice footer for a table. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/ddd/auxiliary_8f90_source.html#l00038">auxiliary.f90:38</a></div></div>
<div class="ttc" id="namespaceorigen__beta_html_a92d3ac2965d4d50395a72e2006e3059f"><div class="ttname"><a href="../../d8/dff/namespaceorigen__beta.html#a92d3ac2965d4d50395a72e2006e3059f">origen_beta::dista</a></div><div class="ttdeci">real(c_double) function dista(e, emax, z)</div><div class="ttdoc">beta energy distribution for allowed transitions </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d3b/origen__beta_8f90_source.html#l00483">origen_beta.f90:483</a></div></div>
<div class="ttc" id="namespaceauxiliary_html_a87f00206fa389873214d5885a0eface7"><div class="ttname"><a href="../../da/da9/namespaceauxiliary.html#a87f00206fa389873214d5885a0eface7">auxiliary::print_hrule</a></div><div class="ttdeci">subroutine print_hrule()</div><div class="ttdoc">Print a single (-) horizontal rule. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/ddd/auxiliary_8f90_source.html#l00062">auxiliary.f90:62</a></div></div>
<div class="ttc" id="structorigen__librarywrapper__m_1_1origen__librarywrapper_html"><div class="ttname"><a href="../../dc/d7b/structorigen__librarywrapper__m_1_1origen__librarywrapper.html">origen_librarywrapper_m::origen_librarywrapper</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d22/_library_wrapper___m_8f90_source.html#l00026">LibraryWrapper_M.f90:26</a></div></div>
<div class="ttc" id="namespaceorigen__beta_html_a93822825195e3a763bea095e1e22c249"><div class="ttname"><a href="../../d8/dff/namespaceorigen__beta.html#a93822825195e3a763bea095e1e22c249">origen_beta::cosimp</a></div><div class="ttdeci">real(c_double) function cosimp(a, b, aux, eps, isub, emax, z)</div><div class="ttdoc">cosimp is a routine for evaluating definite integrals using an adaptive simpsons algorithm. integral estimated over interval (a,b) of function aux, where eps is the error tolerance and isub is the number of subdivisions within (a,b) used in evaluation. cosimp makes two evaluations using isub and isub+1 and and compares values for agreement within eps. estimates made using est1 = f(a)+4*f(a+b/2)+f(b) and est2 = f(a)+4*f(3a+b/4)+ 2*f(a+b/2)+4*f(a+3b/4)+f(b) </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d3b/origen__beta_8f90_source.html#l00167">origen_beta.f90:167</a></div></div>
<div class="ttc" id="structorigen__beta_1_1origen__beta__class_html"><div class="ttname"><a href="../../db/dc5/structorigen__beta_1_1origen__beta__class.html">origen_beta::origen_beta_class</a></div><div class="ttdoc">Beta source calculation and printout class. Use this class to evaluate beta source and beta spectra b...</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d3b/origen__beta_8f90_source.html#l00093">origen_beta.f90:93</a></div></div>
<div class="ttc" id="structbeta__library_1_1beta__library__class_html"><div class="ttname"><a href="../../de/d08/structbeta__library_1_1beta__library__class.html">beta_library::beta_library_class</a></div><div class="ttdoc">Beta data library class; it reads the beta source data from a file into memory. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d57/beta__library_8f90_source.html#l00031">beta_library.f90:31</a></div></div>
<div class="ttc" id="group___fortran_identifiers_html_ga879cc97cd4248115b716774c58598031"><div class="ttname"><a href="../../db/d88/group___fortran_identifiers.html#ga879cc97cd4248115b716774c58598031">origen_definitions_m::origen_sublib_3fp</a></div><div class="ttdeci">integer(c_int), parameter origen_sublib_3fp</div><div class="ttdoc">ORIGEN sublib integer for fission product. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/de3/_definitions___m_8f90_source.html#l00060">Definitions_M.f90:60</a></div></div>
<div class="ttc" id="namespaceorigen__beta_html_a3bcefa1475ae97eaed731cfa2d04f26b"><div class="ttname"><a href="../../d8/dff/namespaceorigen__beta.html#a3bcefa1475ae97eaed731cfa2d04f26b">origen_beta::aaa</a></div><div class="ttdeci">real(c_double), dimension(100, 3) aaa</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d3b/origen__beta_8f90_source.html#l00020">origen_beta.f90:20</a></div></div>
<div class="ttc" id="namespaceorigen__definitions__m_html"><div class="ttname"><a href="../../d1/d2a/namespaceorigen__definitions__m.html">origen_definitions_m</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/de3/_definitions___m_8f90_source.html#l00001">Definitions_M.f90:1</a></div></div>
<div class="ttc" id="group___fortran_identifiers_html_gaa0f8add03ff5e139c04ae8394bf69574"><div class="ttname"><a href="../../db/d88/group___fortran_identifiers.html#gaa0f8add03ff5e139c04ae8394bf69574">origen_definitions_m::origen_sublib_2ac</a></div><div class="ttdeci">integer(c_int), parameter origen_sublib_2ac</div><div class="ttdoc">ORIGEN sublib integer for actinide. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/de3/_definitions___m_8f90_source.html#l00059">Definitions_M.f90:59</a></div></div>
<div class="ttc" id="namespaceauxiliary_html_a1ee8479ace5bcf8b1b2efa8ce35cc7f1"><div class="ttname"><a href="../../da/da9/namespaceauxiliary.html#a1ee8479ace5bcf8b1b2efa8ce35cc7f1">auxiliary::print_multigroup_time_table</a></div><div class="ttdeci">subroutine print_multigroup_time_table(ngroups, nsteps, bounds, times, time_unit, high_precision, print_total, x)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/ddd/auxiliary_8f90_source.html#l00301">auxiliary.f90:301</a></div></div>
<div class="ttc" id="namespaceorigen__librarywrapper__m_html"><div class="ttname"><a href="../../d6/de2/namespaceorigen__librarywrapper__m.html">origen_librarywrapper_m</a></div><div class="ttdoc">Provides everything you need to do with ORIGEN libraries from Fortran. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d22/_library_wrapper___m_8f90_source.html#l00011">LibraryWrapper_M.f90:11</a></div></div>
<div class="ttc" id="namespaceauxiliary_html_acdb484b80699451123dd41004ee7c38a"><div class="ttname"><a href="../../da/da9/namespaceauxiliary.html#acdb484b80699451123dd41004ee7c38a">auxiliary::flip</a></div><div class="ttdeci">subroutine flip(len, a)</div><div class="ttdoc">Reverse order of a floating-point array. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/ddd/auxiliary_8f90_source.html#l00150">auxiliary.f90:150</a></div></div>
<div class="ttc" id="namespaceauxiliary_html_a6d420a0eea6f06adff6b45a8076da66b"><div class="ttname"><a href="../../da/da9/namespaceauxiliary.html#a6d420a0eea6f06adff6b45a8076da66b">auxiliary::print_break</a></div><div class="ttdeci">subroutine print_break()</div><div class="ttdoc">Print a spacer in the output file. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/ddd/auxiliary_8f90_source.html#l00086">auxiliary.f90:86</a></div></div>
<div class="ttc" id="namespaceorigen__beta_html_a55d06f3b2a62943425ecbf5f2a900cf6"><div class="ttname"><a href="../../d8/dff/namespaceorigen__beta.html#a55d06f3b2a62943425ecbf5f2a900cf6">origen_beta::diste2f</a></div><div class="ttdeci">real(c_double) function diste2f(e, emax, z)</div><div class="ttdoc">energy-weighted distribution second forbidden unique transition </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d3b/origen__beta_8f90_source.html#l00519">origen_beta.f90:519</a></div></div>
<div class="ttc" id="namespaceauxiliary_html"><div class="ttname"><a href="../../da/da9/namespaceauxiliary.html">auxiliary</a></div><div class="ttdoc">Auxiliary subroutines; mostly pretty-printers for the output – it is preferred to use this module fo...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/ddd/auxiliary_8f90_source.html#l00008">auxiliary.f90:8</a></div></div>
<div class="ttc" id="namespaceauxiliary_html_af858d73b4c61da5add697f41cebfa845"><div class="ttname"><a href="../../da/da9/namespaceauxiliary.html#af858d73b4c61da5add697f41cebfa845">auxiliary::output</a></div><div class="ttdeci">subroutine output(s)</div><div class="ttdoc">Print a string into a file. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/ddd/auxiliary_8f90_source.html#l00073">auxiliary.f90:73</a></div></div>
<div class="ttc" id="structorigen__beta_1_1origen__beta__options_html"><div class="ttname"><a href="../../d4/d7f/structorigen__beta_1_1origen__beta__options.html">origen_beta::origen_beta_options</a></div><div class="ttdoc">options for beta printout </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d3b/origen__beta_8f90_source.html#l00063">origen_beta.f90:63</a></div></div>
<div class="ttc" id="group___fortran_constants_html_ga6783933ba842c8f5a92a23b0306028ad"><div class="ttname"><a href="../../dc/d32/group___fortran_constants.html#ga6783933ba842c8f5a92a23b0306028ad">origen_definitions_m::avogadro</a></div><div class="ttdeci">real(c_double), parameter avogadro</div><div class="ttdoc">Avogadro number (same as ScaleUtils/Math/Constants.h) </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/de3/_definitions___m_8f90_source.html#l00029">Definitions_M.f90:29</a></div></div>
<div class="ttc" id="namespaceorigen__beta_html_a87261de321db0d27bd655f64bf49b611"><div class="ttname"><a href="../../d8/dff/namespaceorigen__beta.html#a87261de321db0d27bd655f64bf49b611">origen_beta::iii</a></div><div class="ttdeci">integer iii</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d3b/origen__beta_8f90_source.html#l00021">origen_beta.f90:21</a></div></div>
<div class="ttc" id="namespaceorigen__beta_html"><div class="ttname"><a href="../../d8/dff/namespaceorigen__beta.html">origen_beta</a></div><div class="ttdoc">beta emission calculations </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d3b/origen__beta_8f90_source.html#l00005">origen_beta.f90:5</a></div></div>
<div class="ttc" id="namespaceorigen__beta_html_af3257f602b31173c3e989351557fd836"><div class="ttname"><a href="../../d8/dff/namespaceorigen__beta.html#af3257f602b31173c3e989351557fd836">origen_beta::normalize</a></div><div class="ttdeci">subroutine normalize(v1, v2, a, b, dist2, dist1, eps, isub, emax, z)</div><div class="ttdoc">return normalizing factors v1 and v2 </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d3b/origen__beta_8f90_source.html#l00376">origen_beta.f90:376</a></div></div>
<div class="ttc" id="namespaceconst_html"><div class="ttname"><a href="../../d0/db4/namespaceconst.html">const</a></div><div class="ttdoc">Set of data, physics and string constants. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd9/const_8f90_source.html#l00007">const.f90:7</a></div></div>
<div class="ttc" id="namespaceorigen__beta_html_a334c44acb77421ca86742062c4111d03"><div class="ttname"><a href="../../d8/dff/namespaceorigen__beta.html#a334c44acb77421ca86742062c4111d03">origen_beta::diste1f</a></div><div class="ttdeci">real(c_double) function diste1f(e, emax, z)</div><div class="ttdoc">energy-weighted distribution first forbidden unique transition </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d3b/origen__beta_8f90_source.html#l00507">origen_beta.f90:507</a></div></div>
<div class="ttc" id="namespaceauxiliary_html_a05e00315b65986b3a1952870088359f8"><div class="ttname"><a href="../../da/da9/namespaceauxiliary.html#a05e00315b65986b3a1952870088359f8">auxiliary::print_time_table</a></div><div class="ttdeci">subroutine print_time_table(nsteps, nvars, times, time_unit, high_precision, print_total, vars, x)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/ddd/auxiliary_8f90_source.html#l00478">auxiliary.f90:478</a></div></div>
<div class="ttc" id="group___fortran_identifiers_html_ga4ef7659bef2334fb48756e1fda635855"><div class="ttname"><a href="../../db/d88/group___fortran_identifiers.html#ga4ef7659bef2334fb48756e1fda635855">origen_definitions_m::origen_sublib_1lt</a></div><div class="ttdeci">integer(c_int), parameter origen_sublib_1lt</div><div class="ttdoc">ORIGEN sublib integer for light/activation products. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/de3/_definitions___m_8f90_source.html#l00058">Definitions_M.f90:58</a></div></div>
<div class="ttc" id="namespaceorigen__beta_html_ae44b0ef4c7a5c781d807b4631fc9fcee"><div class="ttname"><a href="../../d8/dff/namespaceorigen__beta.html#ae44b0ef4c7a5c781d807b4631fc9fcee">origen_beta::dist1f</a></div><div class="ttdeci">real(c_double) function dist1f(e, emax, z)</div><div class="ttdoc">beta energy distribution for first forbidden transitions </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d3b/origen__beta_8f90_source.html#l00400">origen_beta.f90:400</a></div></div>
<div class="ttc" id="namespaceorigen__beta_html_a181dab62c2c97a1d7b3436780b1c4203"><div class="ttname"><a href="../../d8/dff/namespaceorigen__beta.html#a181dab62c2c97a1d7b3436780b1c4203">origen_beta::dist3f</a></div><div class="ttdeci">real(c_double) function dist3f(e, emax, z)</div><div class="ttdoc">beta energy distribution of third forbidden transitions </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d3b/origen__beta_8f90_source.html#l00455">origen_beta.f90:455</a></div></div>
<div class="ttc" id="namespaceorigen__beta_html_aff540a8d5e4e7cc2ca5e8acdcdae4cf1"><div class="ttname"><a href="../../d8/dff/namespaceorigen__beta.html#aff540a8d5e4e7cc2ca5e8acdcdae4cf1">origen_beta::distea</a></div><div class="ttdeci">real(c_double) function distea(e, emax, z)</div><div class="ttdoc">energy-weighted distribution for allowed transitions </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d3b/origen__beta_8f90_source.html#l00543">origen_beta.f90:543</a></div></div>
<div class="ttc" id="namespaceorigen__beta_html_a4b07ca97ecc86f1adca36a9d34e0e6e2"><div class="ttname"><a href="../../d8/dff/namespaceorigen__beta.html#a4b07ca97ecc86f1adca36a9d34e0e6e2">origen_beta::dist2f</a></div><div class="ttdeci">real(c_double) function dist2f(e, emax, z)</div><div class="ttdoc">beta energy distribution of second forbidden transitions </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d3b/origen__beta_8f90_source.html#l00427">origen_beta.f90:427</a></div></div>
<div class="ttc" id="namespaceauxiliary_html_a43f424d74b994ecfdd9e76484b86b005"><div class="ttname"><a href="../../da/da9/namespaceauxiliary.html#a43f424d74b994ecfdd9e76484b86b005">auxiliary::table_banner</a></div><div class="ttdeci">subroutine table_banner(table_title, case_tag, case_title, case_number, max_case)</div><div class="ttdoc">Print a header for an output table. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/ddd/auxiliary_8f90_source.html#l00099">auxiliary.f90:99</a></div></div>
<div class="ttc" id="namespacebeta__library_html"><div class="ttname"><a href="../../d9/d6b/namespacebeta__library.html">beta_library</a></div><div class="ttdoc">beta emission source reader </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d57/beta__library_8f90_source.html#l00005">beta_library.f90:5</a></div></div>
<div class="ttc" id="namespaceorigen__beta_html_ac63ea5ddc4a22f03f89f7b4887833d96"><div class="ttname"><a href="../../d8/dff/namespaceorigen__beta.html#ac63ea5ddc4a22f03f89f7b4887833d96">origen_beta::diste3f</a></div><div class="ttdeci">real(c_double) function diste3f(e, emax, z)</div><div class="ttdoc">energy-weighted dist for third forbidden unique transitions </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d3b/origen__beta_8f90_source.html#l00531">origen_beta.f90:531</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
</div>
</div>
</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
