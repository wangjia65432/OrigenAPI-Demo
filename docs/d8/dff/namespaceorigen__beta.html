<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <!-- For Mobile Devices -->
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
        <meta name="generator" content="Doxygen 1.8.10"/>
        <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
        <title>ORIGEN API: origen_beta Module Reference</title>
        <!--<link href="../../tabs.css" rel="stylesheet" type="text/css"/>-->
        <script type="text/javascript" src="../../dynsections.js"></script>
        <link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
        <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
        <link href="../../doxygen.css" rel="stylesheet" type="text/css" />
        <link href="../../customdoxygen.css" rel="stylesheet" type="text/css"/>
        <link href='https://fonts.googleapis.com/css?family=Roboto+Slab' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="../../doxy-boot.js"></script>
    </head>
    <body>
        <nav class="navbar navbar-default" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand">ORIGEN API v0.5.2</a>
                </div>
            </div>
        </nav>
        <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
            <div class="content" id="content">
                <div class="container">
                    <div class="row">
                        <div class="col-sm-12 panel " style="padding-bottom: 15px;">
                            <div style="margin-bottom: 15px;">
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Overview</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../modules.html"><span>Components</span></a></li>
      <li><a href="../../examples.html"><span>Examples</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../d1/d5b/md__c_h_a_n_g_e_l_o_g.html"><span>Changelog</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../namespacemembers.html"><span>Namespace&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">origen_beta Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>beta emission calculations  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/dc5/structorigen__beta_1_1origen__beta__class.html">origen_beta_class</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Beta source calculation and printout class. Use this class to evaluate beta source and beta spectra based on the nuclide concentrations.  <a href="../../db/dc5/structorigen__beta_1_1origen__beta__class.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d7f/structorigen__beta_1_1origen__beta__options.html">origen_beta_options</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">options for beta printout  <a href="../../d4/d7f/structorigen__beta_1_1origen__beta__options.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a93822825195e3a763bea095e1e22c249"><td class="memItemLeft" align="right" valign="top">real(c_double) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dff/namespaceorigen__beta.html#a93822825195e3a763bea095e1e22c249">cosimp</a> (a, b, aux, eps, isub, emax, z)</td></tr>
<tr class="memdesc:a93822825195e3a763bea095e1e22c249"><td class="mdescLeft">&#160;</td><td class="mdescRight">cosimp is a routine for evaluating definite integrals using an adaptive simpsons algorithm. integral estimated over interval (a,b) of function aux, where eps is the error tolerance and isub is the number of subdivisions within (a,b) used in evaluation. cosimp makes two evaluations using isub and isub+1 and and compares values for agreement within eps. estimates made using est1 = f(a)+4*f(a+b/2)+f(b) and est2 = f(a)+4*f(3a+b/4)+ 2*f(a+b/2)+4*f(a+3b/4)+f(b)  <a href="#a93822825195e3a763bea095e1e22c249">More...</a><br /></td></tr>
<tr class="separator:a93822825195e3a763bea095e1e22c249"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3257f602b31173c3e989351557fd836"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dff/namespaceorigen__beta.html#af3257f602b31173c3e989351557fd836">normalize</a> (v1, v2, a, b, dist2, dist1, eps, isub, emax, z)</td></tr>
<tr class="memdesc:af3257f602b31173c3e989351557fd836"><td class="mdescLeft">&#160;</td><td class="mdescRight">return normalizing factors v1 and v2  <a href="#af3257f602b31173c3e989351557fd836">More...</a><br /></td></tr>
<tr class="separator:af3257f602b31173c3e989351557fd836"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae44b0ef4c7a5c781d807b4631fc9fcee"><td class="memItemLeft" align="right" valign="top">real(c_double) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dff/namespaceorigen__beta.html#ae44b0ef4c7a5c781d807b4631fc9fcee">dist1f</a> (e, emax, z)</td></tr>
<tr class="memdesc:ae44b0ef4c7a5c781d807b4631fc9fcee"><td class="mdescLeft">&#160;</td><td class="mdescRight">beta energy distribution for first forbidden transitions  <a href="#ae44b0ef4c7a5c781d807b4631fc9fcee">More...</a><br /></td></tr>
<tr class="separator:ae44b0ef4c7a5c781d807b4631fc9fcee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b07ca97ecc86f1adca36a9d34e0e6e2"><td class="memItemLeft" align="right" valign="top">real(c_double) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dff/namespaceorigen__beta.html#a4b07ca97ecc86f1adca36a9d34e0e6e2">dist2f</a> (e, emax, z)</td></tr>
<tr class="memdesc:a4b07ca97ecc86f1adca36a9d34e0e6e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">beta energy distribution of second forbidden transitions  <a href="#a4b07ca97ecc86f1adca36a9d34e0e6e2">More...</a><br /></td></tr>
<tr class="separator:a4b07ca97ecc86f1adca36a9d34e0e6e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a181dab62c2c97a1d7b3436780b1c4203"><td class="memItemLeft" align="right" valign="top">real(c_double) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dff/namespaceorigen__beta.html#a181dab62c2c97a1d7b3436780b1c4203">dist3f</a> (e, emax, z)</td></tr>
<tr class="memdesc:a181dab62c2c97a1d7b3436780b1c4203"><td class="mdescLeft">&#160;</td><td class="mdescRight">beta energy distribution of third forbidden transitions  <a href="#a181dab62c2c97a1d7b3436780b1c4203">More...</a><br /></td></tr>
<tr class="separator:a181dab62c2c97a1d7b3436780b1c4203"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92d3ac2965d4d50395a72e2006e3059f"><td class="memItemLeft" align="right" valign="top">real(c_double) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dff/namespaceorigen__beta.html#a92d3ac2965d4d50395a72e2006e3059f">dista</a> (e, emax, z)</td></tr>
<tr class="memdesc:a92d3ac2965d4d50395a72e2006e3059f"><td class="mdescLeft">&#160;</td><td class="mdescRight">beta energy distribution for allowed transitions  <a href="#a92d3ac2965d4d50395a72e2006e3059f">More...</a><br /></td></tr>
<tr class="separator:a92d3ac2965d4d50395a72e2006e3059f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a334c44acb77421ca86742062c4111d03"><td class="memItemLeft" align="right" valign="top">real(c_double) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dff/namespaceorigen__beta.html#a334c44acb77421ca86742062c4111d03">diste1f</a> (e, emax, z)</td></tr>
<tr class="memdesc:a334c44acb77421ca86742062c4111d03"><td class="mdescLeft">&#160;</td><td class="mdescRight">energy-weighted distribution first forbidden unique transition  <a href="#a334c44acb77421ca86742062c4111d03">More...</a><br /></td></tr>
<tr class="separator:a334c44acb77421ca86742062c4111d03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55d06f3b2a62943425ecbf5f2a900cf6"><td class="memItemLeft" align="right" valign="top">real(c_double) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dff/namespaceorigen__beta.html#a55d06f3b2a62943425ecbf5f2a900cf6">diste2f</a> (e, emax, z)</td></tr>
<tr class="memdesc:a55d06f3b2a62943425ecbf5f2a900cf6"><td class="mdescLeft">&#160;</td><td class="mdescRight">energy-weighted distribution second forbidden unique transition  <a href="#a55d06f3b2a62943425ecbf5f2a900cf6">More...</a><br /></td></tr>
<tr class="separator:a55d06f3b2a62943425ecbf5f2a900cf6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac63ea5ddc4a22f03f89f7b4887833d96"><td class="memItemLeft" align="right" valign="top">real(c_double) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dff/namespaceorigen__beta.html#ac63ea5ddc4a22f03f89f7b4887833d96">diste3f</a> (e, emax, z)</td></tr>
<tr class="memdesc:ac63ea5ddc4a22f03f89f7b4887833d96"><td class="mdescLeft">&#160;</td><td class="mdescRight">energy-weighted dist for third forbidden unique transitions  <a href="#ac63ea5ddc4a22f03f89f7b4887833d96">More...</a><br /></td></tr>
<tr class="separator:ac63ea5ddc4a22f03f89f7b4887833d96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff540a8d5e4e7cc2ca5e8acdcdae4cf1"><td class="memItemLeft" align="right" valign="top">real(c_double) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dff/namespaceorigen__beta.html#aff540a8d5e4e7cc2ca5e8acdcdae4cf1">distea</a> (e, emax, z)</td></tr>
<tr class="memdesc:aff540a8d5e4e7cc2ca5e8acdcdae4cf1"><td class="mdescLeft">&#160;</td><td class="mdescRight">energy-weighted distribution for allowed transitions  <a href="#aff540a8d5e4e7cc2ca5e8acdcdae4cf1">More...</a><br /></td></tr>
<tr class="separator:aff540a8d5e4e7cc2ca5e8acdcdae4cf1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a3bcefa1475ae97eaed731cfa2d04f26b"><td class="memItemLeft" align="right" valign="top">real(c_double), dimension(100, 3)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dff/namespaceorigen__beta.html#a3bcefa1475ae97eaed731cfa2d04f26b">aaa</a></td></tr>
<tr class="separator:a3bcefa1475ae97eaed731cfa2d04f26b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87261de321db0d27bd655f64bf49b611"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dff/namespaceorigen__beta.html#a87261de321db0d27bd655f64bf49b611">iii</a></td></tr>
<tr class="separator:a87261de321db0d27bd655f64bf49b611"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a625618d5496b6f7d89b6d9eb3b7d3716"><td class="memItemLeft" align="right" valign="top">integer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dff/namespaceorigen__beta.html#a625618d5496b6f7d89b6d9eb3b7d3716">jjj</a></td></tr>
<tr class="separator:a625618d5496b6f7d89b6d9eb3b7d3716"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9715cc7cd30b520e8542a0d1638e4e5"><td class="memItemLeft" align="right" valign="top">character(1024), dimension(256), private&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dff/namespaceorigen__beta.html#ad9715cc7cd30b520e8542a0d1638e4e5">rbuffer</a></td></tr>
<tr class="memdesc:ad9715cc7cd30b520e8542a0d1638e4e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">buffer for Reporter  <a href="#ad9715cc7cd30b520e8542a0d1638e4e5">More...</a><br /></td></tr>
<tr class="separator:ad9715cc7cd30b520e8542a0d1638e4e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>beta emission calculations </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a class="anchor" id="a93822825195e3a763bea095e1e22c249"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(c_double) function origen_beta::cosimp </td>
          <td>(</td>
          <td class="paramtype">real(c_double), intent(in)&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), intent(in)&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), external&#160;</td>
          <td class="paramname"><em>aux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), intent(in)&#160;</td>
          <td class="paramname"><em>eps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>isub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), intent(in)&#160;</td>
          <td class="paramname"><em>emax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>cosimp is a routine for evaluating definite integrals using an adaptive simpsons algorithm. integral estimated over interval (a,b) of function aux, where eps is the error tolerance and isub is the number of subdivisions within (a,b) used in evaluation. cosimp makes two evaluations using isub and isub+1 and and compares values for agreement within eps. estimates made using est1 = f(a)+4*f(a+b/2)+f(b) and est2 = f(a)+4*f(3a+b/4)+ 2*f(a+b/2)+4*f(a+3b/4)+f(b) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>lower integration limit</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">b</td><td>upper integration limit</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">aux</td><td>the integrand f(x, emax, z)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eps</td><td>required relative error tolerance</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">emax</td><td>integrand parameter</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">z</td><td>integrand parameter </td></tr>
  </table>
  </dd>
</dl>

<p>Referenced by <a class="el" href="../../d8/dff/namespaceorigen__beta.html#aff540a8d5e4e7cc2ca5e8acdcdae4cf1">distea()</a>, and <a class="el" href="../../d8/dff/namespaceorigen__beta.html#af3257f602b31173c3e989351557fd836">normalize()</a>.</p>
<div class="fragment"><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="comment">!   D u m m y   A r g u m e n t s</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="comment">!-----------------------------------------------</span><span class="comment"></span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">    !&gt;</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(inout)</span> :: isub<span class="comment"></span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">    !&gt; lower integration limit</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span>  :: a<span class="comment"></span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">    !&gt; upper integration limit</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span>  :: b<span class="comment"></span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">    !&gt; the integrand f(x, emax, z)</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">external</span> :: aux<span class="comment"></span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">    !&gt; required relative error tolerance</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span> :: eps<span class="comment"></span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">    !&gt; integrand parameter</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span> :: emax<span class="comment"></span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">    !&gt; integrand parameter</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: z</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="comment">!   L o c a l   V a r i a b l e s</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordtype">integer</span> , <span class="keywordtype">dimension(20)</span> :: nr</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordtype">integer</span> :: iflag, iflog, iprint, nsub, ll, nd, n, l, m, ne</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span> , <span class="keywordtype">dimension(20)</span> :: p</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span> , <span class="keywordtype">dimension(41)</span> :: y</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span> :: c, x, summ, ak, aj, ajj, s, ss, er, pb, pa1, pb1, subsum, suber</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordtype">integer</span> :: kount, ints</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span> :: err</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="comment">!   isub - specification of the minimum number of divisions</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="comment">!   required returns the number of divisions used ( negative if</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="comment">!   not converged) in each case the number of divisions is 2**isub.</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="comment">!   isub may be entered negative to activate error messages</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="comment">!   err - estimate of the maximum error in the integral</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="comment">!   kount - number of function evaluations</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="comment">!   ints - number of intervals used</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="comment">!   y - real(C_DOUBLE) array stores values of f(x) to avoid recalculation</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="comment">!   s, ss - two estimates for a given subinterval</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="comment">!   summ - cumulative estimate of the integral over the accepted</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="comment">!   subintervals (unscaled)</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="comment">!   pa1, pb1 - limits of interval not satisfying error requirement</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="comment">!   subsum - estimate of integral over the above interval</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="comment">!   if isub is outside the acceptable range, this message is printed</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="comment">!   error in isub, 0 &lt; isub &lt; 18. isub set to 0</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="comment">!   cosimp is evaluated with isub = 0.</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="comment">!   the function cosimp returns the best estimate of the integral.</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="comment">!   the finest subdivision allowed is (b-a)/2**20.  if the error</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="comment">!   requirement is still not satisfied, an error message is printed</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="comment">!   giving the bounds of the unacceptable region, the estimated</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="comment">!   integral over this interval, and an estimate of the error there.</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="comment">!   the value of cosimp returned is still the best estimate over the</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="comment">!   entire range.</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="comment">!   isub is returned negative when convergence is not complete.</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="comment">!   from atomic energy of canada mathematics and computation fortran</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="comment">!   library</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="comment">!      programmed by    d howden  in apex language        jul 1965</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="comment">!      translated by    c j johnson                       nov 1969</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="comment">!      revised    by    valerie jones                     aug 1976</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="comment">!</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      cosimp = 0.0</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      err    = 0.0</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      kount  = 0</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      ints   = 0</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      iflag  = 0</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      iflog  = 0</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      <span class="keywordflow">if</span> (a == b) <span class="keywordflow">return</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      <span class="keywordflow">if</span> (isub &lt; 0) iprint = 1</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      isub = min0(18,max0(0,isub))</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      nsub = isub</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      ll   = isub + 2</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      ints = 0</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      err  = 0.</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      nd   = 20</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      p(1) = 1.</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      <span class="keywordflow">do</span> n = 2, nd</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;         p(n) = p(n-1)*2.0</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      c     = b - a</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      x     = .5</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      l     = 1</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      n     = 2</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      y(1)  = aux(a, emax, z)</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      y(2)  = aux(b, emax, z)</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      y(3)  = aux(c*x + a, emax, z)</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      kount = 3</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      summ  = 0</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      m     = 3</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      nr(n) = 2</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      ak    = .5</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">!  ***next subdivision</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;   50 <span class="keywordflow">continue</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      aj       = c*ak/2.</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      nsub     = max0(nsub,n)</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      ajj      = c*x + a</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      y(n+n)   = aux(ajj - aj, emax, z)</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      y(n+n+1) = aux(ajj + aj, emax, z)</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      kount    = kount + 2</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">!  *** if minimum number of subdivisions (isub) has not been met,</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">!      the interval is divided in half</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      <span class="keywordflow">if</span> (n &lt; ll) <span class="keywordflow">go to</span> 125</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">!  *** two estimates of the interval are made and the error estimate is</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">!      compared to the required error tolerance</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      s  = y(l) + 4.0*y(m) + y(nr(n))</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      ss = s + 2.*(2.*(y(n+n)+y(n+n+1))-y(m))</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      er = (aj*(ss - 2.*s))/45.</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      <span class="keywordflow">if</span> (abs(er) &gt; aj*eps*(abs(ss) + abs(s))/4.5) <span class="keywordflow">go to</span> 100</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      <span class="keywordflow">if</span> (iflag == 1) <span class="keywordflow">go to</span> 200</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">!      if the error requirement is met the interval is accepted.  the</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">!      estimates are added on to their respective sums, the count of</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">!      the number of intervals used (ints) is increased by one, and</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">!      the next interval on the right is considered</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;   75 <span class="keywordflow">continue</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      summ = summ + ss*ak</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      err  = err + er</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      ints = ints + 1</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      <span class="keywordflow">if</span> (nr(n) &lt;= 2) <span class="keywordflow">go to</span> 225</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      l     = nr(n)</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      ne    = l/2</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      ak    = 1./p(ne+2)</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      x     = x + ak + 1./p(n)</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      n     = ne + 2</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      nr(n) = nr(n-1)</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      m     = 2*ne + 3</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      <span class="keywordflow">go to</span> 50</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">!  ***error recognition criterion</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  100 <span class="keywordflow">continue</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      <span class="keywordflow">if</span> (n &gt;= nd) <span class="keywordflow">go to</span> 150</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">!      if the error requirement is not satisfied and the maximum</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">!      number of subdivisions has not been reached, the interval is</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">!      divided in half.</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  125 <span class="keywordflow">continue</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      nr(n+1) = m</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      m       = 2*n</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      ak      = 1./p(n+1)</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      x       = x - ak</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      n       = n + 1</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      <span class="keywordflow">go to</span> 50</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">!      if the maximum number of subdivisions has been reached without</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">!      the error requirement being met, the bounds of the offending</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">!      interval are stored with the estimate of the integral and the</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">!      error flag is set.</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  150 <span class="keywordflow">continue</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      pb = ajj + 2.*aj</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      <span class="keywordflow">if</span> (iflag == 1) <span class="keywordflow">go to</span> 175</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      pa1    = ajj - 2.0*aj</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      pb1    = pb</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      subsum = ss*ak</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      suber  = er</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      iflag  = 1</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      iflog  = 1</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      <span class="keywordflow">go to</span> 75</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">!      consecutive intervals where the error requirement is not met are</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">!      combined for readability.</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  175 <span class="keywordflow">continue</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      pb1    = pb</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      subsum = subsum + ss*ak</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      suber  = suber + er</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      <span class="keywordflow">go to</span> 75</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">!      when the non-convergent interval has been completely determined</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">!      a message is printed giving the bounds, integral, and error.</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  200 <span class="keywordflow">continue</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      iflog = 1</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      iflag = 0</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      <span class="keywordflow">if</span> (iprint == 0) <span class="keywordflow">go to</span> 75</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      soutline(1,fmt=2000) pa1, pb1, subsum*(c/6.0), abs(suber)</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      <span class="keywordflow">go to</span> 75</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">!      when the entire interval has been considered the answer is</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">!      returned along with an estimate of the error.</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  225 <span class="keywordflow">continue</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      cosimp = summ*(c/6.)</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      err    = abs(err)</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      isub   = nsub</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      <span class="keywordflow">if</span> (iflog == 1) isub = -nsub</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      <span class="keywordflow">return</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      2000 <span class="keyword">format</span>(/<span class="stringliteral">&#39; *** cosimp - trouble integrating over (&#39;</span>,e13.5,<span class="stringliteral">&#39;,&#39;</span>,e13.5,<span class="stringliteral">&#39;)&#39;</span>,/,&amp;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;         <span class="stringliteral">&#39; estimated integral and error are &#39;</span>,e23.14,<span class="stringliteral">&#39; and &#39;</span>,e13.5,<span class="stringliteral">&#39; ***&#39;</span>/)</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af3257f602b31173c3e989351557fd836"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine origen_beta::normalize </td>
          <td>(</td>
          <td class="paramtype">real(c_double), intent(out)&#160;</td>
          <td class="paramname"><em>v1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), intent(out)&#160;</td>
          <td class="paramname"><em>v2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), intent(in)&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), intent(in)&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), external&#160;</td>
          <td class="paramname"><em>dist2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), external&#160;</td>
          <td class="paramname"><em>dist1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), intent(in)&#160;</td>
          <td class="paramname"><em>eps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>isub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), intent(in)&#160;</td>
          <td class="paramname"><em>emax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>return normalizing factors v1 and v2 </p>

<p>References <a class="el" href="../../d8/dff/namespaceorigen__beta.html#a93822825195e3a763bea095e1e22c249">cosimp()</a>.</p>

<p>Referenced by <a class="el" href="../../d8/dff/namespaceorigen__beta.html#aff540a8d5e4e7cc2ca5e8acdcdae4cf1">distea()</a>, and <a class="el" href="../../d8/dd1/class_origen_1_1_comp_manager.html#a5d66b72b740db7cc024d397ae7f25cec">CompManager::finalizeComp()</a>.</p>
<div class="fragment"><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="comment">!   D u m m y   A r g u m e n t s</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(inout)</span>  :: isub</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(out)</span> :: v1</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(out)</span> :: v2</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span>  :: a</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span>  :: b</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span>  :: eps</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span> :: emax</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: z</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="comment">!   E x t e r n a l   F u n c t i o n s</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">external</span> :: dist2</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">external</span> :: dist1</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    v1 = cosimp(a,b,dist1,eps,isub,emax,z)</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    v2 = cosimp(a,b,dist2,eps,isub,emax,z)</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae44b0ef4c7a5c781d807b4631fc9fcee"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(c_double) function origen_beta::dist1f </td>
          <td>(</td>
          <td class="paramtype">real(c_double), intent(in)&#160;</td>
          <td class="paramname"><em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), intent(in)&#160;</td>
          <td class="paramname"><em>emax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>beta energy distribution for first forbidden transitions </p>

<p>References <a class="el" href="../../d8/dff/namespaceorigen__beta.html#a3bcefa1475ae97eaed731cfa2d04f26b">aaa</a>.</p>

<p>Referenced by <a class="el" href="../../d8/dff/namespaceorigen__beta.html#a334c44acb77421ca86742062c4111d03">diste1f()</a>, and <a class="el" href="../../d8/dff/namespaceorigen__beta.html#aff540a8d5e4e7cc2ca5e8acdcdae4cf1">distea()</a>.</p>
<div class="fragment"><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="comment">!   D u m m y   A r g u m e n t s</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span> :: e</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span> :: emax</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: z</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="comment">!   L o c a l   V a r i a b l e s</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span> :: emc, a0, a1, a2, w, wmax</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    emc = 0.511</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    a0  = aaa(z+1,1)</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    a1  = aaa(z+1,2)</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    a2  = aaa(z+1,3)</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="keywordflow">if</span> (e &lt;= emax) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;       w      = e/emc + 1.0</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;       wmax   = emax/emc + 1.0</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;       dist1f = ((w*w - 1) + (wmax - w)**2) * (a0 + a1*e + a2*e*e) * (emax - e)**2</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;       dist1f = 0.0</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="keywordflow">    endif</span></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4b07ca97ecc86f1adca36a9d34e0e6e2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(c_double) function origen_beta::dist2f </td>
          <td>(</td>
          <td class="paramtype">real(c_double), intent(in)&#160;</td>
          <td class="paramname"><em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), intent(in)&#160;</td>
          <td class="paramname"><em>emax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>beta energy distribution of second forbidden transitions </p>

<p>References <a class="el" href="../../d8/dff/namespaceorigen__beta.html#a3bcefa1475ae97eaed731cfa2d04f26b">aaa</a>.</p>

<p>Referenced by <a class="el" href="../../d8/dff/namespaceorigen__beta.html#a55d06f3b2a62943425ecbf5f2a900cf6">diste2f()</a>, and <a class="el" href="../../d8/dff/namespaceorigen__beta.html#aff540a8d5e4e7cc2ca5e8acdcdae4cf1">distea()</a>.</p>
<div class="fragment"><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="comment">!   D u m m y   A r g u m e n t s</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span> :: e</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span> :: emax</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: z</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="comment">!   L o c a l   V a r i a b l e s</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span> :: emc, a0, a1, a2, w, wmax</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    emc = 0.511</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    a0  = aaa(z+1,1)</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    a1  = aaa(z+1,2)</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    a2  = aaa(z+1,3)</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keywordflow">if</span> (e &lt;= emax) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;       w      = e/emc + 1.0</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;       wmax   = emax/emc + 1.0</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;       dist2f = ((w*w - 1)**2 + (wmax - w)**4 + 10./3.*(w*w - 1)*(wmax - w)**&amp;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;          2)*(a0 + a1*e + a2*e*e)*(emax - e)**2</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;       dist2f = 0.0</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="keywordflow">    endif</span></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a181dab62c2c97a1d7b3436780b1c4203"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(c_double) function origen_beta::dist3f </td>
          <td>(</td>
          <td class="paramtype">real(c_double), intent(in)&#160;</td>
          <td class="paramname"><em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), intent(in)&#160;</td>
          <td class="paramname"><em>emax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>beta energy distribution of third forbidden transitions </p>

<p>References <a class="el" href="../../d8/dff/namespaceorigen__beta.html#a3bcefa1475ae97eaed731cfa2d04f26b">aaa</a>.</p>

<p>Referenced by <a class="el" href="../../d8/dff/namespaceorigen__beta.html#ac63ea5ddc4a22f03f89f7b4887833d96">diste3f()</a>, and <a class="el" href="../../d8/dff/namespaceorigen__beta.html#aff540a8d5e4e7cc2ca5e8acdcdae4cf1">distea()</a>.</p>
<div class="fragment"><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="comment">!   D u m m y   A r g u m e n t s</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span> :: e</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span> :: emax</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: z</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="comment">!   L o c a l   V a r i a b l e s</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span> :: emc, a0, a1, a2, w, wmax</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    emc = 0.511</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    a0  = aaa(z+1,1)</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    a1  = aaa(z+1,2)</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    a2  = aaa(z+1,3)</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="keywordflow">if</span> (e &lt;= emax) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;       w      = e/emc + 1.0</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;       wmax   = emax/emc + 1.0</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;       dist3f = ((w*w - 1)**3 + (wmax - w)**6 + 7.0*(w*w - 1)*(wmax - w)**2*(&amp;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;          (w*w - 1) + (wmax - w)**2))*(a0 + a1*e + a2*e*e)*(emax - e)**2</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;       dist3f = 0.0</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="keywordflow">    endif</span></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a92d3ac2965d4d50395a72e2006e3059f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(c_double) function origen_beta::dista </td>
          <td>(</td>
          <td class="paramtype">real(c_double), intent(in)&#160;</td>
          <td class="paramname"><em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), intent(in)&#160;</td>
          <td class="paramname"><em>emax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>beta energy distribution for allowed transitions </p>

<p>References <a class="el" href="../../d8/dff/namespaceorigen__beta.html#a3bcefa1475ae97eaed731cfa2d04f26b">aaa</a>.</p>

<p>Referenced by <a class="el" href="../../d8/dff/namespaceorigen__beta.html#aff540a8d5e4e7cc2ca5e8acdcdae4cf1">distea()</a>.</p>
<div class="fragment"><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="comment">!   D u m m y   A r g u m e n t s</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span> :: e</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span> :: emax</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: z</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="comment">!   L o c a l   V a r i a b l e s</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span> :: a0, a1, a2</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    a0 = aaa(z+1,1)</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    a1 = aaa(z+1,2)</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    a2 = aaa(z+1,3)</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="keywordflow">if</span> (e &lt;= emax) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;       dista = (a0 + a1*e + a2*e*e)*(emax - e)**2</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;       dista = 0.0</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="keywordflow">    endif</span></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a334c44acb77421ca86742062c4111d03"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(c_double) function origen_beta::diste1f </td>
          <td>(</td>
          <td class="paramtype">real(c_double), intent(in)&#160;</td>
          <td class="paramname"><em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), intent(in)&#160;</td>
          <td class="paramname"><em>emax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>energy-weighted distribution first forbidden unique transition </p>

<p>References <a class="el" href="../../d8/dff/namespaceorigen__beta.html#ae44b0ef4c7a5c781d807b4631fc9fcee">dist1f()</a>.</p>

<p>Referenced by <a class="el" href="../../d8/dff/namespaceorigen__beta.html#aff540a8d5e4e7cc2ca5e8acdcdae4cf1">distea()</a>.</p>
<div class="fragment"><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="comment">!   D u m m y   A r g u m e n t s</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span>  :: e</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span> :: emax</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: z</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    diste1f = e * dist1f(e, emax, z)</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a55d06f3b2a62943425ecbf5f2a900cf6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(c_double) function origen_beta::diste2f </td>
          <td>(</td>
          <td class="paramtype">real(c_double), intent(in)&#160;</td>
          <td class="paramname"><em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), intent(in)&#160;</td>
          <td class="paramname"><em>emax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>energy-weighted distribution second forbidden unique transition </p>

<p>References <a class="el" href="../../d8/dff/namespaceorigen__beta.html#a4b07ca97ecc86f1adca36a9d34e0e6e2">dist2f()</a>.</p>

<p>Referenced by <a class="el" href="../../d8/dff/namespaceorigen__beta.html#aff540a8d5e4e7cc2ca5e8acdcdae4cf1">distea()</a>.</p>
<div class="fragment"><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="comment">!   D u m m y   A r g u m e n t s</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span>  :: e</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span> :: emax</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: z</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    diste2f = e * dist2f(e, emax, z)</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac63ea5ddc4a22f03f89f7b4887833d96"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(c_double) function origen_beta::diste3f </td>
          <td>(</td>
          <td class="paramtype">real(c_double), intent(in)&#160;</td>
          <td class="paramname"><em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), intent(in)&#160;</td>
          <td class="paramname"><em>emax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>energy-weighted dist for third forbidden unique transitions </p>

<p>References <a class="el" href="../../d8/dff/namespaceorigen__beta.html#a181dab62c2c97a1d7b3436780b1c4203">dist3f()</a>.</p>

<p>Referenced by <a class="el" href="../../d8/dff/namespaceorigen__beta.html#aff540a8d5e4e7cc2ca5e8acdcdae4cf1">distea()</a>.</p>
<div class="fragment"><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="comment">!   D u m m y   A r g u m e n t s</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span>  :: e</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span> :: emax</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: z</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    diste3f = e * dist3f(e, emax, z)</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aff540a8d5e4e7cc2ca5e8acdcdae4cf1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(c_double) function origen_beta::distea </td>
          <td>(</td>
          <td class="paramtype">real(c_double), intent(in)&#160;</td>
          <td class="paramname"><em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), intent(in)&#160;</td>
          <td class="paramname"><em>emax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>energy-weighted distribution for allowed transitions </p>

<p>References <a class="el" href="../../dc/d32/group___fortran_constants.html#ga6783933ba842c8f5a92a23b0306028ad">origen_definitions_m::avogadro</a>, <a class="el" href="../../d8/dff/namespaceorigen__beta.html#a93822825195e3a763bea095e1e22c249">cosimp()</a>, <a class="el" href="../../d8/dff/namespaceorigen__beta.html#ae44b0ef4c7a5c781d807b4631fc9fcee">dist1f()</a>, <a class="el" href="../../d8/dff/namespaceorigen__beta.html#a4b07ca97ecc86f1adca36a9d34e0e6e2">dist2f()</a>, <a class="el" href="../../d8/dff/namespaceorigen__beta.html#a181dab62c2c97a1d7b3436780b1c4203">dist3f()</a>, <a class="el" href="../../d8/dff/namespaceorigen__beta.html#a92d3ac2965d4d50395a72e2006e3059f">dista()</a>, <a class="el" href="../../d8/dff/namespaceorigen__beta.html#a334c44acb77421ca86742062c4111d03">diste1f()</a>, <a class="el" href="../../d8/dff/namespaceorigen__beta.html#a55d06f3b2a62943425ecbf5f2a900cf6">diste2f()</a>, <a class="el" href="../../d8/dff/namespaceorigen__beta.html#ac63ea5ddc4a22f03f89f7b4887833d96">diste3f()</a>, <a class="el" href="../../dc/d32/group___fortran_constants.html#ga595a7a58c908ec8f7c6778d9d5b532aa">origen_definitions_m::err</a>, <a class="el" href="../../da/da9/namespaceauxiliary.html#acdb484b80699451123dd41004ee7c38a">auxiliary::flip()</a>, <a class="el" href="../../d8/dff/namespaceorigen__beta.html#af3257f602b31173c3e989351557fd836">normalize()</a>, <a class="el" href="../../da/da9/namespaceauxiliary.html#a8402482545d523f5b69b63e63c068644">auxiliary::nuclide_compact()</a>, <a class="el" href="../../db/d88/group___fortran_identifiers.html#ga4ef7659bef2334fb48756e1fda635855">origen_definitions_m::origen_sublib_1lt</a>, <a class="el" href="../../db/d88/group___fortran_identifiers.html#gaa0f8add03ff5e139c04ae8394bf69574">origen_definitions_m::origen_sublib_2ac</a>, <a class="el" href="../../db/d88/group___fortran_identifiers.html#ga879cc97cd4248115b716774c58598031">origen_definitions_m::origen_sublib_3fp</a>, <a class="el" href="../../da/da9/namespaceauxiliary.html#af858d73b4c61da5add697f41cebfa845">auxiliary::output()</a>, <a class="el" href="../../da/da9/namespaceauxiliary.html#a6d420a0eea6f06adff6b45a8076da66b">auxiliary::print_break()</a>, <a class="el" href="../../da/da9/namespaceauxiliary.html#a87f00206fa389873214d5885a0eface7">auxiliary::print_hrule()</a>, <a class="el" href="../../da/da9/namespaceauxiliary.html#a1ee8479ace5bcf8b1b2efa8ce35cc7f1">auxiliary::print_multigroup_time_table()</a>, <a class="el" href="../../da/da9/namespaceauxiliary.html#a05e00315b65986b3a1952870088359f8">auxiliary::print_time_table()</a>, <a class="el" href="../../da/da9/namespaceauxiliary.html#a43f424d74b994ecfdd9e76484b86b005">auxiliary::table_banner()</a>, and <a class="el" href="../../da/da9/namespaceauxiliary.html#a0b8c2210d041dace1661f87ae2b80695">auxiliary::table_tail()</a>.</p>
<div class="fragment"><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="comment">!   D u m m y   A r g u m e n t s</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <span class="comment">!-----------------------------------------------</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span>  :: e</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">intent(in)</span> :: emax</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: z</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    distea = e * dista(e, emax, z)</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a3bcefa1475ae97eaed731cfa2d04f26b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(c_double), dimension(100,3) aaa</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Referenced by <a class="el" href="../../d8/dff/namespaceorigen__beta.html#ae44b0ef4c7a5c781d807b4631fc9fcee">dist1f()</a>, <a class="el" href="../../d8/dff/namespaceorigen__beta.html#a4b07ca97ecc86f1adca36a9d34e0e6e2">dist2f()</a>, <a class="el" href="../../d8/dff/namespaceorigen__beta.html#a181dab62c2c97a1d7b3436780b1c4203">dist3f()</a>, and <a class="el" href="../../d8/dff/namespaceorigen__beta.html#a92d3ac2965d4d50395a72e2006e3059f">dista()</a>.</p>
<div class="fragment"><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  <span class="keywordtype">real(C_DOUBLE)</span>, <span class="keywordtype">dimension(100,3)</span> :: aaa</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a87261de321db0d27bd655f64bf49b611"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer iii</td>
        </tr>
      </table>
</div><div class="memdoc">
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="../../da/d1c/_manager_2libld_2tests_2tst_transition_system_adapter__ampx_n_8cpp-example.html#a47">Manager/libld/tests/tstTransitionSystemAdapter_AmpxN.cpp</a>.</dd>
</dl>
<p>Referenced by <a class="el" href="../../dc/de5/tst_transition_system_adapter___ampx_n_8cpp.html#ac57738573ae591a493be925255e59aa8">TEST_F()</a>.</p>
<div class="fragment"><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <span class="keywordtype">integer</span> :: iii, jjj</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a625618d5496b6f7d89b6d9eb3b7d3716"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer jjj</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ad9715cc7cd30b520e8542a0d1638e4e5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">character(1024), dimension(256), private rbuffer</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>buffer for Reporter </p>
<div class="fragment"><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="keywordtype">character(1024)</span>, <span class="keywordtype">private</span> :: <a class="code" href="../../dd/d83/namespacekernel__matrex.html#a1b7102b09b40287832d227060573b20f">rbuffer</a>(256)</div>
<div class="ttc" id="namespacekernel__matrex_html_a1b7102b09b40287832d227060573b20f"><div class="ttname"><a href="../../dd/d83/namespacekernel__matrex.html#a1b7102b09b40287832d227060573b20f">kernel_matrex::rbuffer</a></div><div class="ttdeci">character(256), dimension(256), private rbuffer</div><div class="ttdoc">buffer for writing stuff </div><div class="ttdef"><b>Definition:</b> kernel_matrex.f90:39</div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
</div>
</div>
</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
