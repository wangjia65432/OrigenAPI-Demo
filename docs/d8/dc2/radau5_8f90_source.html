<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <!-- For Mobile Devices -->
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
        <meta name="generator" content="Doxygen 1.8.10"/>
        <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
        <title>ORIGEN API: Solver/radau5/src/radau5.f90 Source File</title>
        <!--<link href="../../tabs.css" rel="stylesheet" type="text/css"/>-->
        <script type="text/javascript" src="../../dynsections.js"></script>
        <link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
        <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
        <link href="../../doxygen.css" rel="stylesheet" type="text/css" />
        <link href="../../customdoxygen.css" rel="stylesheet" type="text/css"/>
        <link href='https://fonts.googleapis.com/css?family=Roboto+Slab' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="../../doxy-boot.js"></script>
    </head>
    <body>
        <nav class="navbar navbar-default" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand">ORIGEN API v0.5.2</a>
                </div>
            </div>
        </nav>
        <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
            <div class="content" id="content">
                <div class="container">
                    <div class="row">
                        <div class="col-sm-12 panel " style="padding-bottom: 15px;">
                            <div style="margin-bottom: 15px;">
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Overview</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../modules.html"><span>Components</span></a></li>
      <li><a href="../../examples.html"><span>Examples</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../d1/d5b/md__c_h_a_n_g_e_l_o_g.html"><span>Changelog</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_bbfb5cf133b5ee2ba5207ad49be3b96c.html">Solver</a></li><li class="navelem"><a class="el" href="../../dir_9cb0d6689b70b3096e771bdae1552368.html">radau5</a></li><li class="navelem"><a class="el" href="../../dir_95c76f502a4ee41797d9c6957171ecfa.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">radau5.f90</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d8/dc2/radau5_8f90.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">!&gt; \file radau5.f90</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">!! The 3rd party RADAU5 solver -- the main module.</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">! ==========================================================================================</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">! =                                                                                         =</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">! =                 EXTERNAL SOLVER PACKAGE - not a native part of ORIGEN                   =</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">! =                                                                                         =</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">! ==========================================================================================</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">! ----------------------------------------------------------            </span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">!     NUMERICAL SOLUTION OF A STIFF (OR DIFFERENTIAL ALGEBRAIC)         </span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">!     SYSTEM OF FIRST 0RDER ORDINARY DIFFERENTIAL EQUATIONS             </span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">!                     M*Y&#39;=F(X,Y).                                      </span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">!     THE SYSTEM CAN BE (LINEARLY) IMPLICIT (MASS-MATRIX M .NE. I)      </span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">!     OR EXPLICIT (M=I).                                                </span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">!     THE METHOD USED IS AN IMPLICIT RUNGE-KUTTA METHOD (RADAU IIA)     </span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">!     OF ORDER 5 WITH STEP SIZE CONTROL AND CONTINUOUS OUTPUT.          </span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">!     CF. SECTION IV.8                                                  </span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">!     AUTHORS: E. HAIRER AND G. WANNER                                  </span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">!              UNIVERSITE DE GENEVE, DEPT. DE MATHEMATIQUES             </span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">!              CH-1211 GENEVE 24, SWITZERLAND                           </span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">!              E-MAIL:  Ernst.Hairer@math.unige.ch                      </span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">!                       Gerhard.Wanner@math.unige.ch                    </span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">!     THIS CODE IS PART OF THE BOOK:                                    </span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">!         E. HAIRER AND G. WANNER, SOLVING ORDINARY DIFFERENTIAL        </span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">!         EQUATIONS II. STIFF AND DIFFERENTIAL-ALGEBRAIC PROBLEMS.      </span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">!         SPRINGER SERIES IN COMPUTATIONAL MATHEMATICS 14,              </span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">!         SPRINGER-VERLAG 1991, SECOND EDITION 1996.                    </span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">!     VERSION OF JULY 9, 1996                                           </span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">!     (latest small correction: January 18, 2002)                       </span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">!     INPUT PARAMETERS                                                  </span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">!     ----------------                                                  </span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">!     N           DIMENSION OF THE SYSTEM                               </span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">!     FCN         NAME (EXTERNAL) OF SUBROUTINE COMPUTING THE           </span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">!                 VALUE OF F(X,Y):                                      </span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">!                    SUBROUTINE FCN(N,X,Y,F,RPAR,IPAR)                  </span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">!                    DOUBLE PRECISION X,Y(N),F(N)                       </span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">!                    F(1)=...   ETC.                                    </span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">!                 RPAR, IPAR (SEE BELOW)                                </span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">!     X           INITIAL X-VALUE                                       </span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">!     Y(N)        INITIAL VALUES FOR Y                                  </span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">!     XEND        FINAL X-VALUE (XEND-X MAY BE POSITIVE OR NEGATIVE)    </span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">!     H           INITIAL STEP SIZE GUESS;                              </span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">!                 FOR STIFF EQUATIONS WITH INITIAL TRANSIENT,           </span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">!                 H=1.D0/(NORM OF F&#39;), USUALLY 1.D-3 OR 1.D-5, IS GOOD. </span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">!                 THIS CHOICE IS NOT VERY IMPORTANT, THE STEP SIZE IS   </span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">!                 QUICKLY ADAPTED. (IF H=0.D0, THE CODE PUTS H=1.D-6).  </span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">!     RTOL,ATOL   RELATIVE AND ABSOLUTE ERROR TOLERANCES. THEY          </span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">!                 CAN BE BOTH SCALARS OR ELSE BOTH VECTORS OF LENGTH N. </span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">!     ITOL        SWITCH FOR RTOL AND ATOL:                             </span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">!                   ITOL=0: BOTH RTOL AND ATOL ARE SCALARS.             </span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">!                     THE CODE KEEPS, ROUGHLY, THE LOCAL ERROR OF       </span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">!                     Y(I) BELOW RTOL*ABS(Y(I))+ATOL                    </span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">!                   ITOL=1: BOTH RTOL AND ATOL ARE VECTORS.             </span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">!                     THE CODE KEEPS THE LOCAL ERROR OF Y(I) BELOW      </span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">!                     RTOL(I)*ABS(Y(I))+ATOL(I).                        </span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">!     JAC         NAME (EXTERNAL) OF THE SUBROUTINE WHICH COMPUTES      </span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">!                 THE PARTIAL DERIVATIVES OF F(X,Y) WITH RESPECT TO Y   </span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">!                 (THIS ROUTINE IS ONLY CALLED IF IJAC=1; SUPPLY        </span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">!                 A DUMMY SUBROUTINE IN THE CASE IJAC=0).               </span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">!                 FOR IJAC=1, THIS SUBROUTINE MUST HAVE THE FORM        </span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">!                    SUBROUTINE JAC(N,X,Y,DFY,LDFY,RPAR,IPAR)           </span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">!                    DOUBLE PRECISION X,Y(N),DFY(LDFY,N)                </span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">!                    DFY(1,1)= ...                                      </span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">!                 LDFY, THE COLUMN-LENGTH OF THE ARRAY, IS              </span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">!                 FURNISHED BY THE CALLING PROGRAM.                     </span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">!                 IF (MLJAC.EQ.N) THE JACOBIAN IS SUPPOSED TO           </span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">!                    BE FULL AND THE PARTIAL DERIVATIVES ARE            </span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">!                    STORED IN DFY AS                                   </span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">!                       DFY(I,J) = PARTIAL F(I) / PARTIAL Y(J)          </span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">!                 ELSE, THE JACOBIAN IS TAKEN AS BANDED AND             </span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">!                    THE PARTIAL DERIVATIVES ARE STORED                 </span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">!                    DIAGONAL-WISE AS                                   </span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">!                       DFY(I-J+MUJAC+1,J) = PARTIAL F(I) / PARTIAL Y(J)</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">!     IJAC        SWITCH FOR THE COMPUTATION OF THE JACOBIAN:           </span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">!                    IJAC=0: JACOBIAN IS COMPUTED INTERNALLY BY FINITE  </span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">!                       DIFFERENCES, SUBROUTINE &quot;JAC&quot; IS NEVER CALLED.  </span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">!                    IJAC=1: JACOBIAN IS SUPPLIED BY SUBROUTINE JAC.    </span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">!     MLJAC       SWITCH FOR THE BANDED STRUCTURE OF THE JACOBIAN:      </span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">!                    MLJAC=N: JACOBIAN IS A FULL MATRIX. THE LINEAR     </span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">!                       ALGEBRA IS DONE BY FULL-MATRIX GAUSS-ELIMINATION</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">!                    0&lt;=MLJAC&lt;N: MLJAC IS THE LOWER BANDWITH OF JACOBIAN</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">!                       MATRIX (&gt;= NUMBER OF NON-ZERO DIAGONALS BELOW   </span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">!                       THE MAIN DIAGONAL).                             </span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">!     MUJAC       UPPER BANDWITH OF JACOBIAN  MATRIX (&gt;= NUMBER OF NON- </span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">!                 ZERO DIAGONALS ABOVE THE MAIN DIAGONAL).              </span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">!                 NEED NOT BE DEFINED IF MLJAC=N.                       </span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">!     ----   MAS,IMAS,MLMAS, AND MUMAS HAVE ANALOG MEANINGS      -----  </span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">!     ----   FOR THE &quot;MASS MATRIX&quot; (THE MATRIX &quot;M&quot; OF SECTION IV.8): -  </span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">!     MAS         NAME (EXTERNAL) OF SUBROUTINE COMPUTING THE MASS-     </span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">!                 MATRIX M.                                             </span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">!                 IF IMAS=0, THIS MATRIX IS ASSUMED TO BE THE IDENTITY  </span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">!                 MATRIX AND NEEDS NOT TO BE DEFINED;                   </span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">!                 SUPPLY A DUMMY SUBROUTINE IN THIS CASE.               </span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">!                 IF IMAS=1, THE SUBROUTINE MAS IS OF THE FORM          </span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">!                    SUBROUTINE MAS(N,AM,LMAS,RPAR,IPAR)                </span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">!                    DOUBLE PRECISION AM(LMAS,N)                        </span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">!                    AM(1,1)= ....                                      </span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">!                    IF (MLMAS.EQ.N) THE MASS-MATRIX IS STORED          </span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">!                    AS FULL MATRIX LIKE                                </span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">!                         AM(I,J) = M(I,J)                              </span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">!                    ELSE, THE MATRIX IS TAKEN AS BANDED AND STORED     </span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">!                    DIAGONAL-WISE AS                                   </span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">!                         AM(I-J+MUMAS+1,J) = M(I,J).                   </span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">!     IMAS       GIVES INFORMATION ON THE MASS-MATRIX:                  </span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">!                    IMAS=0: M IS SUPPOSED TO BE THE IDENTITY           </span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">!                       MATRIX, MAS IS NEVER CALLED.                    </span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">!                    IMAS=1: MASS-MATRIX  IS SUPPLIED.                  </span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">!     MLMAS       SWITCH FOR THE BANDED STRUCTURE OF THE MASS-MATRIX:   </span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">!                    MLMAS=N: THE FULL MATRIX CASE. THE LINEAR          </span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">!                       ALGEBRA IS DONE BY FULL-MATRIX GAUSS-ELIMINATION</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">!                    0&lt;=MLMAS&lt;N: MLMAS IS THE LOWER BANDWITH OF THE     </span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">!                       MATRIX (&gt;= NUMBER OF NON-ZERO DIAGONALS BELOW   </span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">!                       THE MAIN DIAGONAL).                             </span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">!                 MLMAS IS SUPPOSED TO BE .LE. MLJAC.                   </span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">!     MUMAS       UPPER BANDWITH OF MASS-MATRIX (&gt;= NUMBER OF NON-      </span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">!                 ZERO DIAGONALS ABOVE THE MAIN DIAGONAL).              </span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">!                 NEED NOT BE DEFINED IF MLMAS=N.                       </span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">!                 MUMAS IS SUPPOSED TO BE .LE. MUJAC.                   </span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">!     SOLOUT      NAME (EXTERNAL) OF SUBROUTINE PROVIDING THE           </span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">!                 NUMERICAL SOLUTION DURING INTEGRATION.                </span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">!                 IF IOUT=1, IT IS CALLED AFTER EVERY SUCCESSFUL STEP.  </span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">!                 SUPPLY A DUMMY SUBROUTINE IF IOUT=0.                  </span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">!                 IT MUST HAVE THE FORM                                 </span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">!                    SUBROUTINE SOLOUT (NR,XOLD,X,Y,CONT,LRC,N,         </span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">!                                       RPAR,IPAR,IRTRN)                </span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">!                    DOUBLE PRECISION X,Y(N),CONT(LRC)                  </span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">!                    ....                                               </span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">!                 SOLOUT FURNISHES THE SOLUTION &quot;Y&quot; AT THE NR-TH        </span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">!                    GRID-POINT &quot;X&quot; (THEREBY THE INITIAL VALUE IS       </span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">!                    THE FIRST GRID-POINT).                             </span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">!                 &quot;XOLD&quot; IS THE PRECEEDING GRID-POINT.                  </span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">!                 &quot;IRTRN&quot; SERVES TO INTERRUPT THE INTEGRATION. IF IRTRN </span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">!                    IS SET &lt;0, RADAU5 RETURNS TO THE CALLING PROGRAM.  </span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">!          -----  CONTINUOUS OUTPUT: -----                              </span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">!                 DURING CALLS TO &quot;SOLOUT&quot;, A CONTINUOUS SOLUTION       </span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">!                 FOR THE INTERVAL [XOLD,X] IS AVAILABLE THROUGH        </span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">!                 THE FUNCTION                                          </span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">!                        &gt;&gt;&gt;   CONTR5(I,S,CONT,LRC)   &lt;&lt;&lt;               </span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">!                 WHICH PROVIDES AN APPROXIMATION TO THE I-TH           </span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">!                 COMPONENT OF THE SOLUTION AT THE POINT S. THE VALUE   </span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">!                 S SHOULD LIE IN THE INTERVAL [XOLD,X].                </span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">!                 DO NOT CHANGE THE ENTRIES OF CONT(LRC), IF THE        </span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">!                 DENSE OUTPUT FUNCTION IS USED.                        </span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">!     IOUT        SWITCH FOR CALLING THE SUBROUTINE SOLOUT:             </span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">!                    IOUT=0: SUBROUTINE IS NEVER CALLED                 </span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">!                    IOUT=1: SUBROUTINE IS AVAILABLE FOR OUTPUT.        </span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">!     WORK        ARRAY OF WORKING SPACE OF LENGTH &quot;LWORK&quot;.             </span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">!                 WORK(1), WORK(2),.., WORK(20) SERVE AS PARAMETERS     </span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">!                 FOR THE CODE. FOR STANDARD USE OF THE CODE            </span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">!                 WORK(1),..,WORK(20) MUST BE SET TO ZERO BEFORE        </span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">!                 CALLING. SEE BELOW FOR A MORE SOPHISTICATED USE.      </span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">!                 WORK(21),..,WORK(LWORK) SERVE AS WORKING SPACE        </span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">!                 FOR ALL VECTORS AND MATRICES.                         </span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">!                 &quot;LWORK&quot; MUST BE AT LEAST                              </span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">!                             N*(LJAC+LMAS+3*LE+12)+20                  </span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">!                 WHERE                                                 </span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">!                    LJAC=N              IF MLJAC=N (FULL JACOBIAN)     </span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">!                    LJAC=MLJAC+MUJAC+1  IF MLJAC&lt;N (BANDED JAC.)       </span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">!                 AND                                                   </span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">!                    LMAS=0              IF IMAS=0                      </span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">!                    LMAS=N              IF IMAS=1 AND MLMAS=N (FULL)   </span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">!                    LMAS=MLMAS+MUMAS+1  IF MLMAS&lt;N (BANDED MASS-M.)    </span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">!                 AND                                                   </span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">!                    LE=N               IF MLJAC=N (FULL JACOBIAN)      </span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">!                    LE=2*MLJAC+MUJAC+1 IF MLJAC&lt;N (BANDED JAC.)        </span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">!                 IN THE USUAL CASE WHERE THE JACOBIAN IS FULL AND THE  </span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">!                 MASS-MATRIX IS THE INDENTITY (IMAS=0), THE MINIMUM    </span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">!                 STORAGE REQUIREMENT IS                                </span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">!                             LWORK = 4*N*N+12*N+20.                    </span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">!                 IF IWORK(9)=M1&gt;0 THEN &quot;LWORK&quot; MUST BE AT LEAST        </span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">!                          N*(LJAC+12)+(N-M1)*(LMAS+3*LE)+20            </span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">!                 WHERE IN THE DEFINITIONS OF LJAC, LMAS AND LE THE     </span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">!                 NUMBER N CAN BE REPLACED BY N-M1.                     </span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">!     LWORK       DECLARED LENGTH OF ARRAY &quot;WORK&quot;.                      </span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">!     IWORK       INTEGER WORKING SPACE OF LENGTH &quot;LIWORK&quot;.             </span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">!                 IWORK(1),IWORK(2),...,IWORK(20) SERVE AS PARAMETERS   </span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">!                 FOR THE CODE. FOR STANDARD USE, SET IWORK(1),..,      </span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">!                 IWORK(20) TO ZERO BEFORE CALLING.                     </span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">!                 IWORK(21),...,IWORK(LIWORK) SERVE AS WORKING AREA.    </span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">!                 &quot;LIWORK&quot; MUST BE AT LEAST 3*N+20.                     </span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">!     LIWORK      DECLARED LENGTH OF ARRAY &quot;IWORK&quot;.                     </span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="../../d8/dc2/radau5_8f90.html#aa8a78d3b03091d4b3bb487a267e170f6">radau5</a>(N,FCN,X,Y,XEND,H,                               &amp;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;     &amp;                  rtol,atol,itol,                                 &amp;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;     &amp;                  jac ,ijac,mljac,mujac,                          &amp;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;     &amp;                  mas ,imas,mlmas,mumas,                          &amp;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;     &amp;                  solout,iout,                                    &amp;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;     &amp;                  work,lwork,iwork,liwork,rpar,ipar,idid)         </div>
<div class="line"><a name="l00217"></a><span class="lineno"><a class="line" href="../../d8/dc2/radau5_8f90.html#aa8a78d3b03091d4b3bb487a267e170f6">  217</a></span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">!     RPAR, IPAR  REAL AND INTEGER PARAMETERS (OR PARAMETER ARRAYS) WHIC</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">!                 CAN BE USED FOR COMMUNICATION BETWEEN YOUR CALLING    </span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">!                 PROGRAM AND THE FCN, JAC, MAS, SOLOUT SUBROUTINES.    </span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">! ----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">!     SOPHISTICATED SETTING OF PARAMETERS                               </span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">!     -----------------------------------                               </span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">!              SEVERAL PARAMETERS OF THE CODE ARE TUNED TO MAKE IT WORK </span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">!              WELL. THEY MAY BE DEFINED BY SETTING WORK(1),...         </span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">!              AS WELL AS IWORK(1),... DIFFERENT FROM ZERO.             </span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">!              FOR ZERO INPUT, THE CODE CHOOSES DEFAULT VALUES:         </span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">!    IWORK(1)  IF IWORK(1).NE.0, THE CODE TRANSFORMS THE JACOBIAN       </span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">!              MATRIX TO HESSENBERG FORM. THIS IS PARTICULARLY          </span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">!              ADVANTAGEOUS FOR LARGE SYSTEMS WITH FULL JACOBIAN.       </span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">!              IT DOES NOT WORK FOR BANDED JACOBIAN (MLJAC&lt;N)           </span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">!              AND NOT FOR IMPLICIT SYSTEMS (IMAS=1).                   </span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">!    IWORK(2)  THIS IS THE MAXIMAL NUMBER OF ALLOWED STEPS.             </span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">!              THE DEFAULT VALUE (FOR IWORK(2)=0) IS 100000.            </span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">!    IWORK(3)  THE MAXIMUM NUMBER OF NEWTON ITERATIONS FOR THE          </span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">!              SOLUTION OF THE IMPLICIT SYSTEM IN EACH STEP.            </span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">!              THE DEFAULT VALUE (FOR IWORK(3)=0) IS 7.                 </span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">!    IWORK(4)  IF IWORK(4).EQ.0 THE EXTRAPOLATED COLLOCATION SOLUTION   </span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">!              IS TAKEN AS STARTING VALUE FOR NEWTON&#39;S METHOD.          </span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">!              IF IWORK(4).NE.0 ZERO STARTING VALUES ARE USED.          </span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">!              THE LATTER IS RECOMMENDED IF NEWTON&#39;S METHOD HAS         </span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">!              DIFFICULTIES WITH CONVERGENCE (THIS IS THE CASE WHEN     </span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">!              NSTEP IS LARGER THAN NACCPT + NREJCT; SEE OUTPUT PARAM.).</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">!              DEFAULT IS IWORK(4)=0.                                   </span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">!       THE FOLLOWING 3 PARAMETERS ARE IMPORTANT FOR                    </span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">!       DIFFERENTIAL-ALGEBRAIC SYSTEMS OF INDEX &gt; 1.                    </span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">!       THE FUNCTION-SUBROUTINE SHOULD BE WRITTEN SUCH THAT             </span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">!       THE INDEX 1,2,3 VARIABLES APPEAR IN THIS ORDER.                 </span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">!       IN ESTIMATING THE ERROR THE INDEX 2 VARIABLES ARE               </span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">!       MULTIPLIED BY H, THE INDEX 3 VARIABLES BY H**2.                 </span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">!    IWORK(5)  DIMENSION OF THE INDEX 1 VARIABLES (MUST BE &gt; 0). FOR    </span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">!              ODE&#39;S THIS EQUALS THE DIMENSION OF THE SYSTEM.           </span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">!              DEFAULT IWORK(5)=N.                                      </span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">!    IWORK(6)  DIMENSION OF THE INDEX 2 VARIABLES. DEFAULT IWORK(6)=0.  </span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">!    IWORK(7)  DIMENSION OF THE INDEX 3 VARIABLES. DEFAULT IWORK(7)=0.  </span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">!    IWORK(8)  SWITCH FOR STEP SIZE STRATEGY                            </span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">!              IF IWORK(8).EQ.1  MOD. PREDICTIVE CONTROLLER (GUSTAFSSON)</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">!              IF IWORK(8).EQ.2  CLASSICAL STEP SIZE CONTROL            </span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">!              THE DEFAULT VALUE (FOR IWORK(8)=0) IS IWORK(8)=1.        </span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">!              THE CHOICE IWORK(8).EQ.1 SEEMS TO PRODUCE SAFER RESULTS; </span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">!              FOR SIMPLE PROBLEMS, THE CHOICE IWORK(8).EQ.2 PRODUCES   </span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">!              OFTEN SLIGHTLY FASTER RUNS                               </span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">!       IF THE DIFFERENTIAL SYSTEM HAS THE SPECIAL STRUCTURE THAT       </span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">!            Y(I)&#39; = Y(I+M2)   FOR  I=1,...,M1,                         </span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">!       WITH M1 A MULTIPLE OF M2, A SUBSTANTIAL GAIN IN COMPUTERTIME    </span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">!       CAN BE ACHIEVED BY SETTING THE PARAMETERS IWORK(9) AND IWORK(10)</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">!       E.G., FOR SECOND ORDER SYSTEMS P&#39;=V, V&#39;=G(P,V), WHERE P AND V AR</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">!       VECTORS OF DIMENSION N/2, ONE HAS TO PUT M1=M2=N/2.             </span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">!       FOR M1&gt;0 SOME OF THE INPUT PARAMETERS HAVE DIFFERENT MEANINGS:  </span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">!       - JAC: ONLY THE ELEMENTS OF THE NON-TRIVIAL PART OF THE         </span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">!              JACOBIAN HAVE TO BE STORED                               </span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">!              IF (MLJAC.EQ.N-M1) THE JACOBIAN IS SUPPOSED TO BE FULL   </span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">!                 DFY(I,J) = PARTIAL F(I+M1) / PARTIAL Y(J)             </span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">!                FOR I=1,N-M1 AND J=1,N.                                </span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">!              ELSE, THE JACOBIAN IS BANDED ( M1 = M2 * MM )            </span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">!                 DFY(I-J+MUJAC+1,J+K*M2) = PARTIAL F(I+M1) / PARTIAL Y(</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">!                FOR I=1,MLJAC+MUJAC+1 AND J=1,M2 AND K=0,MM.           </span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">!       - MLJAC: MLJAC=N-M1: IF THE NON-TRIVIAL PART OF THE JACOBIAN IS </span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">!                0&lt;=MLJAC&lt;N-M1: IF THE (MM+1) SUBMATRICES (FOR K=0,MM)  </span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">!                     PARTIAL F(I+M1) / PARTIAL Y(J+K*M2),  I,J=1,M2    </span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">!                    ARE BANDED, MLJAC IS THE MAXIMAL LOWER BANDWIDTH   </span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">!                    OF THESE MM+1 SUBMATRICES                          </span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">!       - MUJAC: MAXIMAL UPPER BANDWIDTH OF THESE MM+1 SUBMATRICES      </span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">!                NEED NOT BE DEFINED IF MLJAC=N-M1                      </span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">!       - MAS: IF IMAS=0 THIS MATRIX IS ASSUMED TO BE THE IDENTITY AND  </span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">!              NEED NOT BE DEFINED. SUPPLY A DUMMY SUBROUTINE IN THIS CA</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">!              IT IS ASSUMED THAT ONLY THE ELEMENTS OF RIGHT LOWER BLOCK</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">!              DIMENSION N-M1 DIFFER FROM THAT OF THE IDENTITY MATRIX.  </span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">!              IF (MLMAS.EQ.N-M1) THIS SUBMATRIX IS SUPPOSED TO BE FULL </span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">!                 AM(I,J) = M(I+M1,J+M1)     FOR I=1,N-M1 AND J=1,N-M1. </span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">!              ELSE, THE MASS MATRIX IS BANDED                          </span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">!                 AM(I-J+MUMAS+1,J) = M(I+M1,J+M1)                      </span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">!       - MLMAS: MLMAS=N-M1: IF THE NON-TRIVIAL PART OF M IS FULL       </span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">!                0&lt;=MLMAS&lt;N-M1: LOWER BANDWIDTH OF THE MASS MATRIX      </span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">!       - MUMAS: UPPER BANDWIDTH OF THE MASS MATRIX                     </span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">!                NEED NOT BE DEFINED IF MLMAS=N-M1                      </span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">!    IWORK(9)  THE VALUE OF M1.  DEFAULT M1=0.                          </span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">!    IWORK(10) THE VALUE OF M2.  DEFAULT M2=M1.                         </span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">! ----------                                                            </span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">!    WORK(1)   UROUND, THE ROUNDING UNIT, DEFAULT 1.D-16.               </span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">!    WORK(2)   THE SAFETY FACTOR IN STEP SIZE PREDICTION,               </span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">!              DEFAULT 0.9D0.                                           </span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">!    WORK(3)   DECIDES WHETHER THE JACOBIAN SHOULD BE RECOMPUTED;       </span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">!              INCREASE WORK(3), TO 0.1 SAY, WHEN JACOBIAN EVALUATIONS  </span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">!              ARE COSTLY. FOR SMALL SYSTEMS WORK(3) SHOULD BE SMALLER  </span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">!              (0.001D0, SAY). NEGATIV WORK(3) FORCES THE CODE TO       </span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">!              COMPUTE THE JACOBIAN AFTER EVERY ACCEPTED STEP.          </span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">!              DEFAULT 0.001D0.                                         </span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">!    WORK(4)   STOPPING CRITERION FOR NEWTON&#39;S METHOD, USUALLY CHOSEN &lt;1</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">!              SMALLER VALUES OF WORK(4) MAKE THE CODE SLOWER, BUT SAFER</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">!              DEFAULT MIN(0.03D0,RTOL(1)**0.5D0)                       </span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">!    WORK(5) AND WORK(6) : IF WORK(5) &lt; HNEW/HOLD &lt; WORK(6), THEN THE   </span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">!              STEP SIZE IS NOT CHANGED. THIS SAVES, TOGETHER WITH A    </span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">!              LARGE WORK(3), LU-DECOMPOSITIONS AND COMPUTING TIME FOR  </span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">!              LARGE SYSTEMS. FOR SMALL SYSTEMS ONE MAY HAVE            </span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">!              WORK(5)=1.D0, WORK(6)=1.2D0, FOR LARGE FULL SYSTEMS      </span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">!              WORK(5)=0.99D0, WORK(6)=2.D0 MIGHT BE GOOD.              </span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">!              DEFAULTS WORK(5)=1.D0, WORK(6)=1.2D0 .                   </span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">!    WORK(7)   MAXIMAL STEP SIZE, DEFAULT XEND-X.                       </span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">!    WORK(8), WORK(9)   PARAMETERS FOR STEP SIZE SELECTION              </span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">!              THE NEW STEP SIZE IS CHOSEN SUBJECT TO THE RESTRICTION   </span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">!                 WORK(8) &lt;= HNEW/HOLD &lt;= WORK(9)                       </span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">!              DEFAULT VALUES: WORK(8)=0.2D0, WORK(9)=8.D0              </span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">!     OUTPUT PARAMETERS                                                 </span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">!     -----------------                                                 </span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">!     X           X-VALUE FOR WHICH THE SOLUTION HAS BEEN COMPUTED      </span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">!                 (AFTER SUCCESSFUL RETURN X=XEND).                     </span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">!     Y(N)        NUMERICAL SOLUTION AT X                               </span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">!     H           PREDICTED STEP SIZE OF THE LAST ACCEPTED STEP         </span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">!     IDID        REPORTS ON SUCCESSFULNESS UPON RETURN:                </span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">!                   IDID= 1  COMPUTATION SUCCESSFUL,                    </span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">!                   IDID= 2  COMPUT. SUCCESSFUL (INTERRUPTED BY SOLOUT) </span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">!                   IDID=-1  INPUT IS NOT CONSISTENT,                   </span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">!                   IDID=-2  LARGER NMAX IS NEEDED,                     </span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">!                   IDID=-3  STEP SIZE BECOMES TOO SMALL,               </span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">!                   IDID=-4  MATRIX IS REPEATEDLY SINGULAR.             </span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">!   IWORK(14)  NFCN    NUMBER OF FUNCTION EVALUATIONS (THOSE FOR NUMERIC</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">!                      EVALUATION OF THE JACOBIAN ARE NOT COUNTED)      </span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">!   IWORK(15)  NJAC    NUMBER OF JACOBIAN EVALUATIONS (EITHER ANALYTICAL</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">!                      OR NUMERICALLY)                                  </span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">!   IWORK(16)  NSTEP   NUMBER OF COMPUTED STEPS                         </span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">!   IWORK(17)  NACCPT  NUMBER OF ACCEPTED STEPS                         </span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">!   IWORK(18)  NREJCT  NUMBER OF REJECTED STEPS (DUE TO ERROR TEST),    </span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">!                      (STEP REJECTIONS IN THE FIRST STEP ARE NOT COUNTE</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">!   IWORK(19)  NDEC    NUMBER OF LU-DECOMPOSITIONS OF BOTH MATRICES     </span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">!   IWORK(20)  NSOL    NUMBER OF FORWARD-BACKWARD SUBSTITUTIONS, OF BOTH</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">!                      SYSTEMS; THE NSTEP FORWARD-BACKWARD SUBSTITUTIONS</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">!                      NEEDED FOR STEP SIZE SELECTION, ARE NOT COUNTED  </span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">!-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">! *** *** *** *** *** *** *** *** *** *** *** *** ***                   </span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">!          DECLARATIONS                                                 </span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">! *** *** *** *** *** *** *** *** *** *** *** *** ***                   </span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      <span class="keywordtype">IMPLICIT</span> <span class="keywordtype">DOUBLE PRECISION</span> (a-h,o-z) </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      dimension y(n),atol(*),rtol(*),work(lwork),iwork(liwork) </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      dimension rpar(*),ipar(*) </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      <span class="keywordtype">LOGICAL</span> IMPLCT,JBAND,ARRET,STARTN,PRED </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      <span class="keywordtype">EXTERNAL</span> fcn,jac,mas,solout </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">! *** *** *** *** *** *** ***                                           </span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">!        SETTING THE PARAMETERS                                         </span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">! *** *** *** *** *** *** ***                                           </span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;       nfcn=0 </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;       njac=0 </div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;       nstep=0 </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;       naccpt=0 </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;       nrejct=0 </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;       ndec=0 </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;       nsol=0 </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;       arret=.false. </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">! -------- UROUND   SMALLEST NUMBER SATISFYING 1.0D0+UROUND&gt;1.0D0       </span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      <span class="keywordflow">IF</span> (work(1).EQ.0.0d0) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;         uround=1.0d-16 </div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      <span class="keywordflow">ELSE</span> </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;         uround=work(1) </div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;         <span class="keywordflow">IF</span> (uround.LE.1.0d-19.OR.uround.GE.1.0d0) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            <span class="keyword">WRITE</span>(6,*)<span class="stringliteral">&#39; COEFFICIENTS HAVE 20 DIGITS, UROUND=&#39;</span>,work(1) </div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            arret=.true. </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="keywordflow">         END IF</span> </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="keywordflow">      END IF</span> </div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment">! -------- CHECK AND CHANGE THE TOLERANCES                              </span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      expm=2.0d0/3.0d0 </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      <span class="keywordflow">IF</span> (itol.EQ.0) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;          <span class="keywordflow">IF</span> (atol(1).LE.0.d0.OR.rtol(1).LE.10.d0*uround) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;              <span class="keyword">WRITE</span> (6,*) <span class="stringliteral">&#39; TOLERANCES ARE TOO SMALL&#39;</span> </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;              arret=.true. </div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;          <span class="keywordflow">ELSE</span> </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;              quot=atol(1)/rtol(1) </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;              rtol(1)=0.1d0*rtol(1)**expm </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;              atol(1)=rtol(1)*quot </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="keywordflow">          END IF</span> </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      <span class="keywordflow">ELSE</span> </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;          <span class="keywordflow">DO</span> i=1,n </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;          <span class="keywordflow">IF</span> (atol(i).LE.0.d0.OR.rtol(i).LE.10.d0*uround) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;              <span class="keyword">WRITE</span> (6,*) <span class="stringliteral">&#39; TOLERANCES(&#39;</span>,i,<span class="stringliteral">&#39;) ARE TOO SMALL&#39;</span> </div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;              arret=.true. </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;          <span class="keywordflow">ELSE</span> </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;              quot=atol(i)/rtol(i) </div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;              rtol(i)=0.1d0*rtol(i)**expm </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;              atol(i)=rtol(i)*quot </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="keywordflow">          END IF</span> </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="keywordflow">          END DO</span> </div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="keywordflow">      END IF</span> </div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">! -------- NMAX , THE MAXIMAL NUMBER OF STEPS -----                     </span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;      <span class="keywordflow">IF</span> (iwork(2).EQ.0) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;         nmax=100000 </div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;      <span class="keywordflow">ELSE</span> </div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;         nmax=iwork(2) </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;         <span class="keywordflow">IF</span> (nmax.LE.0) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;            <span class="keyword">WRITE</span>(6,*)<span class="stringliteral">&#39; WRONG INPUT IWORK(2)=&#39;</span>,iwork(2) </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;            arret=.true. </div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="keywordflow">         END IF</span> </div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="keywordflow">      END IF</span> </div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">! -------- NIT    MAXIMAL NUMBER OF NEWTON ITERATIONS                   </span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      <span class="keywordflow">IF</span> (iwork(3).EQ.0) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;         nit=7 </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      <span class="keywordflow">ELSE</span> </div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;         nit=iwork(3) </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;         <span class="keywordflow">IF</span> (nit.LE.0) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;            <span class="keyword">WRITE</span>(6,*)<span class="stringliteral">&#39; CURIOUS INPUT IWORK(3)=&#39;</span>,iwork(3) </div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;            arret=.true. </div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="keywordflow">         END IF</span> </div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="keywordflow">      END IF</span> </div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">! -------- STARTN  SWITCH FOR STARTING VALUES OF NEWTON ITERATIONS      </span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      <span class="keywordflow">IF</span>(iwork(4).EQ.0)<span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;         startn=.false. </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      <span class="keywordflow">ELSE</span> </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;         startn=.true. </div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="keywordflow">      END IF</span> </div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment">! -------- PARAMETER FOR DIFFERENTIAL-ALGEBRAIC COMPONENTS              </span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;      nind1=iwork(5) </div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      nind2=iwork(6) </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;      nind3=iwork(7) </div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      <span class="keywordflow">IF</span> (nind1.EQ.0) nind1=n </div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      <span class="keywordflow">IF</span> (nind1+nind2+nind3.NE.n) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;       <span class="keyword">WRITE</span>(6,*)<span class="stringliteral">&#39; CURIOUS INPUT FOR IWORK(5,6,7)=&#39;</span>,nind1,nind2,nind3 </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;       arret=.true. </div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="keywordflow">      END IF</span> </div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">! -------- PRED   STEP SIZE CONTROL                                     </span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;      <span class="keywordflow">IF</span>(iwork(8).LE.1)<span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;         pred=.true. </div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;      <span class="keywordflow">ELSE</span> </div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;         pred=.false. </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="keywordflow">      END IF</span> </div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment">! -------- PARAMETER FOR SECOND ORDER EQUATIONS                         </span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;      m1=iwork(9) </div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;      m2=iwork(10) </div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      nm1=n-m1 </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      <span class="keywordflow">IF</span> (m1.EQ.0) m2=n </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      <span class="keywordflow">IF</span> (m2.EQ.0) m2=m1 </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      <span class="keywordflow">IF</span> (m1.LT.0.OR.m2.LT.0.OR.m1+m2.GT.n) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;       <span class="keyword">WRITE</span>(6,*)<span class="stringliteral">&#39; CURIOUS INPUT FOR IWORK(9,10)=&#39;</span>,m1,m2 </div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;       arret=.true. </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="keywordflow">      END IF</span> </div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment">! --------- SAFE     SAFETY FACTOR IN STEP SIZE PREDICTION              </span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      <span class="keywordflow">IF</span> (work(2).EQ.0.0d0) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;         safe=0.9d0 </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      <span class="keywordflow">ELSE</span> </div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;         safe=work(2) </div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;         <span class="keywordflow">IF</span> (safe.LE.0.001d0.OR.safe.GE.1.0d0) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;            <span class="keyword">WRITE</span>(6,*)<span class="stringliteral">&#39; CURIOUS INPUT FOR WORK(2)=&#39;</span>,work(2) </div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;            arret=.true. </div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="keywordflow">         END IF</span> </div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="keywordflow">      END IF</span> </div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="comment">! ------ THET     DECIDES WHETHER THE JACOBIAN SHOULD BE RECOMPUTED;    </span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;      <span class="keywordflow">IF</span> (work(3).EQ.0.d0) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;         thet=0.001d0 </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      <span class="keywordflow">ELSE</span> </div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;         thet=work(3) </div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;         <span class="keywordflow">IF</span> (thet.GE.1.0d0) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;            <span class="keyword">WRITE</span>(6,*)<span class="stringliteral">&#39; CURIOUS INPUT FOR WORK(3)=&#39;</span>,work(3) </div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;            arret=.true. </div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="keywordflow">         END IF</span> </div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="keywordflow">      END IF</span> </div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">! --- FNEWT   STOPPING CRITERION FOR NEWTON&#39;S METHOD, USUALLY CHOSEN &lt;1.</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;      tolst=rtol(1) </div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      <span class="keywordflow">IF</span> (work(4).EQ.0.d0) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;         fnewt=max(10*uround/tolst,min(0.03d0,tolst**0.5d0)) </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      <span class="keywordflow">ELSE</span> </div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;         fnewt=work(4) </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;         <span class="keywordflow">IF</span> (fnewt.LE.uround/tolst) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;            <span class="keyword">WRITE</span>(6,*)<span class="stringliteral">&#39; CURIOUS INPUT FOR WORK(4)=&#39;</span>,work(4) </div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;            arret=.true. </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="keywordflow">         END IF</span> </div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="keywordflow">      END IF</span> </div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">! --- QUOT1 AND QUOT2: IF QUOT1 &lt; HNEW/HOLD &lt; QUOT2, STEP SIZE = CONST. </span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      <span class="keywordflow">IF</span> (work(5).EQ.0.d0) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;         quot1=1.d0 </div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;      <span class="keywordflow">ELSE</span> </div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;         quot1=work(5) </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="keywordflow">      END IF</span> </div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;      <span class="keywordflow">IF</span> (work(6).EQ.0.d0) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;         quot2=1.2d0 </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;      <span class="keywordflow">ELSE</span> </div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;         quot2=work(6) </div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="keywordflow">      END IF</span> </div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;      <span class="keywordflow">IF</span> (quot1.GT.1.0d0.OR.quot2.LT.1.0d0) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;         <span class="keyword">WRITE</span>(6,*)<span class="stringliteral">&#39; CURIOUS INPUT FOR WORK(5,6)=&#39;</span>,quot1,quot2 </div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;         arret=.true. </div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="keywordflow">      END IF</span> </div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment">! -------- MAXIMAL STEP SIZE                                            </span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;      <span class="keywordflow">IF</span> (work(7).EQ.0.d0) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;         hmax=xend-x </div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      <span class="keywordflow">ELSE</span> </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;         hmax=work(7) </div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="keywordflow">      END IF</span> </div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment">! -------  FACL,FACR     PARAMETERS FOR STEP SIZE SELECTION             </span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;      <span class="keywordflow">IF</span>(work(8).EQ.0.d0)<span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;         facl=5.d0 </div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;      <span class="keywordflow">ELSE</span> </div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;         facl=1.d0/work(8) </div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="keywordflow">      END IF</span> </div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;      <span class="keywordflow">IF</span>(work(9).EQ.0.d0)<span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;         facr=1.d0/8.0d0 </div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;      <span class="keywordflow">ELSE</span> </div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;         facr=1.d0/work(9) </div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="keywordflow">      END IF</span> </div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;      <span class="keywordflow">IF</span> (facl.LT.1.0d0.OR.facr.GT.1.0d0) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;            <span class="keyword">WRITE</span>(6,*)<span class="stringliteral">&#39; CURIOUS INPUT WORK(8,9)=&#39;</span>,work(8),work(9) </div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;            arret=.true. </div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="keywordflow">         END IF</span> </div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">! *** *** *** *** *** *** *** *** *** *** *** *** ***                   </span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment">!         COMPUTATION OF ARRAY ENTRIES                                  </span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment">! *** *** *** *** *** *** *** *** *** *** *** *** ***                   </span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">! ---- IMPLICIT, BANDED OR NOT ?                                        </span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;      implct=imas.NE.0 </div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;      jband=mljac.LT.nm1 </div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment">! -------- COMPUTATION OF THE ROW-DIMENSIONS OF THE 2-ARRAYS ---        </span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment">! -- JACOBIAN  AND  MATRICES E1, E2                                     </span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;      <span class="keywordflow">IF</span> (jband) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;         ldjac=mljac+mujac+1 </div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;         lde1=mljac+ldjac </div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;      <span class="keywordflow">ELSE</span> </div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;         mljac=nm1 </div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;         mujac=nm1 </div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;         ldjac=nm1 </div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;         lde1=nm1 </div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="keywordflow">      END IF</span> </div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="comment">! -- MASS MATRIX                                                        </span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;      <span class="keywordflow">IF</span> (implct) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;          <span class="keywordflow">IF</span> (mlmas.NE.nm1) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;              ldmas=mlmas+mumas+1 </div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;              <span class="keywordflow">IF</span> (jband) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                 ijob=4 </div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;              <span class="keywordflow">ELSE</span> </div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                 ijob=3 </div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="keywordflow">              END IF</span> </div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;          <span class="keywordflow">ELSE</span> </div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;              mumas=nm1 </div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;              ldmas=nm1 </div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;              ijob=5 </div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="keywordflow">          END IF</span> </div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment">! ------ BANDWITH OF &quot;MAS&quot; NOT SMALLER THAN BANDWITH OF &quot;JAC&quot;           </span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;          <span class="keywordflow">IF</span> (mlmas.GT.mljac.OR.mumas.GT.mujac) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;             <span class="keyword">WRITE</span> (6,*) <span class="stringliteral">&#39;BANDWITH OF &quot;MAS&quot; NOT SMALLER THAN BANDWITH OF&amp;</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="stringliteral"></span><span class="stringliteral">     &amp; &quot;JAC&quot;&#39;</span>                                                           </div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;            arret=.true. </div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="keywordflow">          END IF</span> </div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;      <span class="keywordflow">ELSE</span> </div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;          ldmas=0 </div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;          <span class="keywordflow">IF</span> (jband) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;             ijob=2 </div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;          <span class="keywordflow">ELSE</span> </div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;             ijob=1 </div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;             <span class="keywordflow">IF</span> (n.GT.2.AND.iwork(1).NE.0) ijob=7 </div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="keywordflow">          END IF</span> </div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="keywordflow">      END IF</span> </div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;      ldmas2=max(1,ldmas) </div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment">! ------ HESSENBERG OPTION ONLY FOR EXPLICIT EQU. WITH FULL JACOBIAN    </span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;      <span class="keywordflow">IF</span> ((implct.OR.jband).AND.ijob.EQ.7) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;         <span class="keyword">WRITE</span>(6,*)<span class="stringliteral">&#39; HESSENBERG OPTION ONLY FOR EXPLICIT EQUATIONS WITH &amp;</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="stringliteral"></span><span class="stringliteral">     &amp;FULL JACOBIAN&#39;</span>                                                    </div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;         arret=.true. </div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="keywordflow">      END IF</span> </div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="comment">! ------- PREPARE THE ENTRY-POINTS FOR THE ARRAYS IN WORK -----         </span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;      iez1=21 </div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;      iez2=iez1+n </div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;      iez3=iez2+n </div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;      iey0=iez3+n </div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;      iescal=iey0+n </div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;      ief1=iescal+n </div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;      ief2=ief1+n </div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;      ief3=ief2+n </div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;      iecon=ief3+n </div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;      iejac=iecon+4*n </div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;      iemas=iejac+n*ldjac </div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;      iee1=iemas+nm1*ldmas </div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;      iee2r=iee1+nm1*lde1 </div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      iee2i=iee2r+nm1*lde1 </div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="comment">! ------ TOTAL STORAGE REQUIREMENT -----------                          </span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;      istore=iee2i+nm1*lde1-1 </div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;      <span class="keywordflow">IF</span>(istore.GT.lwork)<span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;         <span class="keyword">WRITE</span>(6,*)<span class="stringliteral">&#39; INSUFFICIENT STORAGE FOR WORK, MIN. LWORK=&#39;</span>,istore </div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;         arret=.true. </div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="keywordflow">      END IF</span> </div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="comment">! ------- ENTRY POINTS FOR INTEGER WORKSPACE -----                      </span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;      ieip1=21 </div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;      ieip2=ieip1+nm1 </div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;      ieiph=ieip2+nm1 </div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="comment">! --------- TOTAL REQUIREMENT ---------------                           </span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      istore=ieiph+nm1-1 </div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      <span class="keywordflow">IF</span> (istore.GT.liwork) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;         <span class="keyword">WRITE</span>(6,*)<span class="stringliteral">&#39; INSUFF. STORAGE FOR IWORK, MIN. LIWORK=&#39;</span>,istore </div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;         arret=.true. </div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="keywordflow">      END IF</span> </div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="comment">! ------ WHEN A FAIL HAS OCCURED, WE RETURN WITH IDID=-1                </span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;      <span class="keywordflow">IF</span> (arret) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;         idid=-1 </div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;         <span class="keywordflow">RETURN</span> </div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="keywordflow">      END IF</span> </div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="comment">! -------- CALL TO CORE INTEGRATOR ------------                         </span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;      <span class="keyword">CALL </span><a class="code" href="../../d8/dc2/radau5_8f90.html#a4e842ca41466ee359167746c1b1b7e50">radcor</a>(n,fcn,x,y,xend,hmax,h,rtol,atol,itol,                 &amp;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;     &amp;   jac,ijac,mljac,mujac,mas,mlmas,mumas,solout,iout,idid,         &amp;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;     &amp;   nmax,uround,safe,thet,fnewt,quot1,quot2,nit,ijob,startn,       &amp;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;     &amp;   nind1,nind2,nind3,pred,facl,facr,m1,m2,nm1,                    &amp;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;     &amp;   implct,jband,ldjac,lde1,ldmas2,work(iez1),work(iez2),          &amp;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;     &amp;   work(iez3),work(iey0),work(iescal),work(ief1),work(ief2),      &amp;</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;     &amp;   work(ief3),work(iejac),work(iee1),work(iee2r),work(iee2i),     &amp;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;     &amp;   work(iemas),iwork(ieip1),iwork(ieip2),iwork(ieiph),            &amp;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;     &amp;   work(iecon),nfcn,njac,nstep,naccpt,nrejct,ndec,nsol,rpar,ipar) </div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;      iwork(14)=nfcn </div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;      iwork(15)=njac </div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;      iwork(16)=nstep </div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;      iwork(17)=naccpt </div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;      iwork(18)=nrejct </div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;      iwork(19)=ndec </div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;      iwork(20)=nsol </div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="comment">! -------- RESTORE TOLERANCES                                           </span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;      expm=1.0d0/expm </div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;      <span class="keywordflow">IF</span> (itol.EQ.0) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;              quot=atol(1)/rtol(1) </div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;              rtol(1)=(10.0d0*rtol(1))**expm </div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;              atol(1)=rtol(1)*quot </div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;      <span class="keywordflow">ELSE</span> </div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;          <span class="keywordflow">DO</span> i=1,n </div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;              quot=atol(i)/rtol(i) </div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;              rtol(i)=(10.0d0*rtol(i))**expm </div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;              atol(i)=rtol(i)*quot </div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="keywordflow">          END DO</span> </div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="keywordflow">      END IF</span> </div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment">! ----------- RETURN -----------                                        </span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;      <span class="keywordflow">RETURN</span> </div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="keyword">      END                                           </span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="comment">!     END OF SUBROUTINE RADAU5                                          </span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="comment">! ***********************************************************           </span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="keyword">      SUBROUTINE </span><a class="code" href="../../d8/dc2/radau5_8f90.html#a4e842ca41466ee359167746c1b1b7e50">radcor</a>(N,FCN,X,Y,XEND,HMAX,H,RTOL,ATOL,ITOL,           &amp;</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;     &amp;   jac,ijac,mljac,mujac,mas,mlmas,mumas,solout,iout,idid,         &amp;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;     &amp;   nmax,uround,safe,thet,fnewt,quot1,quot2,nit,ijob,startn,       &amp;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;     &amp;   nind1,nind2,nind3,pred,facl,facr,m1,m2,nm1,                    &amp;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;     &amp;   implct,banded,ldjac,lde1,ldmas,z1,z2,z3,                       &amp;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;     &amp;   y0,scal,f1,f2,f3,fjac,e1,e2r,e2i,fmas,ip1,ip2,iphes,           &amp;</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;     &amp;   cont,nfcn,njac,nstep,naccpt,nrejct,ndec,nsol,rpar,ipar)        </div>
<div class="line"><a name="l00683"></a><span class="lineno"><a class="line" href="../../d8/dc2/radau5_8f90.html#a4e842ca41466ee359167746c1b1b7e50">  683</a></span>&#160;<span class="comment">! ----------------------------------------------------------            </span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="comment">!     CORE INTEGRATOR FOR RADAU5                                        </span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="comment">!     PARAMETERS SAME AS IN RADAU5 WITH WORKSPACE ADDED                 </span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="comment">! ----------------------------------------------------------            </span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="comment">!         DECLARATIONS                                                  </span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="comment">! ----------------------------------------------------------            </span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;      <span class="keywordtype">IMPLICIT</span> <span class="keywordtype">DOUBLE PRECISION</span> (a-h,o-z) </div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;      dimension y(n),z1(n),z2(n),z3(n),y0(n),scal(n),f1(n),f2(n),f3(n) </div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;      dimension fjac(ldjac,n),fmas(ldmas,nm1),cont(4*n) </div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;      dimension e1(lde1,nm1),e2r(lde1,nm1),e2i(lde1,nm1) </div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;      dimension atol(*),rtol(*),rpar(*),ipar(*) </div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;      <span class="keywordtype">INTEGER</span> IP1(nm1),IP2(nm1),IPHES(nm1) </div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;      <span class="keyword">COMMON</span> /conra5/nn,nn2,nn3,nn4,xsol,hsol,c2m1,c1m1 </div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;      common/linal/mle,mue,mbjac,mbb,mdiag,mdiff,mbdiag </div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;      <span class="keywordtype">LOGICAL</span> REJECT,FIRST,IMPLCT,BANDED,CALJAC,STARTN,CALHES </div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;      <span class="keywordtype">LOGICAL</span> INDEX1,INDEX2,INDEX3,LAST,PRED </div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;      <span class="keywordtype">EXTERNAL</span> fcn </div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="comment">! *** *** *** *** *** *** ***                                           </span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="comment">!  INITIALISATIONS                                                      </span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="comment">! *** *** *** *** *** *** ***                                           </span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="comment">! --------- DUPLIFY N FOR COMMON BLOCK CONT -----                       </span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;      nn=n </div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;      nn2=2*n </div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;      nn3=3*n </div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;      lrc=4*n </div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="comment">! -------- CHECK THE INDEX OF THE PROBLEM -----                         </span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;      index1=nind1.NE.0 </div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;      index2=nind2.NE.0 </div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;      index3=nind3.NE.0 </div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="comment">! ------- COMPUTE MASS MATRIX FOR IMPLICIT CASE ----------              </span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;      <span class="keywordflow">IF</span> (implct) <span class="keyword">CALL </span>mas(nm1,fmas,ldmas,rpar,ipar) </div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="comment">! ---------- CONSTANTS ---------                                        </span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      sq6=dsqrt(6.d0) </div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;      c1=(4.d0-sq6)/10.d0 </div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;      c2=(4.d0+sq6)/10.d0 </div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;      c1m1=c1-1.d0 </div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;      c2m1=c2-1.d0 </div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;      c1mc2=c1-c2 </div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;      dd1=-(13.d0+7.d0*sq6)/3.d0 </div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;      dd2=(-13.d0+7.d0*sq6)/3.d0 </div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;      dd3=-1.d0/3.d0 </div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;      u1=(6.d0+81.d0**(1.d0/3.d0)-9.d0**(1.d0/3.d0))/30.d0 </div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;      alph=(12.d0-81.d0**(1.d0/3.d0)+9.d0**(1.d0/3.d0))/60.d0 </div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;      beta=(81.d0**(1.d0/3.d0)+9.d0**(1.d0/3.d0))*dsqrt(3.d0)/60.d0 </div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;      cno=alph**2+beta**2 </div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;      u1=1.0d0/u1 </div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;      alph=alph/cno </div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;      beta=beta/cno </div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;      t11=9.1232394870892942792d-02 </div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;      t12=-0.14125529502095420843d0 </div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;      t13=-3.0029194105147424492d-02 </div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;      t21=0.24171793270710701896d0 </div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;      t22=0.20412935229379993199d0 </div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;      t23=0.38294211275726193779d0 </div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;      t31=0.96604818261509293619d0 </div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;      ti11=4.3255798900631553510d0 </div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;      ti12=0.33919925181580986954d0 </div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;      ti13=0.54177053993587487119d0 </div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;      ti21=-4.1787185915519047273d0 </div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;      ti22=-0.32768282076106238708d0 </div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;      ti23=0.47662355450055045196d0 </div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;      ti31=-0.50287263494578687595d0 </div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;      ti32=2.5719269498556054292d0 </div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;      ti33=-0.59603920482822492497d0 </div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;      <span class="keywordflow">IF</span> (m1.GT.0) ijob=ijob+10 </div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;      posneg=sign(1.d0,xend-x) </div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;      hmaxn=min(abs(hmax),abs(xend-x)) </div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;      <span class="keywordflow">IF</span> (abs(h).LE.10.d0*uround) h=1.0d-6 </div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;      h=min(abs(h),hmaxn) </div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;      h=sign(h,posneg) </div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;      hold=h </div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;      reject=.false. </div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;      first=.true. </div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;      last=.false. </div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;      <span class="keywordflow">IF</span> ((x+h*1.0001d0-xend)*posneg.GE.0.d0) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;         h=xend-x </div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;         last=.true. </div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="keywordflow">      END IF</span> </div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;      hopt=h </div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;      faccon=1.d0 </div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;      cfac=safe*(1+2*nit) </div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;      nsing=0 </div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;      xold=x </div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;      <span class="keywordflow">IF</span> (iout.NE.0) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;          irtrn=1 </div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;          nrsol=1 </div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;          xosol=xold </div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;          xsol=x </div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;          <span class="keywordflow">DO</span> i=1,n </div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;             cont(i)=y(i) </div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="keywordflow">          END DO</span> </div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;          nsolu=n </div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;          hsol=hold </div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;          <span class="keyword">CALL </span>solout(nrsol,xosol,xsol,y,cont,lrc,nsolu,                &amp;</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;     &amp;                rpar,ipar,irtrn)                                  </div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;          <span class="keywordflow">IF</span> (irtrn.LT.0) <span class="keywordflow">GOTO</span> 179 </div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="keywordflow">      END IF</span> </div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;      mle=mljac </div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;      mue=mujac </div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;      mbjac=mljac+mujac+1 </div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;      mbb=mlmas+mumas+1 </div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;      mdiag=mle+mue+1 </div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;      mdiff=mle+mue-mumas </div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;      mbdiag=mumas+1 </div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;      n2=2*n </div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;      n3=3*n </div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;      <span class="keywordflow">IF</span> (itol.EQ.0) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;          <span class="keywordflow">DO</span> i=1,n </div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;             scal(i)=atol(1)+rtol(1)*abs(y(i)) </div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="keywordflow">          END DO</span> </div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;      <span class="keywordflow">ELSE</span> </div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;          <span class="keywordflow">DO</span> i=1,n </div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;             scal(i)=atol(i)+rtol(i)*abs(y(i)) </div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="keywordflow">          END DO</span> </div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="keywordflow">      END IF</span> </div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;      hhfac=h </div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;      <span class="keyword">CALL </span>fcn(n,x,y,y0,rpar,ipar) </div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;      nfcn=nfcn+1 </div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="comment">! --- BASIC INTEGRATION STEP                                            </span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;   10 <span class="keywordflow">CONTINUE</span> </div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="comment">! *** *** *** *** *** *** ***                                           </span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="comment">!  COMPUTATION OF THE JACOBIAN                                          </span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="comment">! *** *** *** *** *** *** ***                                           </span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;      njac=njac+1 </div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;      <span class="keywordflow">IF</span> (ijac.EQ.0) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;<span class="comment">! --- COMPUTE JACOBIAN MATRIX NUMERICALLY                               </span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;         <span class="keywordflow">IF</span> (banded) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="comment">! --- JACOBIAN IS BANDED                                                </span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;            mujacp=mujac+1 </div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;            md=min(mbjac,m2) </div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;            <span class="keywordflow">DO</span> mm=1,m1/m2+1 </div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;               <span class="keywordflow">DO</span> k=1,md </div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                  j=k+(mm-1)*m2 </div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;   12             f1(j)=y(j) </div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                  f2(j)=dsqrt(uround*max(1.d-5,abs(y(j)))) </div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                  y(j)=y(j)+f2(j) </div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                  j=j+md </div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                  <span class="keywordflow">IF</span> (j.LE.mm*m2) <span class="keywordflow">GOTO</span> 12 </div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                  <span class="keyword">CALL </span>fcn(n,x,y,cont,rpar,ipar) </div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                  j=k+(mm-1)*m2 </div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                  j1=k </div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;                  lbeg=max(1,j1-mujac)+m1 </div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;   14             lend=min(m2,j1+mljac)+m1 </div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;                  y(j)=f1(j) </div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                  mujacj=mujacp-j1-m1 </div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                  <span class="keywordflow">DO</span> l=lbeg,lend </div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                     fjac(l+mujacj,j)=(cont(l)-y0(l))/f2(j) </div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="keywordflow">                  END DO</span> </div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                  j=j+md </div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                  j1=j1+md </div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                  lbeg=lend+1 </div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;                  <span class="keywordflow">IF</span> (j.LE.mm*m2) <span class="keywordflow">GOTO</span> 14 </div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;<span class="keywordflow">               END DO</span> </div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="keywordflow">            END DO</span> </div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;         <span class="keywordflow">ELSE</span> </div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="comment">! --- JACOBIAN IS FULL                                                  </span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;            <span class="keywordflow">DO</span> i=1,n </div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;               ysafe=y(i) </div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;               delt=dsqrt(uround*max(1.d-5,abs(ysafe))) </div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;               y(i)=ysafe+delt </div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;               <span class="keyword">CALL </span>fcn(n,x,y,cont,rpar,ipar) </div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;               <span class="keywordflow">DO</span> j=m1+1,n </div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                 fjac(j-m1,i)=(cont(j)-y0(j))/delt </div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;<span class="keywordflow">               END DO</span> </div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;               y(i)=ysafe </div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="keywordflow">            END DO</span> </div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;<span class="keywordflow">         END IF</span> </div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;      <span class="keywordflow">ELSE</span> </div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="comment">! --- COMPUTE JACOBIAN MATRIX ANALYTICALLY                              </span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;         <span class="keyword">CALL </span>jac(n,x,y,fjac,ldjac,rpar,ipar) </div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;<span class="keywordflow">      END IF</span> </div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;      caljac=.true. </div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;      calhes=.true. </div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;   20 <span class="keywordflow">CONTINUE</span> </div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;<span class="comment">! --- COMPUTE THE MATRICES E1 AND E2 AND THEIR DECOMPOSITIONS           </span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;      fac1=u1/h </div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;      alphn=alph/h </div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;      betan=beta/h </div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;      <span class="keyword">CALL </span><a class="code" href="../../d4/d0c/radaua_8f90.html#a65630c612b19b36abe98b379fec85df3">decomr</a>(n,fjac,ldjac,fmas,ldmas,mlmas,mumas,                  &amp;</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;     &amp;            m1,m2,nm1,fac1,e1,lde1,ip1,ier,ijob,calhes,iphes)     </div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;      <span class="keywordflow">IF</span> (ier.NE.0) <span class="keywordflow">GOTO</span> 78 </div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;      <span class="keyword">CALL </span><a class="code" href="../../d4/d0c/radaua_8f90.html#ac80267bc7d108331670fe56455fa596c">decomc</a>(n,fjac,ldjac,fmas,ldmas,mlmas,mumas,                  &amp;</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;     &amp;            m1,m2,nm1,alphn,betan,e2r,e2i,lde1,ip2,ier,ijob)      </div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;      <span class="keywordflow">IF</span> (ier.NE.0) <span class="keywordflow">GOTO</span> 78 </div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;      ndec=ndec+1 </div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;   30 <span class="keywordflow">CONTINUE</span> </div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;      nstep=nstep+1 </div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;      <span class="keywordflow">IF</span> (nstep.GT.nmax) <span class="keywordflow">GOTO</span> 178 </div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;      <span class="keywordflow">IF</span> (0.1d0*abs(h).LE.abs(x)*uround) <span class="keywordflow">GOTO</span> 177 </div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;          <span class="keywordflow">IF</span> (index2) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;             <span class="keywordflow">DO</span> i=nind1+1,nind1+nind2 </div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                scal(i)=scal(i)/hhfac </div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;<span class="keywordflow">             END DO</span> </div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;<span class="keywordflow">          END IF</span> </div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;          <span class="keywordflow">IF</span> (index3) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;             <span class="keywordflow">DO</span> i=nind1+nind2+1,nind1+nind2+nind3 </div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                scal(i)=scal(i)/(hhfac*hhfac) </div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="keywordflow">             END DO</span> </div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="keywordflow">          END IF</span> </div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;      xph=x+h </div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="comment">! *** *** *** *** *** *** ***                                           </span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="comment">!  STARTING VALUES FOR NEWTON ITERATION                                 </span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="comment">! *** *** *** *** *** *** ***                                           </span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;      <span class="keywordflow">IF</span> (first.OR.startn) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;         <span class="keywordflow">DO</span> i=1,n </div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;            z1(i)=0.d0 </div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;            z2(i)=0.d0 </div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;            z3(i)=0.d0 </div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;            f1(i)=0.d0 </div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;            f2(i)=0.d0 </div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;            f3(i)=0.d0 </div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<span class="keywordflow">         END DO</span> </div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;      <span class="keywordflow">ELSE</span> </div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;         c3q=h/hold </div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;         c1q=c1*c3q </div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;         c2q=c2*c3q </div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;         <span class="keywordflow">DO</span> i=1,n </div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;            ak1=cont(i+n) </div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;            ak2=cont(i+n2) </div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;            ak3=cont(i+n3) </div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;            z1i=c1q*(ak1+(c1q-c2m1)*(ak2+(c1q-c1m1)*ak3)) </div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;            z2i=c2q*(ak1+(c2q-c2m1)*(ak2+(c2q-c1m1)*ak3)) </div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;            z3i=c3q*(ak1+(c3q-c2m1)*(ak2+(c3q-c1m1)*ak3)) </div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;            z1(i)=z1i </div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;            z2(i)=z2i </div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;            z3(i)=z3i </div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;            f1(i)=ti11*z1i+ti12*z2i+ti13*z3i </div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;            f2(i)=ti21*z1i+ti22*z2i+ti23*z3i </div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;            f3(i)=ti31*z1i+ti32*z2i+ti33*z3i </div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<span class="keywordflow">         END DO</span> </div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;<span class="keywordflow">      END IF</span> </div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;<span class="comment">! *** *** *** *** *** *** ***                                           </span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;<span class="comment">!  LOOP FOR THE SIMPLIFIED NEWTON ITERATION                             </span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="comment">! *** *** *** *** *** *** ***                                           </span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;            newt=0 </div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;            faccon=max(faccon,uround)**0.8d0 </div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;            theta=abs(thet) </div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;   40       <span class="keywordflow">CONTINUE</span> </div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;            <span class="keywordflow">IF</span> (newt.GE.nit) <span class="keywordflow">GOTO</span> 78 </div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;<span class="comment">! ---     COMPUTE THE RIGHT-HAND SIDE                                   </span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;            <span class="keywordflow">DO</span> i=1,n </div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;               cont(i)=y(i)+z1(i) </div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;<span class="keywordflow">            END DO</span> </div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;            <span class="keyword">CALL </span>fcn(n,x+c1*h,cont,z1,rpar,ipar) </div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;            <span class="keywordflow">DO</span> i=1,n </div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;               cont(i)=y(i)+z2(i) </div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;<span class="keywordflow">            END DO</span> </div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;            <span class="keyword">CALL </span>fcn(n,x+c2*h,cont,z2,rpar,ipar) </div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;            <span class="keywordflow">DO</span> i=1,n </div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;               cont(i)=y(i)+z3(i) </div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;<span class="keywordflow">            END DO</span> </div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;            <span class="keyword">CALL </span>fcn(n,xph,cont,z3,rpar,ipar) </div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;            nfcn=nfcn+3 </div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;<span class="comment">! ---     SOLVE THE LINEAR SYSTEMS                                      </span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;           <span class="keywordflow">DO</span> i=1,n </div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;              a1=z1(i) </div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;              a2=z2(i) </div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;              a3=z3(i) </div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;              z1(i)=ti11*a1+ti12*a2+ti13*a3 </div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;              z2(i)=ti21*a1+ti22*a2+ti23*a3 </div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;              z3(i)=ti31*a1+ti32*a2+ti33*a3 </div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="keywordflow">           END DO</span> </div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;        <span class="keyword">CALL </span><a class="code" href="../../d4/d0c/radaua_8f90.html#ac8b4a5dc2b85713604c8071e75a9b142">slvrad</a>(n,fjac,ldjac,mljac,mujac,fmas,ldmas,mlmas,mumas,    &amp;</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;     &amp;          m1,m2,nm1,fac1,alphn,betan,e1,e2r,e2i,lde1,z1,z2,z3,    &amp;</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;     &amp;          f1,f2,f3,cont,ip1,ip2,iphes,ier,ijob)                   </div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;            nsol=nsol+1 </div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;            newt=newt+1 </div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;            dyno=0.d0 </div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;            <span class="keywordflow">DO</span> i=1,n </div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;               denom=scal(i) </div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;               dyno=dyno+(z1(i)/denom)**2+(z2(i)/denom)**2              &amp;</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;     &amp;          +(z3(i)/denom)**2                                       </div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;<span class="keywordflow">            END DO</span> </div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;            dyno=dsqrt(dyno/n3) </div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;<span class="comment">! ---     BAD CONVERGENCE OR NUMBER OF ITERATIONS TO LARGE              </span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;            <span class="keywordflow">IF</span> (newt.GT.1.AND.newt.LT.nit) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;                thq=dyno/dynold </div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                <span class="keywordflow">IF</span> (newt.EQ.2) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                   theta=thq </div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                <span class="keywordflow">ELSE</span> </div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;                   theta=sqrt(thq*thqold) </div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;<span class="keywordflow">                END IF</span> </div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                thqold=thq </div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;                <span class="keywordflow">IF</span> (theta.LT.0.99d0) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;                    faccon=theta/(1.0d0-theta) </div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;                    dyth=faccon*dyno*theta**(nit-1-newt)/fnewt </div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;                    <span class="keywordflow">IF</span> (dyth.GE.1.0d0) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;                         qnewt=dmax1(1.0d-4,dmin1(20.0d0,dyth)) </div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;                         hhfac=.8d0*qnewt**(-1.0d0/(4.0d0+nit-1-newt)) </div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                         h=hhfac*h </div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;                         reject=.true. </div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                         last=.false. </div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                         <span class="keywordflow">IF</span> (caljac) <span class="keywordflow">GOTO</span> 20 </div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                         <span class="keywordflow">GOTO</span> 10 </div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="keywordflow">                    END IF</span> </div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                <span class="keywordflow">ELSE</span> </div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;                    <span class="keywordflow">GOTO</span> 78 </div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;<span class="keywordflow">                END IF</span> </div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;<span class="keywordflow">            END IF</span> </div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;            dynold=max(dyno,uround) </div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;            <span class="keywordflow">DO</span> i=1,n </div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;               f1i=f1(i)+z1(i) </div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;               f2i=f2(i)+z2(i) </div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;               f3i=f3(i)+z3(i) </div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;               f1(i)=f1i </div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;               f2(i)=f2i </div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;               f3(i)=f3i </div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;               z1(i)=t11*f1i+t12*f2i+t13*f3i </div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;               z2(i)=t21*f1i+t22*f2i+t23*f3i </div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;               z3(i)=t31*f1i+    f2i </div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;<span class="keywordflow">            END DO</span> </div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;            <span class="keywordflow">IF</span> (faccon*dyno.GT.fnewt) <span class="keywordflow">GOTO</span> 40 </div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;<span class="comment">! --- ERROR ESTIMATION                                                  </span></div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;      <span class="keyword">CALL </span><a class="code" href="../../d4/d0c/radaua_8f90.html#a7aa6ed027562ac751aa2889d50b741c1">estrad</a> (n,fjac,ldjac,mljac,mujac,fmas,ldmas,mlmas,mumas,     &amp;</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;     &amp;          h,dd1,dd2,dd3,fcn,nfcn,y0,y,ijob,x,m1,m2,nm1,           &amp;</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;     &amp;          e1,lde1,z1,z2,z3,cont,f1,f2,ip1,iphes,scal,err,         &amp;</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;     &amp;          first,reject,fac1,rpar,ipar)                            </div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<span class="comment">! --- COMPUTATION OF HNEW                                               </span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="comment">! --- WE REQUIRE .2&lt;=HNEW/H&lt;=8.                                         </span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;      fac=min(safe,cfac/(newt+2*nit)) </div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;      quot=max(facr,min(facl,err**.25d0/fac)) </div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;      hnew=h/quot </div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="comment">! *** *** *** *** *** *** ***                                           </span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;<span class="comment">!  IS THE ERROR SMALL ENOUGH ?                                          </span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;<span class="comment">! *** *** *** *** *** *** ***                                           </span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;      <span class="keywordflow">IF</span> (err.LT.1.d0) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="comment">! --- STEP IS ACCEPTED                                                  </span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;         first=.false. </div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;         naccpt=naccpt+1 </div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;         <span class="keywordflow">IF</span> (pred) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="comment">!       --- PREDICTIVE CONTROLLER OF GUSTAFSSON                         </span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;            <span class="keywordflow">IF</span> (naccpt.GT.1) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;               facgus=(hacc/h)*(err**2/erracc)**0.25d0/safe </div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;               facgus=max(facr,min(facl,facgus)) </div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;               quot=max(quot,facgus) </div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;               hnew=h/quot </div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;<span class="keywordflow">            END IF</span> </div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;            hacc=h </div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;            erracc=max(1.0d-2,err) </div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="keywordflow">         END IF</span> </div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;         xold=x </div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;         hold=h </div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;         x=xph </div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;         <span class="keywordflow">DO</span> i=1,n </div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;            y(i)=y(i)+z3(i) </div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;            z2i=z2(i) </div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;            z1i=z1(i) </div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;            cont(i+n)=(z2i-z3(i))/c2m1 </div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;            ak=(z1i-z2i)/c1mc2 </div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;            acont3=z1i/c1 </div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;            acont3=(ak-acont3)/c2 </div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;            cont(i+n2)=(ak-cont(i+n))/c1m1 </div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;            cont(i+n3)=cont(i+n2)-acont3 </div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="keywordflow">         END DO</span> </div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;         <span class="keywordflow">IF</span> (itol.EQ.0) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;             <span class="keywordflow">DO</span> i=1,n </div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;                scal(i)=atol(1)+rtol(1)*abs(y(i)) </div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="keywordflow">             END DO</span> </div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;         <span class="keywordflow">ELSE</span> </div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;             <span class="keywordflow">DO</span> i=1,n </div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                scal(i)=atol(i)+rtol(i)*abs(y(i)) </div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;<span class="keywordflow">             END DO</span> </div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="keywordflow">         END IF</span> </div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;         <span class="keywordflow">IF</span> (iout.NE.0) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;             nrsol=naccpt+1 </div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;             xsol=x </div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;             xosol=xold </div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;             <span class="keywordflow">DO</span> i=1,n </div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;                cont(i)=y(i) </div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;<span class="keywordflow">             END DO</span> </div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;             nsolu=n </div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;             hsol=hold </div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;             <span class="keyword">CALL </span>solout(nrsol,xosol,xsol,y,cont,lrc,nsolu,             &amp;</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;     &amp;                   rpar,ipar,irtrn)                               </div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;             <span class="keywordflow">IF</span> (irtrn.LT.0) <span class="keywordflow">GOTO</span> 179 </div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="keywordflow">         END IF</span> </div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;         caljac=.false. </div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;         <span class="keywordflow">IF</span> (last) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;            h=hopt </div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;            idid=1 </div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;            <span class="keywordflow">RETURN</span> </div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;<span class="keywordflow">         END IF</span> </div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;         <span class="keyword">CALL </span>fcn(n,x,y,y0,rpar,ipar) </div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;         nfcn=nfcn+1 </div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;         hnew=posneg*min(abs(hnew),hmaxn) </div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;         hopt=hnew </div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;         hopt=min(h,hnew) </div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;         <span class="keywordflow">IF</span> (reject) hnew=posneg*min(abs(hnew),abs(h)) </div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;         reject=.false. </div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;         <span class="keywordflow">IF</span> ((x+hnew/quot1-xend)*posneg.GE.0.d0) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;            h=xend-x </div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;            last=.true. </div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;         <span class="keywordflow">ELSE</span> </div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;            qt=hnew/h </div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;            hhfac=h </div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;            <span class="keywordflow">IF</span> (theta.LE.thet.AND.qt.GE.quot1.AND.qt.LE.quot2) <span class="keywordflow">GOTO</span> 30 </div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;            h=hnew </div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;<span class="keywordflow">         END IF</span> </div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;         hhfac=h </div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;         <span class="keywordflow">IF</span> (theta.LE.thet) <span class="keywordflow">GOTO</span> 20 </div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;         <span class="keywordflow">GOTO</span> 10 </div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;      <span class="keywordflow">ELSE</span> </div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;<span class="comment">! --- STEP IS REJECTED                                                  </span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;         reject=.true. </div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;         last=.false. </div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;         <span class="keywordflow">IF</span> (first) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;             h=h*0.1d0 </div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;             hhfac=0.1d0 </div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;         <span class="keywordflow">ELSE</span> </div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;             hhfac=hnew/h </div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;             h=hnew </div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="keywordflow">         END IF</span> </div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;         <span class="keywordflow">IF</span> (naccpt.GE.1) nrejct=nrejct+1 </div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;         <span class="keywordflow">IF</span> (caljac) <span class="keywordflow">GOTO</span> 20 </div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;         <span class="keywordflow">GOTO</span> 10 </div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;<span class="keywordflow">      END IF</span> </div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;<span class="comment">! --- UNEXPECTED STEP-REJECTION                                         </span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;   78 <span class="keywordflow">CONTINUE</span> </div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;      <span class="keywordflow">IF</span> (ier.NE.0) <span class="keywordflow">THEN</span> </div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;          nsing=nsing+1 </div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;          <span class="keywordflow">IF</span> (nsing.GE.5) <span class="keywordflow">GOTO</span> 176 </div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;<span class="keywordflow">      END IF</span> </div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;      h=h*0.5d0 </div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;      hhfac=0.5d0 </div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;      reject=.true. </div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;      last=.false. </div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;      <span class="keywordflow">IF</span> (caljac) <span class="keywordflow">GOTO</span> 20 </div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;      <span class="keywordflow">GOTO</span> 10 </div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;<span class="comment">! --- FAIL EXIT                                                         </span></div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;  176 <span class="keywordflow">CONTINUE</span> </div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;      <span class="keyword">WRITE</span>(6,979)x </div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;      <span class="keyword">WRITE</span>(6,*) <span class="stringliteral">&#39; MATRIX IS REPEATEDLY SINGULAR, IER=&#39;</span>,ier </div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;      idid=-4 </div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;      <span class="keywordflow">RETURN</span> </div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;  177 <span class="keywordflow">CONTINUE</span> </div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;      <span class="keyword">WRITE</span>(6,979)x </div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;      <span class="keyword">WRITE</span>(6,*) <span class="stringliteral">&#39; STEP SIZE T0O SMALL, H=&#39;</span>,h </div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;      idid=-3 </div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;      <span class="keywordflow">RETURN</span> </div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;  178 <span class="keywordflow">CONTINUE</span> </div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;      <span class="keyword">WRITE</span>(6,979)x </div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;      <span class="keyword">WRITE</span>(6,*) <span class="stringliteral">&#39; MORE THAN NMAX =&#39;</span>,nmax,<span class="stringliteral">&#39;STEPS ARE NEEDED&#39;</span> </div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;      idid=-2 </div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;      <span class="keywordflow">RETURN</span> </div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;<span class="comment">! --- EXIT CAUSED BY SOLOUT                                             </span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;  179 <span class="keywordflow">CONTINUE</span> </div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;      <span class="keyword">WRITE</span>(6,979)x </div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;  979 <span class="keyword">FORMAT</span>(<span class="stringliteral">&#39; EXIT OF RADAU5 AT X=&#39;</span>,e18.4) </div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;      idid=2 </div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;      <span class="keywordflow">RETURN</span> </div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;<span class="keyword">      END                                           </span></div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;<span class="comment">!     END OF SUBROUTINE RADCOR                                          </span></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;<span class="comment">! ***********************************************************           </span></div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;<span class="comment">!                                                                       </span></div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;<span class="keyword">      DOUBLE PRECISION </span><span class="keyword">FUNCTION </span><a class="code" href="../../d8/dc2/radau5_8f90.html#abb797186bfb87e738b4e322efc51340d">contr5</a>(I,X,CONT,LRC) </div>
<div class="line"><a name="l01140"></a><span class="lineno"><a class="line" href="../../d8/dc2/radau5_8f90.html#abb797186bfb87e738b4e322efc51340d"> 1140</a></span>&#160;<span class="comment">! ----------------------------------------------------------            </span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;<span class="comment">!     THIS FUNCTION CAN BE USED FOR CONINUOUS OUTPUT. IT PROVIDES AN    </span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;<span class="comment">!     APPROXIMATION TO THE I-TH COMPONENT OF THE SOLUTION AT X.         </span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;<span class="comment">!     IT GIVES THE VALUE OF THE COLLOCATION POLYNOMIAL, DEFINED FOR     </span></div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;<span class="comment">!     THE LAST SUCCESSFULLY COMPUTED STEP (BY RADAU5).                  </span></div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;<span class="comment">! ----------------------------------------------------------            </span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;      <span class="keywordtype">IMPLICIT</span> <span class="keywordtype">DOUBLE PRECISION</span> (a-h,o-z) </div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;      dimension cont(lrc) </div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;      <span class="keyword">COMMON</span> /conra5/nn,nn2,nn3,nn4,xsol,hsol,c2m1,c1m1 </div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;      s=(x-xsol)/hsol </div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;      <a class="code" href="../../d8/dc2/radau5_8f90.html#abb797186bfb87e738b4e322efc51340d">contr5</a>=cont(i)+s*(cont(i+nn)+(s-c2m1)*(cont(i+nn2)                &amp;</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;     &amp;     +(s-c1m1)*cont(i+nn3)))                                      </div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;      <span class="keywordflow">RETURN</span> </div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;<span class="keyword">      END                                           </span></div>
<div class="ttc" id="radaua_8f90_html_ac8b4a5dc2b85713604c8071e75a9b142"><div class="ttname"><a href="../../d4/d0c/radaua_8f90.html#ac8b4a5dc2b85713604c8071e75a9b142">slvrad</a></div><div class="ttdeci">subroutine slvrad(N, FJAC, LDJAC, MLJAC, MUJAC, FMAS, LDMAS, MLMAS, MUMAS,                               M1, M2, NM1, FAC1, ALPHN, BETAN, E1, E2R, E2I, LDE1, Z1, Z2, Z3,                                               F1, F2, F3, CONT, IP1, IP2, IPHES, IER, IJOB)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d0c/radaua_8f90_source.html#l00962">radaua.f90:962</a></div></div>
<div class="ttc" id="radaua_8f90_html_a7aa6ed027562ac751aa2889d50b741c1"><div class="ttname"><a href="../../d4/d0c/radaua_8f90.html#a7aa6ed027562ac751aa2889d50b741c1">estrad</a></div><div class="ttdeci">subroutine estrad(N, FJAC, LDJAC, MLJAC, MUJAC, FMAS, LDMAS, MLMAS, MUMAS,                               H, DD1, DD2, DD3, FCN, NFCN, Y0, Y, IJOB, X, M1, M2, NM1,                                                                           E1, LDE1, Z1, Z2, Z3, CONT, F1, F2, IP1, IPHES, SCAL, ERR,                                                                   FIRST, REJECT, FAC1, RPAR, IPAR)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d0c/radaua_8f90_source.html#l01289">radaua.f90:1289</a></div></div>
<div class="ttc" id="radaua_8f90_html_a65630c612b19b36abe98b379fec85df3"><div class="ttname"><a href="../../d4/d0c/radaua_8f90.html#a65630c612b19b36abe98b379fec85df3">decomr</a></div><div class="ttdeci">subroutine decomr(N, FJAC, LDJAC, FMAS, LDMAS, MLMAS, MUMAS,                                                                                       M1, M2, NM1, FAC1, E1, LDE1, IP1, IER, IJOB, CALHES, IPHES)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d0c/radaua_8f90_source.html#l00019">radaua.f90:19</a></div></div>
<div class="ttc" id="radaua_8f90_html_ac80267bc7d108331670fe56455fa596c"><div class="ttname"><a href="../../d4/d0c/radaua_8f90.html#ac80267bc7d108331670fe56455fa596c">decomc</a></div><div class="ttdeci">subroutine decomc(N, FJAC, LDJAC, FMAS, LDMAS, MLMAS, MUMAS,                                                                                       M1, M2, NM1, ALPHN, BETAN, E2R, E2I, LDE1, IP2, IER, IJOB)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d0c/radaua_8f90_source.html#l00225">radaua.f90:225</a></div></div>
<div class="ttc" id="radau5_8f90_html_aa8a78d3b03091d4b3bb487a267e170f6"><div class="ttname"><a href="../../d8/dc2/radau5_8f90.html#aa8a78d3b03091d4b3bb487a267e170f6">radau5</a></div><div class="ttdeci">subroutine radau5(N, FCN, X, Y, XEND, H,                                                                                                                                                                                           RTOL, ATOL, ITOL,                                                                                                                                                                                                   JAC, IJAC, MLJAC, MUJAC,                                                                                                                                                                       MAS, IMAS, MLMAS, MUMAS,                                                                                                                                                                       SOLOUT, IOUT,                                                                                                                                                                                                               WORK, LWORK, IWORK, LIWORK, RPAR, IPAR, IDID)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc2/radau5_8f90_source.html#l00217">radau5.f90:217</a></div></div>
<div class="ttc" id="radau5_8f90_html_a4e842ca41466ee359167746c1b1b7e50"><div class="ttname"><a href="../../d8/dc2/radau5_8f90.html#a4e842ca41466ee359167746c1b1b7e50">radcor</a></div><div class="ttdeci">subroutine radcor(N, FCN, X, Y, XEND, HMAX, H, RTOL, ATOL, ITOL,                                               JAC, IJAC, MLJAC, MUJAC, MAS, MLMAS, MUMAS, SOLOUT, IOUT, IDID,                                       NMAX, UROUND, SAFE, THET, FNEWT, QUOT1, QUOT2, NIT, IJOB, STARTN,                               NIND1, NIND2, NIND3, PRED, FACL, FACR, M1, M2, NM1,                                                                                   IMPLCT, BANDED, LDJAC, LDE1, LDMAS, Z1, Z2, Z3,                                                                                               Y0, SCAL, F1, F2, F3, FJAC, E1, E2R, E2I, FMAS, IP1, IP2, IPHES,                                               CONT, NFCN, NJAC, NSTEP, NACCPT, NREJCT, NDEC, NSOL, RPAR, IPAR)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc2/radau5_8f90_source.html#l00683">radau5.f90:683</a></div></div>
<div class="ttc" id="radau5_8f90_html_abb797186bfb87e738b4e322efc51340d"><div class="ttname"><a href="../../d8/dc2/radau5_8f90.html#abb797186bfb87e738b4e322efc51340d">contr5</a></div><div class="ttdeci">double precision function contr5(I, X, CONT, LRC)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dc2/radau5_8f90_source.html#l01140">radau5.f90:1140</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
</div>
</div>
</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
