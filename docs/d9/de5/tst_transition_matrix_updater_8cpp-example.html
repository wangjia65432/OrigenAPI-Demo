<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <!-- For Mobile Devices -->
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
        <meta name="generator" content="Doxygen 1.8.10"/>
        <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
        <title>ORIGEN API: tstTransitionMatrixUpdater.cpp</title>
        <!--<link href="../../tabs.css" rel="stylesheet" type="text/css"/>-->
        <script type="text/javascript" src="../../dynsections.js"></script>
        <link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
        <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
        <link href="../../doxygen.css" rel="stylesheet" type="text/css" />
        <link href="../../customdoxygen.css" rel="stylesheet" type="text/css"/>
        <link href='https://fonts.googleapis.com/css?family=Roboto+Slab' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="../../doxy-boot.js"></script>
    </head>
    <body>
        <nav class="navbar navbar-default" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand">ORIGEN API v0.5.2</a>
                </div>
            </div>
        </nav>
        <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
            <div class="content" id="content">
                <div class="container">
                    <div class="row">
                        <div class="col-sm-12 panel " style="padding-bottom: 15px;">
                            <div style="margin-bottom: 15px;">
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Overview</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../modules.html"><span>Components</span></a></li>
      <li><a href="../../examples.html"><span>Examples</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../d1/d5b/md__c_h_a_n_g_e_l_o_g.html"><span>Changelog</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">tstTransitionMatrixUpdater.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<p>./Manager/libld/tests/tstTransitionMatrixUpdater.cpp</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;memory.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;fstream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iomanip&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &quot;AmpxLoader/AmpxLoader.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;Nemesis/gtest/nemesis_gtest.hh&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;Origen/Core/TestPaths.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../d3/ddd/_fake_factory_8h.html">Origen/Core/dc/FakeFactory.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../d5/d77/print_8h.html">Origen/Core/fn/print.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../db/dee/_reaction_resource_i_o_8h.html">Origen/Core/io/ReactionResourceIO.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../d9/d68/_yield_resource_i_o_8h.html">Origen/Core/io/YieldResourceIO.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../d5/da1/_channel_8h.html">Origen/Core/ts/Channel.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../df/df5/_manager_2libld_2_transition_matrix_updater_8h.html">Origen/Manager/libld/TransitionMatrixUpdater.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../df/dd8/_transition_system_adapter___ampx_n_8h.html">Origen/Manager/libld/TransitionSystemAdapter_AmpxN.h</a>&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">namespace </span><a class="code" href="../../d5/dc1/namespace_origen.html">Origen</a></div>
<div class="line">{</div>
<div class="line"><span class="keyword">namespace </span>test</div>
<div class="line">{</div>
<div class="line"></div>
<div class="line"><a name="a0"></a><a class="code" href="../../d2/da0/namespace_origen_1_1test.html#ad77f4f855bd0e2892ad2574267e8930e">TEST</a>( TransitionMatrixUpdater, Load )</div>
<div class="line">{</div>
<div class="line">    <a name="_a1"></a><a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html">Origen::TransitionMatrixUpdater</a> tmu;</div>
<div class="line">    tmu.<a name="a2"></a><a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#a3cc87fdf6f503fab8a567ee48b80eded">load</a>( Origen::pwrlib_filepath,</div>
<div class="line">              Origen::jeff252_filepath,</div>
<div class="line">              Origen::yields_filepath );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>( !tmu.<a name="a3"></a><a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#aa2a7557ebf105cff8a91f2af1511adf0">initialized</a>() )</div>
<div class="line">    {</div>
<div class="line">        tmu.<a name="a4"></a><a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#ac8bb3912a3ce86b15842e79d0b421204">clear</a>();  <span class="comment">// clears errors</span></div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">// tmu.mg_database()-&gt;print(std::cout);</span></div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="../../d2/da0/namespace_origen_1_1test.html#ad77f4f855bd0e2892ad2574267e8930e">TEST</a>( TransitionMatrixUpdater, LoadUpdate )</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html">Origen::TransitionMatrixUpdater</a> tmu;</div>
<div class="line">    tmu.<a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#a3cc87fdf6f503fab8a567ee48b80eded">load</a>( Origen::pwrlib_filepath,</div>
<div class="line">              Origen::jeff252_filepath,</div>
<div class="line">              Origen::yields_filepath );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>( !tmu.<a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#aa2a7557ebf105cff8a91f2af1511adf0">initialized</a>() )</div>
<div class="line">    {</div>
<div class="line">        tmu.<a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#ac8bb3912a3ce86b15842e79d0b421204">clear</a>();  <span class="comment">// clears errors</span></div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <a class="code" href="../../d7/d09/group___cxx_typedefs.html#gabde6822a61a2a62c6bf8780cb7d42193">Origen::Vec_Flt</a> mg_flux( 252, 1.0 );</div>
<div class="line">    tmu.<a name="a5"></a><a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#adf3b22a9889a5a9f57ff56c5753c9d8b">update_mg_flux</a>( mg_flux );</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="../../d2/da0/namespace_origen_1_1test.html#ad77f4f855bd0e2892ad2574267e8930e">TEST</a>( TransitionMatrixUpdater, LoadUpdateGet )</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html">Origen::TransitionMatrixUpdater</a> tmu;</div>
<div class="line">    tmu.<a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#a3cc87fdf6f503fab8a567ee48b80eded">load</a>( Origen::pwrlib_filepath,</div>
<div class="line">              Origen::jeff252_filepath,</div>
<div class="line">              Origen::yields_filepath );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>( !tmu.<a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#aa2a7557ebf105cff8a91f2af1511adf0">initialized</a>() )</div>
<div class="line">    {</div>
<div class="line">        tmu.<a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#ac8bb3912a3ce86b15842e79d0b421204">clear</a>();  <span class="comment">// clears errors</span></div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <a class="code" href="../../d7/d09/group___cxx_typedefs.html#gabde6822a61a2a62c6bf8780cb7d42193">Origen::Vec_Flt</a> mg_flux( 252, 1.0 );</div>
<div class="line">    tmu.<a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#adf3b22a9889a5a9f57ff56c5753c9d8b">update_mg_flux</a>( mg_flux );</div>
<div class="line"></div>
<div class="line">    <a name="_a6"></a><a class="code" href="../../d7/d41/class_origen_1_1_transition_matrix_p.html">Origen::TransitionMatrixP</a> trx;</div>
<div class="line">    tmu.<a name="a7"></a><a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#a40f98aa45aaf40c4e44dce7c38ad7d31">get_transition_matrix</a>( &amp;trx );</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="../../d2/da0/namespace_origen_1_1test.html#ad77f4f855bd0e2892ad2574267e8930e">TEST</a>( TransitionMatrixUpdater, LoadUpdateGetClear )</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html">Origen::TransitionMatrixUpdater</a> tmu;</div>
<div class="line">    tmu.<a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#a3cc87fdf6f503fab8a567ee48b80eded">load</a>( Origen::pwrlib_filepath,</div>
<div class="line">              Origen::jeff252_filepath,</div>
<div class="line">              Origen::yields_filepath );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>( !tmu.<a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#aa2a7557ebf105cff8a91f2af1511adf0">initialized</a>() )</div>
<div class="line">    {</div>
<div class="line">        tmu.<a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#ac8bb3912a3ce86b15842e79d0b421204">clear</a>();  <span class="comment">// clears errors</span></div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <a class="code" href="../../d7/d09/group___cxx_typedefs.html#gabde6822a61a2a62c6bf8780cb7d42193">Origen::Vec_Flt</a> mg_flux( 252, 1.0 );</div>
<div class="line">    tmu.<a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#adf3b22a9889a5a9f57ff56c5753c9d8b">update_mg_flux</a>( mg_flux );</div>
<div class="line"></div>
<div class="line">    <a class="code" href="../../d7/d41/class_origen_1_1_transition_matrix_p.html">Origen::TransitionMatrixP</a> trx;</div>
<div class="line">    tmu.<a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#a40f98aa45aaf40c4e44dce7c38ad7d31">get_transition_matrix</a>( &amp;trx );</div>
<div class="line"></div>
<div class="line">    tmu.<a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#ac8bb3912a3ce86b15842e79d0b421204">clear</a>();</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">// for a uniform flux=1</span></div>
<div class="line">std::map&lt;int, std::map&lt;int, double&gt;&gt; <a name="a8"></a><a class="code" href="../../d2/da0/namespace_origen_1_1test.html#a17a2d41e5b7325a8740cde518546da7b">reference_sb47g_constants</a>()</div>
<div class="line">{</div>
<div class="line">    std::map&lt;int, std::map&lt;int, double&gt;&gt; <a name="a9"></a><a class="code" href="../../d8/dc8/_fake_factory_8cpp.html#a6deea1c2ba17f0529b284f5013940b9f">r</a>;</div>
<div class="line"></div>
<div class="line">    r[92235][16] = 0.25605130195617676;</div>
<div class="line">    r[92235][17] = 0.014363746158778667;</div>
<div class="line">    r[92235][18] = 1.4366118907928467;</div>
<div class="line">    r[92235][102] = 0.023061279207468033;</div>
<div class="line">    r[92238][16] = 0.38620460033416748;</div>
<div class="line">    r[92238][17] = 0.062143206596374512;</div>
<div class="line">    r[92238][18] = 0.74442368745803833;</div>
<div class="line">    r[92238][102] = 0.01585003174841404;</div>
<div class="line">    r[94240][16] = 0.10783249884843826;</div>
<div class="line">    r[94240][17] = 0.027231113985180855;</div>
<div class="line">    r[94240][18] = 1.8240015506744385;</div>
<div class="line">    r[94240][102] = 0.022608127444982529;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="../../d8/dc8/_fake_factory_8cpp.html#a6deea1c2ba17f0529b284f5013940b9f">r</a>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">// for a uniform flux=1</span></div>
<div class="line">std::map&lt;int, std::map&lt;int, double&gt;&gt; <a name="a10"></a><a class="code" href="../../d2/da0/namespace_origen_1_1test.html#a8523016b565f842e3e4b38e84e5b4cad">reference_ub47g_constants</a>()</div>
<div class="line">{</div>
<div class="line">    std::map&lt;int, std::map&lt;int, double&gt;&gt; <a class="code" href="../../d8/dc8/_fake_factory_8cpp.html#a6deea1c2ba17f0529b284f5013940b9f">r</a>;</div>
<div class="line"></div>
<div class="line">    r[92235][16] = 0.3402692973613739;</div>
<div class="line">    r[92235][17] = 0.038585104048252106;</div>
<div class="line">    r[92235][18] = 1.6015549898147583;</div>
<div class="line">    r[92235][102] = 0.022057455033063889;</div>
<div class="line">    r[92238][16] = 0.57465583086013794;</div>
<div class="line">    r[92238][17] = 0.16693426668643951;</div>
<div class="line">    r[92238][18] = 0.84844231605529785;</div>
<div class="line">    r[92238][102] = 0.015442271716892719;</div>
<div class="line">    r[94240][16] = 0.18764506280422211;</div>
<div class="line">    r[94240][17] = 0.073150500655174255;</div>
<div class="line">    r[94240][18] = 1.9431796073913574;</div>
<div class="line">    r[94240][102] = 0.021005298942327499;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="../../d8/dc8/_fake_factory_8cpp.html#a6deea1c2ba17f0529b284f5013940b9f">r</a>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="../../d2/da0/namespace_origen_1_1test.html#ad77f4f855bd0e2892ad2574267e8930e">TEST</a>( TransitionMatrixUpdater, StorageBounds47g )</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// get 47 group bounds</span></div>
<div class="line">    <a class="code" href="../../d7/d09/group___cxx_typedefs.html#gab1ba8712f15aa615abd0cbc3cc58112f">Origen::Vec_Dbl</a> mpact_47g_dbl;</div>
<div class="line">    <a name="a11"></a><a class="code" href="../../da/daf/class_origen_1_1_fake_factory.html#ad24e9f66ad7d4b0c7ead7e098d829e67">Origen::FakeFactory::energy_bounds_mpact_47g</a>( mpact_47g_dbl );</div>
<div class="line">    <a class="code" href="../../d7/d09/group___cxx_typedefs.html#gabde6822a61a2a62c6bf8780cb7d42193">Origen::Vec_Flt</a> mpact_47g;</div>
<div class="line">    mpact_47g.assign( mpact_47g_dbl.begin(), mpact_47g_dbl.end() );</div>
<div class="line"></div>
<div class="line">    <span class="comment">// uniform flux spectrum</span></div>
<div class="line">    <a class="code" href="../../d7/d09/group___cxx_typedefs.html#gabde6822a61a2a62c6bf8780cb7d42193">Origen::Vec_Flt</a> mg_flux( 47 );</div>
<div class="line">    <a name="a12"></a><a class="code" href="../../da/daf/class_origen_1_1_fake_factory.html#ae772ec19f14f2f34488e637115bff053">Origen::FakeFactory::getUniformFlux</a>( &amp;mg_flux, mpact_47g );</div>
<div class="line"></div>
<div class="line">    <span class="comment">// set storage bounds and load the data</span></div>
<div class="line">    <a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html">Origen::TransitionMatrixUpdater</a> tmu( mpact_47g );</div>
<div class="line">    tmu.<a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#a3cc87fdf6f503fab8a567ee48b80eded">load</a>( Origen::pwrlib_filepath,</div>
<div class="line">              Origen::jeff252_filepath,</div>
<div class="line">              Origen::yields_filepath );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>( !tmu.<a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#aa2a7557ebf105cff8a91f2af1511adf0">initialized</a>() )</div>
<div class="line">    {</div>
<div class="line">        tmu.<a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#ac8bb3912a3ce86b15842e79d0b421204">clear</a>();  <span class="comment">// clears errors</span></div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    jDebugBlock( {</div>
<div class="line">        std::ofstream ofs( <span class="stringliteral">&quot;mg.txt&quot;</span> );</div>
<div class="line">        tmu.<a name="a13"></a><a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#ae36f3ab90b463aa3b534d336d6254931">mg_database</a>()-&gt;<a name="a14"></a><a class="code" href="../../d1/d0c/class_origen_1_1_reaction_resource.html#a3d83bd59cda5c6a2e4d9cbaa484ef6e0">print</a>( ofs );</div>
<div class="line">    } );</div>
<div class="line"></div>
<div class="line">    <span class="comment">// update flux</span></div>
<div class="line">    tmu.<a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#adf3b22a9889a5a9f57ff56c5753c9d8b">update_mg_flux</a>( mg_flux );</div>
<div class="line"></div>
<div class="line">    <a class="code" href="../../d7/d41/class_origen_1_1_transition_matrix_p.html">Origen::TransitionMatrixP</a> trx;</div>
<div class="line">    tmu.<a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#a40f98aa45aaf40c4e44dce7c38ad7d31">get_transition_matrix</a>( &amp;trx );</div>
<div class="line">    <span class="comment">// spot check values</span></div>
<div class="line">    <span class="keywordflow">for</span>( <span class="keyword">auto</span> x1 : <a class="code" href="../../d2/da0/namespace_origen_1_1test.html#a17a2d41e5b7325a8740cde518546da7b">reference_sb47g_constants</a>() )</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordtype">int</span> <span class="keywordtype">id</span> = x1.first;</div>
<div class="line">        <span class="keywordflow">for</span>( <span class="keyword">auto</span> x2 : x1.second )</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordtype">int</span> mt = x2.first;</div>
<div class="line">            <span class="keywordtype">double</span> ref = x2.second;</div>
<div class="line">            EXPECT_NEAR(</div>
<div class="line">                ref,</div>
<div class="line">                tmu.<a name="a15"></a><a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#aeabe0f0df4e7fb3d326b17b638429e6c">transition_system</a>()-&gt;<a name="a16"></a><a class="code" href="../../df/d1a/class_origen_1_1_transition_system.html#a76c224d3bcb16b386641bb9f6d6026aa">nuclide</a>( <span class="keywordtype">id</span> )-&gt;loss( mt )-&gt;xs(),</div>
<div class="line">                1e-5 * ref );</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    jDebugBlock( {</div>
<div class="line">        std::ofstream ofs( <span class="stringliteral">&quot;StorageBounds47g.trx.txt&quot;</span> );</div>
<div class="line">        ofs &lt;&lt; trx.<a name="a17"></a><a class="code" href="../../d7/d41/class_origen_1_1_transition_matrix_p.html#aaf310237903a7f2dd1c3d47b727e47f5">toQString</a>( 3, <span class="stringliteral">&quot;F&quot;</span>, 0, 0 ).toStdString() &lt;&lt; std::endl;</div>
<div class="line">    } );</div>
<div class="line"></div>
<div class="line">    tmu.<a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#ac8bb3912a3ce86b15842e79d0b421204">clear</a>();</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="../../d2/da0/namespace_origen_1_1test.html#ad77f4f855bd0e2892ad2574267e8930e">TEST</a>( TransitionMatrixUpdater, UserBounds47g )</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// use default storage bounds and load the data</span></div>
<div class="line">    <a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html">Origen::TransitionMatrixUpdater</a> tmu;</div>
<div class="line">    tmu.<a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#a3cc87fdf6f503fab8a567ee48b80eded">load</a>( Origen::pwrlib_filepath,</div>
<div class="line">              Origen::jeff252_filepath,</div>
<div class="line">              Origen::yields_filepath );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>( !tmu.<a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#aa2a7557ebf105cff8a91f2af1511adf0">initialized</a>() )</div>
<div class="line">    {</div>
<div class="line">        tmu.<a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#ac8bb3912a3ce86b15842e79d0b421204">clear</a>();  <span class="comment">// clears errors</span></div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    jDebugBlock( {</div>
<div class="line">        std::ofstream ofs( <span class="stringliteral">&quot;mg.txt&quot;</span> );</div>
<div class="line">        tmu.<a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#ae36f3ab90b463aa3b534d336d6254931">mg_database</a>()-&gt;<a class="code" href="../../d1/d0c/class_origen_1_1_reaction_resource.html#a3d83bd59cda5c6a2e4d9cbaa484ef6e0">print</a>( ofs );</div>
<div class="line">    } );</div>
<div class="line"></div>
<div class="line">    <span class="comment">// get 47g user bounds</span></div>
<div class="line">    <a class="code" href="../../d7/d09/group___cxx_typedefs.html#gab1ba8712f15aa615abd0cbc3cc58112f">Origen::Vec_Dbl</a> mpact_47g_dbl;</div>
<div class="line">    <a class="code" href="../../da/daf/class_origen_1_1_fake_factory.html#ad24e9f66ad7d4b0c7ead7e098d829e67">Origen::FakeFactory::energy_bounds_mpact_47g</a>( mpact_47g_dbl );</div>
<div class="line">    <a class="code" href="../../d7/d09/group___cxx_typedefs.html#gabde6822a61a2a62c6bf8780cb7d42193">Origen::Vec_Flt</a> mpact_47g;</div>
<div class="line">    mpact_47g.assign( mpact_47g_dbl.begin(), mpact_47g_dbl.end() );</div>
<div class="line">    tmu.<a name="a18"></a><a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#a446e4e3e46e021a4300a9eab9d93e0b8">set_user_bounds</a>( mpact_47g );</div>
<div class="line"></div>
<div class="line">    <span class="comment">// uniform flux spectrum</span></div>
<div class="line">    <a class="code" href="../../d7/d09/group___cxx_typedefs.html#gabde6822a61a2a62c6bf8780cb7d42193">Origen::Vec_Flt</a> mg_flux( 47 );</div>
<div class="line">    <a class="code" href="../../da/daf/class_origen_1_1_fake_factory.html#ae772ec19f14f2f34488e637115bff053">Origen::FakeFactory::getUniformFlux</a>( &amp;mg_flux, mpact_47g );</div>
<div class="line"></div>
<div class="line">    <span class="comment">// update</span></div>
<div class="line">    tmu.<a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#adf3b22a9889a5a9f57ff56c5753c9d8b">update_mg_flux</a>( mg_flux );</div>
<div class="line"></div>
<div class="line">    <a class="code" href="../../d7/d41/class_origen_1_1_transition_matrix_p.html">Origen::TransitionMatrixP</a> trx;</div>
<div class="line">    tmu.<a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#a40f98aa45aaf40c4e44dce7c38ad7d31">get_transition_matrix</a>( &amp;trx );</div>
<div class="line"></div>
<div class="line">    <span class="comment">// spot check values</span></div>
<div class="line">    <span class="keywordflow">for</span>( <span class="keyword">auto</span> x1 : <a class="code" href="../../d2/da0/namespace_origen_1_1test.html#a8523016b565f842e3e4b38e84e5b4cad">reference_ub47g_constants</a>() )</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordtype">int</span> <span class="keywordtype">id</span> = x1.first;</div>
<div class="line">        <span class="keywordflow">for</span>( <span class="keyword">auto</span> x2 : x1.second )</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordtype">int</span> mt = x2.first;</div>
<div class="line">            <span class="keywordtype">double</span> ref = x2.second;</div>
<div class="line">            EXPECT_NEAR(</div>
<div class="line">                ref,</div>
<div class="line">                tmu.<a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#aeabe0f0df4e7fb3d326b17b638429e6c">transition_system</a>()-&gt;<a class="code" href="../../df/d1a/class_origen_1_1_transition_system.html#a76c224d3bcb16b386641bb9f6d6026aa">nuclide</a>( <span class="keywordtype">id</span> )-&gt;loss( mt )-&gt;xs(),</div>
<div class="line">                1e-5 * ref );</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    jDebugBlock( {</div>
<div class="line">        std::ofstream ofs( <span class="stringliteral">&quot;UserBounds47g.trx.txt&quot;</span> );</div>
<div class="line">        ofs &lt;&lt; trx.<a class="code" href="../../d7/d41/class_origen_1_1_transition_matrix_p.html#aaf310237903a7f2dd1c3d47b727e47f5">toQString</a>( 3, <span class="stringliteral">&quot;F&quot;</span>, 0, 0 ).toStdString() &lt;&lt; std::endl;</div>
<div class="line">    } );</div>
<div class="line"></div>
<div class="line">    tmu.<a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#ac8bb3912a3ce86b15842e79d0b421204">clear</a>();</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="../../d2/da0/namespace_origen_1_1test.html#ad77f4f855bd0e2892ad2574267e8930e">TEST</a>( TransitionMatrixUpdater, FetchNuclides )</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html">Origen::TransitionMatrixUpdater</a> tmu;</div>
<div class="line">    tmu.<a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#a3cc87fdf6f503fab8a567ee48b80eded">load</a>( Origen::pwrlib_filepath,</div>
<div class="line">              Origen::jeff252_filepath,</div>
<div class="line">              Origen::yields_filepath );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>( !tmu.<a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#aa2a7557ebf105cff8a91f2af1511adf0">initialized</a>() )</div>
<div class="line">    {</div>
<div class="line">        tmu.<a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#ac8bb3912a3ce86b15842e79d0b421204">clear</a>();  <span class="comment">// clears errors</span></div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">// some checks on providing access to skeleton</span></div>
<div class="line">    <a class="code" href="../../d5/dc1/namespace_origen.html#a7a406c531668ac8d63ce2e70eb1b38f4">Origen::SP_TransitionMatrixP</a> base_trx = tmu.<a name="a19"></a><a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#ab32eb6c95f1f1d94f29c475519b37ce2">base_transition_matrix</a>();</div>
<div class="line">    ASSERT_TRUE( base_trx != <span class="keyword">nullptr</span> );</div>
<div class="line">    EXPECT_EQ( 2237, base_trx-&gt;get_itot() );</div>
<div class="line">    std::vector&lt;Origen::SP_Nuclide&gt; ts_nuclides;</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Test ability to fetch when FP have +5000 AAAI</span></div>
<div class="line">    {</div>
<div class="line">        std::string id_form = <span class="stringliteral">&quot;ZZZAAAI+FP5000&quot;</span>;</div>
<div class="line">        std::vector&lt;int&gt; n_list;</div>
<div class="line">        n_list.push_back( 922350 );</div>
<div class="line">        n_list.push_back( 636510 );</div>
<div class="line">        n_list.push_back( 10020 );</div>
<div class="line">        n_list.push_back( 922351 );</div>
<div class="line"></div>
<div class="line">        tmu.<a name="a20"></a><a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#a02699aecc52b75032c4601385c34ce16">fetch_ts_nuclides</a>( &amp;ts_nuclides, id_form, n_list );</div>
<div class="line">        ASSERT_EQ( 4u, ts_nuclides.size() );</div>
<div class="line">        <span class="keywordflow">for</span>( <span class="keywordtype">size_t</span> i = 0; i &lt; ts_nuclides.size(); ++i )</div>
<div class="line">        {</div>
<div class="line">            ASSERT_TRUE( ts_nuclides[i] != <span class="keyword">nullptr</span> );</div>
<div class="line">        }</div>
<div class="line">        EXPECT_EQ( 92235, ts_nuclides[0]-&gt;<span class="keywordtype">id</span>() );</div>
<div class="line">        EXPECT_EQ( 63151, ts_nuclides[1]-&gt;<span class="keywordtype">id</span>() );</div>
<div class="line">        EXPECT_EQ( 1002, ts_nuclides[2]-&gt;<span class="keywordtype">id</span>() );</div>
<div class="line">        EXPECT_EQ( 1092235, ts_nuclides[3]-&gt;<span class="keywordtype">id</span>() );</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Test ability to fetch ZZZAAAI</span></div>
<div class="line">    {</div>
<div class="line">        std::string id_form = <span class="stringliteral">&quot;ZZZAAAI&quot;</span>;</div>
<div class="line">        std::vector&lt;int&gt; n_list;</div>
<div class="line">        n_list.push_back( 922350 );</div>
<div class="line">        n_list.push_back( 631510 );</div>
<div class="line">        n_list.push_back( 10020 );</div>
<div class="line">        n_list.push_back( 922351 );</div>
<div class="line"></div>
<div class="line">        tmu.<a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#a02699aecc52b75032c4601385c34ce16">fetch_ts_nuclides</a>( &amp;ts_nuclides, id_form, n_list );</div>
<div class="line">        ASSERT_EQ( 4u, ts_nuclides.size() );</div>
<div class="line">        <span class="keywordflow">for</span>( <span class="keywordtype">size_t</span> i = 0; i &lt; ts_nuclides.size(); ++i )</div>
<div class="line">        {</div>
<div class="line">            ASSERT_TRUE( ts_nuclides[i] != <span class="keyword">nullptr</span> );</div>
<div class="line">        }</div>
<div class="line">        EXPECT_EQ( 92235, ts_nuclides[0]-&gt;<span class="keywordtype">id</span>() );</div>
<div class="line">        EXPECT_EQ( 63151, ts_nuclides[1]-&gt;<span class="keywordtype">id</span>() );</div>
<div class="line">        EXPECT_EQ( 1002, ts_nuclides[2]-&gt;<span class="keywordtype">id</span>() );</div>
<div class="line">        EXPECT_EQ( 1092235, ts_nuclides[3]-&gt;<span class="keywordtype">id</span>() );</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Test ability to fetch IZZZAAA</span></div>
<div class="line">    {</div>
<div class="line">        std::string id_form = <span class="stringliteral">&quot;IZZZAAA&quot;</span>;</div>
<div class="line">        std::vector&lt;int&gt; n_list;</div>
<div class="line">        n_list.push_back( 92235 );</div>
<div class="line">        n_list.push_back( 63151 );</div>
<div class="line">        n_list.push_back( 1002 );</div>
<div class="line">        n_list.push_back( 1092235 );</div>
<div class="line"></div>
<div class="line">        tmu.<a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#a02699aecc52b75032c4601385c34ce16">fetch_ts_nuclides</a>( &amp;ts_nuclides, id_form, n_list );</div>
<div class="line">        ASSERT_EQ( 4u, ts_nuclides.size() );</div>
<div class="line">        <span class="keywordflow">for</span>( <span class="keywordtype">size_t</span> i = 0; i &lt; ts_nuclides.size(); ++i )</div>
<div class="line">        {</div>
<div class="line">            ASSERT_TRUE( ts_nuclides[i] != <span class="keyword">nullptr</span> );</div>
<div class="line">        }</div>
<div class="line">        EXPECT_EQ( 92235, ts_nuclides[0]-&gt;<span class="keywordtype">id</span>() );</div>
<div class="line">        EXPECT_EQ( 63151, ts_nuclides[1]-&gt;<span class="keywordtype">id</span>() );</div>
<div class="line">        EXPECT_EQ( 1002, ts_nuclides[2]-&gt;<span class="keywordtype">id</span>() );</div>
<div class="line">        EXPECT_EQ( 1092235, ts_nuclides[3]-&gt;<span class="keywordtype">id</span>() );</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="../../d2/da0/namespace_origen_1_1test.html#ad77f4f855bd0e2892ad2574267e8930e">TEST</a>( TransitionMatrixUpdater, LoadWithUserReactions )</div>
<div class="line">{</div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     Try to lad the libraries adding in the following user-defined</span></div>
<div class="line"><span class="comment">     reaction channels:</span></div>
<div class="line"><span class="comment">        H-1 (n,g)     // A reaction that already exists</span></div>
<div class="line"><span class="comment">        H-1 (n,2n)    // A reaction that does not exist (yes its silly)</span></div>
<div class="line"><span class="comment">        H-2  ---      // Nuclide with zero MTs is allowed</span></div>
<div class="line"><span class="comment">        B-11 (n,2n)   // A reaction with nothing special in it.</span></div>
<div class="line"><span class="comment">        B-11 (n,na)   // A reaction which (at the time of writing this) is</span></div>
<div class="line"><span class="comment">                      // in .orglib but not in the MG data.</span></div>
<div class="line"><span class="comment">        U-235 (n,f)   // This should not break fission.</span></div>
<div class="line"><span class="comment">    */</span></div>
<div class="line"></div>
<div class="line">    std::vector&lt;int&gt; user_nuclide_list = {1001, 1002, 5011, 92235};</div>
<div class="line">    std::vector&lt;int&gt; user_num_mts = {2, 0, 2, 1};</div>
<div class="line">    std::vector&lt;int&gt; user_mt_list = {102, 16, 16, 22, 18};</div>
<div class="line"></div>
<div class="line">    <span class="comment">// ZAI corresponding to each element of the user_mt_list.</span></div>
<div class="line">    std::vector&lt;int&gt; expanded_zai = {10010, 10010, 50110, 50110, 922350};</div>
<div class="line"></div>
<div class="line">    <a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html">Origen::TransitionMatrixUpdater</a> tmu;</div>
<div class="line">    tmu.<a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#a3cc87fdf6f503fab8a567ee48b80eded">load</a>( Origen::pwrlib_filepath,</div>
<div class="line">              Origen::jeff252_filepath,</div>
<div class="line">              Origen::yields_filepath,</div>
<div class="line">              user_nuclide_list,</div>
<div class="line">              user_num_mts,</div>
<div class="line">              user_mt_list );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>( !tmu.<a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#aa2a7557ebf105cff8a91f2af1511adf0">initialized</a>() )</div>
<div class="line">    {</div>
<div class="line">        tmu.<a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#ac8bb3912a3ce86b15842e79d0b421204">clear</a>();  <span class="comment">// clears errors</span></div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Updating MG flux once is required even if you intend to set one-group.</span></div>
<div class="line">    <a class="code" href="../../d7/d09/group___cxx_typedefs.html#gabde6822a61a2a62c6bf8780cb7d42193">Origen::Vec_Flt</a> mg_flux( 252, 1.0 );</div>
<div class="line">    tmu.<a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#adf3b22a9889a5a9f57ff56c5753c9d8b">update_mg_flux</a>( mg_flux );</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Get the cross-sections.</span></div>
<div class="line">    <a class="code" href="../../d7/d09/group___cxx_typedefs.html#gabde6822a61a2a62c6bf8780cb7d42193">Origen::Vec_Flt</a> xs( user_mt_list.size(), 0.0 );</div>
<div class="line"></div>
<div class="line">    tmu.<a name="a21"></a><a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#a31a24a0d32386f9e5d46b7977712f5b3">get_xs</a>( <span class="stringliteral">&quot;IZZZAAA&quot;</span>, user_nuclide_list, user_num_mts, user_mt_list, &amp;xs );</div>
<div class="line"></div>
<div class="line">    <span class="comment">// New reactions are zero, the pre-existing ones with mg data non-zero.</span></div>
<div class="line">    EXPECT_TRUE( xs[0] != 0.0 );</div>
<div class="line">    EXPECT_TRUE( xs[1] == 0.0 );</div>
<div class="line">    EXPECT_TRUE( xs[2] != 0.0 );</div>
<div class="line">    EXPECT_TRUE( xs[3] == 0.0 );</div>
<div class="line">    EXPECT_TRUE( xs[2] != 0.0 );</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Set the cross-sections.</span></div>
<div class="line">    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; xs.size(); ++i ) xs[i] = ( i + 1 ) * 1000;</div>
<div class="line"></div>
<div class="line">    tmu.<a name="a22"></a><a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#a7b4ac774cfa0727fe906a9c63112d46f">update_user_xs</a>(</div>
<div class="line">        <span class="stringliteral">&quot;IZZZAAA&quot;</span>, user_nuclide_list, user_num_mts, user_mt_list, xs );</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Data was copied so this won&#39;t affect the values in tmu.</span></div>
<div class="line">    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; xs.size(); ++i ) xs[i] = 0;</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Get the cross-sections.</span></div>
<div class="line">    tmu.<a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#a31a24a0d32386f9e5d46b7977712f5b3">get_xs</a>( <span class="stringliteral">&quot;IZZZAAA&quot;</span>, user_nuclide_list, user_num_mts, user_mt_list, &amp;xs );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; xs.size(); ++i )</div>
<div class="line">        EXPECT_DOUBLE_EQ( ( i + 1 ) * 1000, xs[i] );</div>
<div class="line"></div>
<div class="line">    <span class="comment">// &gt;&gt;&gt;  Check that the altered values made it to the TransitionMatrix</span></div>
<div class="line">    <a class="code" href="../../d7/d41/class_origen_1_1_transition_matrix_p.html">Origen::TransitionMatrixP</a> trx;</div>
<div class="line">    tmu.<a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#a40f98aa45aaf40c4e44dce7c38ad7d31">get_transition_matrix</a>( &amp;trx );</div>
<div class="line"></div>
<div class="line">    DoubleList diag, offdiag;</div>
<div class="line">    trx.<a name="a23"></a><a class="code" href="../../d7/d41/class_origen_1_1_transition_matrix_p.html#aea4c366ba8378fa70bc05f398ddfeb9d">fold_flux</a>( 1.0e24,</div>
<div class="line">                   diag,</div>
<div class="line">                   offdiag );  <span class="comment">// The 1e24 flux causes the elements</span></div>
<div class="line">    <span class="comment">// to be in xs units.</span></div>
<div class="line"></div>
<div class="line">    <span class="comment">/************************************************************************/</span></div>
<div class="line">    <span class="comment">// The get_xs function in transition matrix is broken and intended to be</span></div>
<div class="line">    <span class="comment">// removed so it should not be used. Instead get the actual transition</span></div>
<div class="line">    <span class="comment">// matrix and check values in it.</span></div>
<div class="line"></div>
<div class="line">    <span class="comment">// Convert the Lists to vectors</span></div>
<div class="line">    <span class="keywordtype">int</span> itot = trx.<a name="a24"></a><a class="code" href="../../d7/d41/class_origen_1_1_transition_matrix_p.html#a1449e4fbb3a0e4db78f29723b39210b4">get_itot</a>();</div>
<div class="line">    <span class="keywordtype">int</span> non = trx.<a name="a25"></a><a class="code" href="../../d7/d41/class_origen_1_1_transition_matrix_p.html#a84735baa2839cf6846f91b29267a0774">get_non</a>();</div>
<div class="line">    std::vector&lt;int&gt; non0( itot ), kd( itot ), loc( non ), ZAI( itot );</div>
<div class="line"></div>
<div class="line">    copy( trx.<a name="a26"></a><a class="code" href="../../d7/d41/class_origen_1_1_transition_matrix_p.html#a7271cecf8ba475bc14718a31922e0b15">get_non0_</a>()-&gt;begin(), trx.<a class="code" href="../../d7/d41/class_origen_1_1_transition_matrix_p.html#a7271cecf8ba475bc14718a31922e0b15">get_non0_</a>()-&gt;end(), non0.begin() );</div>
<div class="line">    copy( trx.<a name="a27"></a><a class="code" href="../../d7/d41/class_origen_1_1_transition_matrix_p.html#a5de37bf4f7765d619d49631377807bb4">get_kd_</a>()-&gt;begin(), trx.<a class="code" href="../../d7/d41/class_origen_1_1_transition_matrix_p.html#a5de37bf4f7765d619d49631377807bb4">get_kd_</a>()-&gt;end(), kd.begin() );</div>
<div class="line">    copy( trx.<a name="a28"></a><a class="code" href="../../d7/d41/class_origen_1_1_transition_matrix_p.html#ab63e74ab07483a9e216f76e268a216e1">get_loc</a>()-&gt;begin(), trx.<a class="code" href="../../d7/d41/class_origen_1_1_transition_matrix_p.html#ab63e74ab07483a9e216f76e268a216e1">get_loc</a>()-&gt;end(), loc.begin() );</div>
<div class="line">    copy( trx.<a name="a29"></a><a class="code" href="../../d7/d41/class_origen_1_1_transition_matrix_p.html#a0698935df7a744862336340fb4148a2c">get_nucl</a>()-&gt;begin(), trx.<a class="code" href="../../d7/d41/class_origen_1_1_transition_matrix_p.html#a0698935df7a744862336340fb4148a2c">get_nucl</a>()-&gt;end(), ZAI.begin() );</div>
<div class="line"></div>
<div class="line">    <span class="comment">// &gt;&gt;&gt; Convert Origen form to dense matrix</span></div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">double</span>** B = (<span class="keywordtype">double</span>**)calloc( itot, <span class="keyword">sizeof</span>( <span class="keywordtype">double</span>* ) );</div>
<div class="line">    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; itot; i++ )</div>
<div class="line">        B[i] = (<span class="keywordtype">double</span>*)calloc( itot, <span class="keyword">sizeof</span>( <span class="keywordtype">double</span> ) );</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Add diagonal elements</span></div>
<div class="line">    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; itot; i++ ) B[i][i] += diag[i];</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Add offdiagonal elements</span></div>
<div class="line">    {</div>
<div class="line">        <span class="keywordtype">int</span> j = 0;</div>
<div class="line">        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; itot; i++ )  <span class="comment">// rows (parents)</span></div>
<div class="line">            <span class="keywordflow">for</span>( <span class="keywordtype">int</span> p = 0; p &lt; non0[i]; p++ )</div>
<div class="line">            {</div>
<div class="line">                B[i][loc[j]] += offdiag[j];</div>
<div class="line">                j++;</div>
<div class="line">            }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">// &gt;&gt;&gt; Now B is the transition matrix in a dense format.</span></div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">int</span> idx_H1 = trx.<a name="a30"></a><a class="code" href="../../d7/d41/class_origen_1_1_transition_matrix_p.html#a45af7857fe499e0d88027616edd91e32">find_nuclide</a>( 1, 10010 );</div>
<div class="line">    <span class="keywordtype">int</span> idx_B11 = trx.<a class="code" href="../../d7/d41/class_origen_1_1_transition_matrix_p.html#a45af7857fe499e0d88027616edd91e32">find_nuclide</a>( 1, 50110 );</div>
<div class="line">    <span class="keywordtype">int</span> idx_U235 = trx.<a class="code" href="../../d7/d41/class_origen_1_1_transition_matrix_p.html#a45af7857fe499e0d88027616edd91e32">find_nuclide</a>( 2, 922350 );</div>
<div class="line"></div>
<div class="line">    <span class="comment">// The massive flux we set means that the xs should dominate diagonal</span></div>
<div class="line"></div>
<div class="line">    EXPECT_NEAR( B[idx_H1][idx_H1], -3000, 0.001 * 3000 );</div>
<div class="line">    EXPECT_NEAR( B[idx_B11][idx_B11], -7000, 0.001 * 7000 );</div>
<div class="line">    EXPECT_NEAR( B[idx_U235][idx_U235], -5000, 0.01 * 5000 );</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Check the daughters</span></div>
<div class="line"></div>
<div class="line">    EXPECT_FLOAT_EQ( B[trx.<a class="code" href="../../d7/d41/class_origen_1_1_transition_matrix_p.html#a45af7857fe499e0d88027616edd91e32">find_nuclide</a>( 1, 10020 )][idx_H1], 1000 );</div>
<div class="line">    EXPECT_FLOAT_EQ( B[trx.<a class="code" href="../../d7/d41/class_origen_1_1_transition_matrix_p.html#a45af7857fe499e0d88027616edd91e32">find_nuclide</a>( 1, 50100 )][idx_B11], 3000 );</div>
<div class="line">    EXPECT_FLOAT_EQ( B[trx.<a class="code" href="../../d7/d41/class_origen_1_1_transition_matrix_p.html#a45af7857fe499e0d88027616edd91e32">find_nuclide</a>( 1, 30070 )][idx_B11], 4000 );</div>
<div class="line"></div>
<div class="line">    <span class="comment">// For fission, check that the total production from U-235 is close</span></div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">double</span> tot_yield = 0.0;</div>
<div class="line">    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; itot; ++i )</div>
<div class="line">        <span class="keywordflow">if</span>( i != idx_U235 ) tot_yield += B[i][idx_U235];</div>
<div class="line">    EXPECT_NEAR( tot_yield, 10000, 0.01 * 10000 );</div>
<div class="line"></div>
<div class="line">    <span class="comment">/************************************************************************/</span></div>
<div class="line">    <span class="comment">// Finally, check that we did not break the multigroup functionality</span></div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 25; i &lt; 252; ++i ) mg_flux[i] = 0;  <span class="comment">// softer spectrum</span></div>
<div class="line"></div>
<div class="line">    tmu.<a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#adf3b22a9889a5a9f57ff56c5753c9d8b">update_mg_flux</a>( mg_flux );</div>
<div class="line">    tmu.<a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#a40f98aa45aaf40c4e44dce7c38ad7d31">get_transition_matrix</a>( &amp;trx );</div>
<div class="line">    trx.<a class="code" href="../../d7/d41/class_origen_1_1_transition_matrix_p.html#aea4c366ba8378fa70bc05f398ddfeb9d">fold_flux</a>( 1.0e24, diag, offdiag );</div>
<div class="line"></div>
<div class="line">    copy( trx.<a class="code" href="../../d7/d41/class_origen_1_1_transition_matrix_p.html#a7271cecf8ba475bc14718a31922e0b15">get_non0_</a>()-&gt;begin(), trx.<a class="code" href="../../d7/d41/class_origen_1_1_transition_matrix_p.html#a7271cecf8ba475bc14718a31922e0b15">get_non0_</a>()-&gt;end(), non0.begin() );</div>
<div class="line">    copy( trx.<a class="code" href="../../d7/d41/class_origen_1_1_transition_matrix_p.html#a5de37bf4f7765d619d49631377807bb4">get_kd_</a>()-&gt;begin(), trx.<a class="code" href="../../d7/d41/class_origen_1_1_transition_matrix_p.html#a5de37bf4f7765d619d49631377807bb4">get_kd_</a>()-&gt;end(), kd.begin() );</div>
<div class="line">    copy( trx.<a class="code" href="../../d7/d41/class_origen_1_1_transition_matrix_p.html#ab63e74ab07483a9e216f76e268a216e1">get_loc</a>()-&gt;begin(), trx.<a class="code" href="../../d7/d41/class_origen_1_1_transition_matrix_p.html#ab63e74ab07483a9e216f76e268a216e1">get_loc</a>()-&gt;end(), loc.begin() );</div>
<div class="line">    copy( trx.<a class="code" href="../../d7/d41/class_origen_1_1_transition_matrix_p.html#a0698935df7a744862336340fb4148a2c">get_nucl</a>()-&gt;begin(), trx.<a class="code" href="../../d7/d41/class_origen_1_1_transition_matrix_p.html#a0698935df7a744862336340fb4148a2c">get_nucl</a>()-&gt;end(), ZAI.begin() );</div>
<div class="line"></div>
<div class="line">    <span class="comment">/*** Convert Origen form to dense matrix ***/</span></div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">double</span>** C = (<span class="keywordtype">double</span>**)calloc( itot, <span class="keyword">sizeof</span>( <span class="keywordtype">double</span>* ) );</div>
<div class="line">    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; itot; i++ )</div>
<div class="line">        C[i] = (<span class="keywordtype">double</span>*)calloc( itot, <span class="keyword">sizeof</span>( <span class="keywordtype">double</span> ) );</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Add diagonal elements</span></div>
<div class="line">    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; itot; i++ ) C[i][i] += diag[i];</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Add offdiagonal elements</span></div>
<div class="line">    {</div>
<div class="line">        <span class="keywordtype">int</span> j = 0;</div>
<div class="line">        <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; itot; i++ )  <span class="comment">// rows (parents)</span></div>
<div class="line">            <span class="keywordflow">for</span>( <span class="keywordtype">int</span> p = 0; p &lt; non0[i]; p++ )</div>
<div class="line">            {</div>
<div class="line">                C[i][loc[j]] += offdiag[j];</div>
<div class="line">                j++;</div>
<div class="line">            }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">// &gt;&gt;&gt; Now C is the new (softer spectrum) transition Matrix in dence form.</span></div>
<div class="line">    <span class="comment">// Check that things changed...</span></div>
<div class="line"></div>
<div class="line">    EXPECT_TRUE( B[idx_H1][idx_H1] != C[idx_H1][idx_H1] );</div>
<div class="line">    EXPECT_TRUE( B[idx_B11][idx_B11] != C[idx_B11][idx_B11] );</div>
<div class="line">    EXPECT_TRUE( B[idx_U235][idx_U235] != C[idx_U235][idx_U235] );</div>
<div class="line"></div>
<div class="line">    <span class="comment">// B-11 n,2n should change too as it has MG data</span></div>
<div class="line">    EXPECT_TRUE( B[trx.<a class="code" href="../../d7/d41/class_origen_1_1_transition_matrix_p.html#a45af7857fe499e0d88027616edd91e32">find_nuclide</a>( 1, 50100 )][idx_B11] !=</div>
<div class="line">                 C[trx.<a class="code" href="../../d7/d41/class_origen_1_1_transition_matrix_p.html#a45af7857fe499e0d88027616edd91e32">find_nuclide</a>( 1, 50100 )][idx_B11] );</div>
<div class="line"></div>
<div class="line">    <span class="comment">// B-11 n,na should not change as it has no MG data</span></div>
<div class="line">    EXPECT_FLOAT_EQ( C[trx.<a class="code" href="../../d7/d41/class_origen_1_1_transition_matrix_p.html#a45af7857fe499e0d88027616edd91e32">find_nuclide</a>( 1, 30070 )][idx_B11], 4000 );</div>
<div class="line">    EXPECT_TRUE( -C[idx_B11][idx_B11] &gt; 4000 );</div>
<div class="line">    EXPECT_TRUE( -C[idx_B11][idx_B11] &lt; 4050 );</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Check that the fission yields still update.</span></div>
<div class="line">    tot_yield = 0.0;</div>
<div class="line">    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; itot; ++i )</div>
<div class="line">        <span class="keywordflow">if</span>( i != idx_U235 ) tot_yield += C[i][idx_U235];</div>
<div class="line">    EXPECT_NEAR( tot_yield, -2 * C[idx_U235][idx_U235], 0.1 * tot_yield );</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Free memory.</span></div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; itot; i++ ) free( B[i] );</div>
<div class="line">    free( B );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i = 0; i &lt; itot; i++ ) free( C[i] );</div>
<div class="line">    free( C );</div>
<div class="line"></div>
<div class="line">    tmu.<a class="code" href="../../d1/d77/class_origen_1_1_transition_matrix_updater.html#ac8bb3912a3ce86b15842e79d0b421204">clear</a>();</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line">std::string <a name="a31"></a><a class="code" href="../../d2/da0/namespace_origen_1_1test.html#aff5b4e3447c129500ea2dec041336184">int2str</a>( <span class="keywordtype">int</span> i )</div>
<div class="line">{</div>
<div class="line">    std::stringstream ss;</div>
<div class="line">    ss &lt;&lt; i;</div>
<div class="line">    <span class="keywordflow">return</span> ss.str();</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="../../d2/da0/namespace_origen_1_1test.html#ad77f4f855bd0e2892ad2574267e8930e">TEST</a>( TransitionMatrixUpdater, Example )</div>
<div class="line">{</div>
<div class="line">    <span class="comment">//     nemesis::Timer t = nemesis::Timer();</span></div>
<div class="line">    <span class="comment">//     std::vector&lt;std::string&gt; errors;</span></div>
<div class="line"></div>
<div class="line">    <a name="_a32"></a><a class="code" href="../../d4/ded/class_origen_1_1_transition_system_adapter___ampx_n.html">Origen::TransitionSystemAdapter_AmpxN</a> tsa;</div>
<div class="line">    {</div>
<div class="line">        ScaleUtils::IO::DB opts;</div>
<div class="line">        <span class="comment">//</span></div>
<div class="line">        <span class="comment">// Load AMPX infinitely dilute library into memory.</span></div>
<div class="line">        <span class="comment">//</span></div>
<div class="line">        <span class="comment">// TIC();</span></div>
<div class="line">        <span class="keyword">auto</span> rr = std::make_shared&lt;Origen::ReactionResource&gt;();</div>
<div class="line">        {</div>
<div class="line">            <a name="_a33"></a><a class="code" href="../../dc/d19/class_origen_1_1_reaction_resource_i_o.html">Origen::ReactionResourceIO</a> rr_io;</div>
<div class="line">            rr_io.load( *rr, Origen::jeff252_filepath, opts );</div>
<div class="line">        }</div>
<div class="line">        ASSERT_TRUE( rr != <span class="keyword">nullptr</span> ) &lt;&lt; opts.writeErrorStack();</div>
<div class="line">        <span class="comment">// TOC(&quot;loaded AMPX Infinitely Dilute library&quot;);</span></div>
<div class="line">        <span class="comment">// mempause std::cin.get(); //0.06s 16 MB</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">//</span></div>
<div class="line">        <span class="comment">// Load the yield resource.</span></div>
<div class="line">        <span class="comment">//</span></div>
<div class="line">        <span class="comment">// TIC();</span></div>
<div class="line">        <span class="keyword">auto</span> yr = std::make_shared&lt;Origen::YieldResource&gt;();</div>
<div class="line">        {</div>
<div class="line">            <a name="_a34"></a><a class="code" href="../../d5/d9a/class_origen_1_1_yield_resource_i_o.html">Origen::YieldResourceIO</a> yr_io;</div>
<div class="line">            yr_io.load( *yr, Origen::yields_filepath, opts );</div>
<div class="line">        }</div>
<div class="line">        ASSERT_TRUE( yr != <span class="keyword">nullptr</span> ) &lt;&lt; opts.writeErrorStack();</div>
<div class="line">        <span class="comment">// TOC(&quot;loaded fission yield resource&quot;);</span></div>
<div class="line">        <span class="comment">// mempause std::cin.get(); //0.04s 18 MB</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">// TIC();</span></div>
<div class="line">        rr-&gt;import_fission_yields( *yr );</div>
<div class="line">        <span class="comment">// TOC(&quot;loaded internal YR&quot;);</span></div>
<div class="line">        <span class="comment">// mempause std::cin.get(); //0.03s 35 MB</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">//</span></div>
<div class="line">        <span class="comment">// Import .</span></div>
<div class="line">        <span class="comment">//</span></div>
<div class="line">        <span class="comment">// TIC();</span></div>
<div class="line">        tsa.<a name="a35"></a><a class="code" href="../../d4/ded/class_origen_1_1_transition_system_adapter___ampx_n.html#a12fb2a934e3c25188a60c15048392a56">set_reaction_resource</a>( rr );</div>
<div class="line">        <span class="comment">// TOC(&quot;loaded internal AMPX&quot;);</span></div>
<div class="line">        <span class="comment">// mempause std::cin.get(); //0.02s 31 MB</span></div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">// TIC();</span></div>
<div class="line">    <span class="comment">// TransitionSystemMole ts; //use the Mole to print info while updating</span></div>
<div class="line">    <a name="_a36"></a><a class="code" href="../../d5/d42/class_origen_1_1_transition_system___gen.html">Origen::TransitionSystem_Gen</a> ts;</div>
<div class="line">    <span class="comment">// TOC(&quot;created empty transition system&quot;);</span></div>
<div class="line">    <span class="comment">// mempause std::cin.get(); //0.00s 25 MB</span></div>
<div class="line"></div>
<div class="line">    <span class="comment">// TIC();</span></div>
<div class="line">    tsa.<a name="a37"></a><a class="code" href="../../d4/ded/class_origen_1_1_transition_system_adapter___ampx_n.html#ad5250c865bb54942cf5a08c918ad7ccd">extend</a>( &amp;ts );</div>
<div class="line">    <span class="comment">// TOC(&quot;extended transition system&quot;);</span></div>
<div class="line">    <span class="comment">// mempause std::cin.get(); //0.04s 34 MB</span></div>
<div class="line"></div>
<div class="line">    <span class="comment">// TIC();</span></div>
<div class="line">    tsa.<a class="code" href="../../d4/ded/class_origen_1_1_transition_system_adapter___ampx_n.html#ad5250c865bb54942cf5a08c918ad7ccd">extend</a>( &amp;ts );</div>
<div class="line">    <span class="comment">// TOC(&quot;re-extended transition system&quot;);</span></div>
<div class="line">    <span class="comment">// mempause std::cin.get(); //0.05s 34 MB</span></div>
<div class="line"></div>
<div class="line">    <span class="comment">// tsa.print(); //print tsa internals</span></div>
<div class="line"></div>
<div class="line">    <span class="comment">// TIC();</span></div>
<div class="line">    <span class="comment">// std::vector&lt;double&gt; mg_flux0 = TestHelper::get_test_flux(1.0,252);</span></div>
<div class="line">    std::vector&lt;float&gt; mg_flux( 252, 1.0 );</div>
<div class="line">    <span class="comment">// mg_flux.assign(mg_flux0.begin(),mg_flux0.end());</span></div>
<div class="line">    <span class="comment">// TOC(&quot;setup test data&quot;);</span></div>
<div class="line">    <span class="comment">// mempause std::cin.get(); //0.00s 35 MB</span></div>
<div class="line"></div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// TIC();</span></div>
<div class="line">        <span class="comment">// ts.header(); //uncomment when using the Mole</span></div>
<div class="line">        <span class="keywordtype">float</span> sumflux = tsa.<a name="a38"></a><a class="code" href="../../d4/ded/class_origen_1_1_transition_system_adapter___ampx_n.html#a2a5072bf7813d6e30213744205d74b25">update</a>( &amp;ts, mg_flux );</div>
<div class="line">        EXPECT_FLOAT_EQ( 252, sumflux );</div>
<div class="line"></div>
<div class="line">        <span class="comment">// ts.footer(); //uncomment when using the Mole</span></div>
<div class="line">        jDebugLine( <span class="stringliteral">&quot;ID sumflux=&quot;</span> &lt;&lt; sumflux );</div>
<div class="line">        <span class="comment">// TOC(&quot;updated transition system with internal AMPX data&quot;);</span></div>
<div class="line">        <span class="comment">// mempause std::cin.get(); //0.04s 35 MB</span></div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>( <span class="keyword">false</span> )</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">//</span></div>
<div class="line">        <span class="comment">// Load AMPX self-shielded library into memory.</span></div>
<div class="line">        <span class="comment">//</span></div>
<div class="line">        <span class="comment">// TIC();</span></div>
<div class="line">        AmpxWorkingLibrary ssnxs;</div>
<div class="line">        ssnxs.setFileName( <span class="stringliteral">&quot;ft04f001&quot;</span> );</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordtype">int</span> rtn = ssnxs.open();</div>
<div class="line">            ASSERT_TRUE( rtn != 0 );</div>
<div class="line">        }</div>
<div class="line">        <span class="comment">// TOC(&quot;loaded AMPX Self-Shielded library&quot;);</span></div>
<div class="line">        <span class="comment">// mempause std::cin.get(); //0.01s 35 MB</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">// TIC();</span></div>
<div class="line">        std::ofstream os;</div>
<div class="line">        os.open( <span class="stringliteral">&quot;ssnxs.txt&quot;</span> );</div>
<div class="line">        tsa.<a name="a39"></a><a class="code" href="../../d4/ded/class_origen_1_1_transition_system_adapter___ampx_n.html#ab8d51e3c36fd40b2c3f29f77e46e31fa">print</a>( ssnxs, os );</div>
<div class="line">        os.close();</div>
<div class="line">        <span class="comment">// TOC(&quot;wrote file={ft04f001} to ssnxs.txt&quot;);</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">int</span> mix_id = 25;</div>
<div class="line"></div>
<div class="line">        <span class="comment">// TIC();</span></div>
<div class="line">        tsa.<a name="a40"></a><a class="code" href="../../d4/ded/class_origen_1_1_transition_system_adapter___ampx_n.html#ade5d4bab65f76913b253b9b7cde2071c">extend_by_mix</a>( &amp;ts, ssnxs, mix_id );</div>
<div class="line">        <span class="comment">// TOC(&quot;extended transition system for mix_id=&quot;&lt;&lt;int2str(mix_id));</span></div>
<div class="line">        <span class="comment">// mempause std::cin.get(); //0.03s 36 MB</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">// TIC();</span></div>
<div class="line">        <span class="comment">// ts.header(); //uncomment when using the Mole</span></div>
<div class="line">        <span class="keywordtype">float</span> sumflux = tsa.<a name="a41"></a><a class="code" href="../../d4/ded/class_origen_1_1_transition_system_adapter___ampx_n.html#a43788a9ccdcab7329cc17cb48857a3e0">update_by_mix</a>( &amp;ts, ssnxs, mix_id );</div>
<div class="line">        EXPECT_FLOAT_EQ( 252, sumflux );</div>
<div class="line"></div>
<div class="line">        <span class="comment">// ts.footer(); //uncomment when using the Mole</span></div>
<div class="line">        jDebugLine( <span class="stringliteral">&quot;SS sumflux=&quot;</span> &lt;&lt; sumflux );</div>
<div class="line">        <span class="comment">// TOC(&quot;updated transition system with internal AMPX data and additional</span></div>
<div class="line">        <span class="comment">// library&quot;);</span></div>
<div class="line">        <span class="comment">// mempause std::cin.get(); //0.0s 36 MB</span></div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line">}}</div>
</div><!-- fragment --> </div><!-- contents -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
</div>
</div>
</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
