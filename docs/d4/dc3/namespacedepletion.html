<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <!-- For Mobile Devices -->
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
        <meta name="generator" content="Doxygen 1.8.10"/>
        <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
        <title>ORIGEN API: depletion Module Reference</title>
        <!--<link href="../../tabs.css" rel="stylesheet" type="text/css"/>-->
        <script type="text/javascript" src="../../dynsections.js"></script>
        <link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
        <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
        <link href="../../doxygen.css" rel="stylesheet" type="text/css" />
        <link href="../../customdoxygen.css" rel="stylesheet" type="text/css"/>
        <link href='https://fonts.googleapis.com/css?family=Roboto+Slab' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="../../doxy-boot.js"></script>
    </head>
    <body>
        <nav class="navbar navbar-default" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand">ORIGEN API v0.5.2</a>
                </div>
            </div>
        </nav>
        <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
            <div class="content" id="content">
                <div class="container">
                    <div class="row">
                        <div class="col-sm-12 panel " style="padding-bottom: 15px;">
                            <div style="margin-bottom: 15px;">
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Overview</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../modules.html"><span>Components</span></a></li>
      <li><a href="../../examples.html"><span>Examples</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../d1/d5b/md__c_h_a_n_g_e_l_o_g.html"><span>Changelog</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../namespacemembers.html"><span>Namespace&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">depletion Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>The predictor-corrector mechanism and solver encapsulation.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a4942f37401b222891148bcc3db4b003a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/dc3/namespacedepletion.html#a4942f37401b222891148bcc3db4b003a">deplete</a> (solver_opts, lib, itot, n0, n, delta_t, source_term, flux, power, input_by_flux, is_adjoint, fixed_fission_energy, reprocessing_rate, feed_rate, adjoint_source_term_reaction, adjoint_source_term_decay)</td></tr>
<tr class="memdesc:a4942f37401b222891148bcc3db4b003a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform a single depletion step (including the predictor/corrector mechanism).  <a href="#a4942f37401b222891148bcc3db4b003a">More...</a><br /></td></tr>
<tr class="separator:a4942f37401b222891148bcc3db4b003a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32394a1939eeed9617d854c8e8d7ee62"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/dc3/namespacedepletion.html#a32394a1939eeed9617d854c8e8d7ee62">depletion_step</a> (solver_opts, lib, itot, n0, n, delta_t, corrector, powrst, fluxst, source_term, flux, power, input_by_flux, is_adjoint, fixed_fission_energy, reprocessing_rate, feed_rate, adjoint_source_term_reaction, adjoint_source_term_decay)</td></tr>
<tr class="memdesc:a32394a1939eeed9617d854c8e8d7ee62"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run the solver once.  <a href="#a32394a1939eeed9617d854c8e8d7ee62">More...</a><br /></td></tr>
<tr class="separator:a32394a1939eeed9617d854c8e8d7ee62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f9bd77787c870643eaa6bc94422e10e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/dc3/namespacedepletion.html#a6f9bd77787c870643eaa6bc94422e10e">powerflux</a> (lib, itot, power, flux, concentrations, input_by_flux, fixed_fission_energy, is_adjoint)</td></tr>
<tr class="memdesc:a6f9bd77787c870643eaa6bc94422e10e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert power to flux or vice versa.  <a href="#a6f9bd77787c870643eaa6bc94422e10e">More...</a><br /></td></tr>
<tr class="separator:a6f9bd77787c870643eaa6bc94422e10e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5e4df00aa7e166474d1b885717e2b97"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/dc3/namespacedepletion.html#af5e4df00aa7e166474d1b885717e2b97">fluxo</a> (corrector, powrst, fluxst, flux, power, zero_flux_step, input_by_flux)</td></tr>
<tr class="memdesc:af5e4df00aa7e166474d1b885717e2b97"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the average flux over a time interval using predictor corrector method, build the diagonal of the transition matrix (DIAG array), convert flux to power or vice versa, multiply A matrix off-diagoal elements by flux.  <a href="#af5e4df00aa7e166474d1b885717e2b97">More...</a><br /></td></tr>
<tr class="separator:af5e4df00aa7e166474d1b885717e2b97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8546ed5837ed07f56b9ecd00c82ea3b8"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/dc3/namespacedepletion.html#a8546ed5837ed07f56b9ecd00c82ea3b8">powerf</a> (lib, itot, factor, fission_rate, concentrations, zero_flux_step)</td></tr>
<tr class="memdesc:a8546ed5837ed07f56b9ecd00c82ea3b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the power-flux conversion factor, based on given fission rate and given concentrations.  <a href="#a8546ed5837ed07f56b9ecd00c82ea3b8">More...</a><br /></td></tr>
<tr class="separator:a8546ed5837ed07f56b9ecd00c82ea3b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The predictor-corrector mechanism and solver encapsulation. </p>
<p>This module encapsulates the predictor-corrector mechanism of depletion and provides the parts of the depletion mechanism which are common to all solvers.</p>
<p>The <code>deplete</code> subroutine executes two solver runs for predictor and corrector steps.</p>
<p>The <code>depletion_step</code> subroutine calculates the flux (or power) integrated over the time step, builds the transition matrix A for the solver (by folding the reaction and decay data together using the evaluated flux), builds up the source vector B (consisting of the user-specified constant feed term and from the terms arising from the adjoint solution, if applicable) and runs the solver itself. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a class="anchor" id="a4942f37401b222891148bcc3db4b003a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine depletion::deplete </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="../../d8/d59/structsolvers_1_1solver__options.html">solver_options</a>), intent(in)&#160;</td>
          <td class="paramname"><em>solver_opts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(origen_librarywrapper), intent(in)&#160;</td>
          <td class="paramname"><em>lib</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>itot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), dimension(itot), intent(in)&#160;</td>
          <td class="paramname"><em>n0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), dimension(itot), intent(out)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), intent(in)&#160;</td>
          <td class="paramname"><em>delta_t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), dimension(itot), intent(inout)&#160;</td>
          <td class="paramname"><em>source_term</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), intent(inout)&#160;</td>
          <td class="paramname"><em>flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), intent(inout)&#160;</td>
          <td class="paramname"><em>power</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>input_by_flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>is_adjoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>fixed_fission_energy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), dimension(itot), intent(in)&#160;</td>
          <td class="paramname"><em>reprocessing_rate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), dimension(itot), intent(in)&#160;</td>
          <td class="paramname"><em>feed_rate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), dimension(itot), intent(in)&#160;</td>
          <td class="paramname"><em>adjoint_source_term_reaction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), dimension(itot), intent(in)&#160;</td>
          <td class="paramname"><em>adjoint_source_term_decay</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform a single depletion step (including the predictor/corrector mechanism). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">solver_opts</td><td>solver settings</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lib</td><td>Library data</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">itot</td><td>Number of nuclides in the library</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n0</td><td>initial concentrations</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">n</td><td>final concentrations</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">source_term</td><td>Continuous processing feed rate / source term from the adjoint calculation</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">delta_t</td><td>Time step length in seconds</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">input_by_flux</td><td>flux is used for input? or power?</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">is_adjoint</td><td>is this an adjoint calculation?</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fixed_fission_energy</td><td>is the fission energy fixed or problem dependent?</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">reprocessing_rate</td><td>continuous reprocessing rates</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">feed_rate</td><td>continuous feed rates</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">adjoint_source_term_reaction</td><td>reaction component of the adjoint source term</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">adjoint_source_term_decay</td><td>decay component of the adjoint source term </td></tr>
  </table>
  </dd>
</dl>
<p>buffers for predictor-corrector power and flux </p>

<p>References <a class="el" href="../../d4/dc3/namespacedepletion.html#a32394a1939eeed9617d854c8e8d7ee62">depletion_step()</a>, and <a class="el" href="../../df/d9a/namespaceorigen__iofunctions__m.html#aa1aef71afe3a97030061d2f6ad7628fd">origen_iofunctions_m::rstop()</a>.</p>

<p>Referenced by <a class="el" href="../../d9/d0f/namespaceorigen__casewrapper__m.html#a4bec2796cfd2e68b314ab931e7f1b305">origen_casewrapper_m::flip_time()</a>.</p>

</div>
</div>
<a class="anchor" id="a32394a1939eeed9617d854c8e8d7ee62"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine depletion::depletion_step </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="../../d8/d59/structsolvers_1_1solver__options.html">solver_options</a>), intent(in)&#160;</td>
          <td class="paramname"><em>solver_opts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(origen_librarywrapper), intent(in)&#160;</td>
          <td class="paramname"><em>lib</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>itot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), dimension(itot), intent(in)&#160;</td>
          <td class="paramname"><em>n0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), dimension(itot), intent(inout)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), intent(in)&#160;</td>
          <td class="paramname"><em>delta_t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>corrector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), intent(inout)&#160;</td>
          <td class="paramname"><em>powrst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), intent(inout)&#160;</td>
          <td class="paramname"><em>fluxst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), dimension(itot), intent(inout)&#160;</td>
          <td class="paramname"><em>source_term</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), intent(inout)&#160;</td>
          <td class="paramname"><em>flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), intent(inout)&#160;</td>
          <td class="paramname"><em>power</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>input_by_flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>is_adjoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>fixed_fission_energy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), dimension(itot), intent(in)&#160;</td>
          <td class="paramname"><em>reprocessing_rate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), dimension(itot), intent(in)&#160;</td>
          <td class="paramname"><em>feed_rate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), dimension(itot), intent(in)&#160;</td>
          <td class="paramname"><em>adjoint_source_term_reaction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), dimension(itot), intent(in)&#160;</td>
          <td class="paramname"><em>adjoint_source_term_decay</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Run the solver once. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">solver_opts</td><td>solver type identifier</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lib</td><td>Library data</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">itot</td><td>Total number of nuclides</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n0</td><td>initial concentrations</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">n</td><td>final concentrations</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">delta_t</td><td>Time step length in seconds</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">corrector</td><td>is this a corrector step?</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">powrst</td><td>saved power for predictor-corrector</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fluxst</td><td>saved flux for predictor-corrector</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">source_term</td><td>Continuous processing feed rate / source term from the adjoint calculation</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">input_by_flux</td><td>flux is used for input? or power?</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">is_adjoint</td><td>is this an adjoint calculation?</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fixed_fission_energy</td><td>is the fission energy fixed or problem dependent?</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">reprocessing_rate</td><td>continuous reprocessing rates</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">feed_rate</td><td>continuous feed rates</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">adjoint_source_term_reaction</td><td>reaction component of the adjoint source term</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">adjoint_source_term_decay</td><td>decay component of the adjoint source term </td></tr>
  </table>
  </dd>
</dl>
<p>Diagonal elements of the transition matrix</p>
<p>Nondiagonal elements of the transition matrix</p>
<p>is this a zero-flux (=decay) step? </p>

<p>References <a class="el" href="../../dc/d32/group___fortran_constants.html#ga595a7a58c908ec8f7c6778d9d5b532aa">origen_definitions_m::err</a>, <a class="el" href="../../d4/dc3/namespacedepletion.html#af5e4df00aa7e166474d1b885717e2b97">fluxo()</a>, <a class="el" href="../../dd/d83/namespacekernel__matrex.html#a7ba4ad2803715d7c6962c56b3cb86e85">kernel_matrex::matrex_solve()</a>, <a class="el" href="../../d4/dc3/namespacedepletion.html#a6f9bd77787c870643eaa6bc94422e10e">powerflux()</a>, <a class="el" href="../../df/da9/namespacekernel__radau5.html#ac6dffa00f06a74fb9e46cfc43f594a45">kernel_radau5::radau5_solve()</a>, and <a class="el" href="../../df/d9a/namespaceorigen__iofunctions__m.html#aa1aef71afe3a97030061d2f6ad7628fd">origen_iofunctions_m::rstop()</a>.</p>

<p>Referenced by <a class="el" href="../../d4/dc3/namespacedepletion.html#a4942f37401b222891148bcc3db4b003a">deplete()</a>.</p>

</div>
</div>
<a class="anchor" id="a6f9bd77787c870643eaa6bc94422e10e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine depletion::powerflux </td>
          <td>(</td>
          <td class="paramtype">type(origen_librarywrapper), intent(in)&#160;</td>
          <td class="paramname"><em>lib</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>itot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), intent(inout)&#160;</td>
          <td class="paramname"><em>power</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), intent(inout)&#160;</td>
          <td class="paramname"><em>flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), dimension(itot), intent(in)&#160;</td>
          <td class="paramname"><em>concentrations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>input_by_flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>fixed_fission_energy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>is_adjoint</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert power to flux or vice versa. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">lib</td><td>Library data</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">itot</td><td>Total number of nuclides</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">flux</td><td>user-given flux (if index is 0; otherwise not used)</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">power</td><td>user-given power (if index is 1; otherwise not used)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">concentrations</td><td>Concentrations to be used</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">input_by_flux</td><td>depletion by flux or by power?</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fixed_fission_energy</td><td>is the fission energy fixed or problem-dependent?</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">is_adjoint</td><td>is this an adjoint calculation? </td></tr>
  </table>
  </dd>
</dl>
<p>Local holder for fiss array </p>

<p>References <a class="el" href="../../dc/d32/group___fortran_constants.html#ga595a7a58c908ec8f7c6778d9d5b532aa">origen_definitions_m::err</a>, <a class="el" href="../../d4/dc3/namespacedepletion.html#a8546ed5837ed07f56b9ecd00c82ea3b8">powerf()</a>, and <a class="el" href="../../df/d9a/namespaceorigen__iofunctions__m.html#aa1aef71afe3a97030061d2f6ad7628fd">origen_iofunctions_m::rstop()</a>.</p>

<p>Referenced by <a class="el" href="../../d4/dc3/namespacedepletion.html#a32394a1939eeed9617d854c8e8d7ee62">depletion_step()</a>.</p>

</div>
</div>
<a class="anchor" id="af5e4df00aa7e166474d1b885717e2b97"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine depletion::fluxo </td>
          <td>(</td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>corrector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), intent(inout)&#160;</td>
          <td class="paramname"><em>powrst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), intent(inout)&#160;</td>
          <td class="paramname"><em>fluxst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), intent(inout)&#160;</td>
          <td class="paramname"><em>flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), intent(inout)&#160;</td>
          <td class="paramname"><em>power</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>zero_flux_step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>input_by_flux</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the average flux over a time interval using predictor corrector method, build the diagonal of the transition matrix (DIAG array), convert flux to power or vice versa, multiply A matrix off-diagoal elements by flux. </p>
<p><br />
<br />
 Given an input value for the specific power, XFLUXO solves for the average flux over the time interval by using Eq. (F7.2.30) and energy per fission data. Given an input value for the neutron flux, XFLUXO solves for the specific power by Eq. (F7.2.32). Having obtained a value for the neutron flux, XFLUXO generates the first-order rate constants for neutron-induced reactions. Then the diagonal matrix element is formed for each nuclide by combining the disintegration constant, the rate constant for neutron-induced reactions, and the rate constant for removal processes that are proportional to the nuclide concentration. The diagonal matrix elements are stored in the D array.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">corrector</td><td>false =&gt; save flux (fluxst/powrst), true =&gt; average saved and actual flux</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">powrst</td><td>saved power from predictor to corrector</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fluxst</td><td>saved flux from predictor to corrector</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">flux</td><td>user-given flux (if index is 0; otherwise not used)</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">power</td><td>user-given power (if index is 1; otherwise not used)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zero_flux_step</td><td>is this a zero-flux step?</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">input_by_flux</td><td>depletion by flux or by power? </td></tr>
  </table>
  </dd>
</dl>

<p>Referenced by <a class="el" href="../../d4/dc3/namespacedepletion.html#a32394a1939eeed9617d854c8e8d7ee62">depletion_step()</a>.</p>

</div>
</div>
<a class="anchor" id="a8546ed5837ed07f56b9ecd00c82ea3b8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine depletion::powerf </td>
          <td>(</td>
          <td class="paramtype">type(origen_librarywrapper), intent(in)&#160;</td>
          <td class="paramname"><em>lib</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>itot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), intent(out)&#160;</td>
          <td class="paramname"><em>factor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), intent(in)&#160;</td>
          <td class="paramname"><em>fission_rate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), dimension(itot), intent(in)&#160;</td>
          <td class="paramname"><em>concentrations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>zero_flux_step</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the power-flux conversion factor, based on given fission rate and given concentrations. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">lib</td><td>Library data</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">itot</td><td>Total number of nuclides</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">factor</td><td>power-flux factor to be calculated</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fission_rate</td><td>normalization factor</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">concentrations</td><td>used concentrations (usually XTEMP)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zero_flux_step</td><td>is this a zero-flux step? </td></tr>
  </table>
  </dd>
</dl>
<p>Cycle variables</p>
<p>Temporary local copies of library data objects</p>
<p>Energy library size</p>
<p>Nuclide IDs in energy library</p>
<p>Fission energy in energy library</p>
<p>Prompt gamma capture energy (mev) fission energy in energy library</p>
<p>Populate local array copies</p>
<p>Garbage collection </p>

<p>References <a class="el" href="../../dc/d32/group___fortran_constants.html#ga595a7a58c908ec8f7c6778d9d5b532aa">origen_definitions_m::err</a>.</p>

<p>Referenced by <a class="el" href="../../d4/dc3/namespacedepletion.html#a6f9bd77787c870643eaa6bc94422e10e">powerflux()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
</div>
</div>
</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
